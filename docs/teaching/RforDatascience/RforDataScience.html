<!DOCTYPE html>
<html lang="en"><head>
<link href="../../img/favicon-16x16.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="苅谷千尋">
  <meta name="dcterms.date" content="2025-11-02">
  <title>CHIHIRO KARIYA – 初心者向けR Studioの使い方</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-73de0b3c4ac470fe1e45f26a233f94f0.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/multimodal/multimodal.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/logo_金沢大学.png" data-background-position="90% 90%" data-background-size="10%" class="quarto-title-block center">
  <h1 class="title">初心者向けR Studioの使い方</h1>
  <p class="subtitle">Ｒを用いて学ぶ量的テキスト分析講習会</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
苅谷千尋 <a href="https://orcid.org/0009-0008-3085-947X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:kariyach@staff.kanazawa-u.ac.jp">kariyach@staff.kanazawa-u.ac.jp</a>
</div>
        <p class="quarto-title-affiliation">
            金沢大学
          </p>
    </div>
</div>

  <p class="date">November 2, 2025</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/実行環境と自己紹介" id="/toc-実行環境と自己紹介">0. 実行環境と自己紹介</a></li>
<li><a href="#/この講習会で学べること-学べないこと" id="/toc-この講習会で学べること-学べないこと">Ⅰ. この講習会で学べること / 学べないこと</a></li>
<li><a href="#/rの基礎概念" id="/toc-rの基礎概念">Ⅱ. Rの基礎概念</a></li>
<li><a href="#/r環境の整備" id="/toc-r環境の整備">Ⅲ. R環境の整備</a></li>
<li><a href="#/rにふれてみようpalmer-penguins" id="/toc-rにふれてみようpalmer-penguins">Ⅳ. Rにふれてみよう：palmer penguins</a></li>
<li><a href="#/rを動かしてみよう社会科学のデータ" id="/toc-rを動かしてみよう社会科学のデータ">Ⅴ. Rを動かしてみよう：社会科学のデータ</a></li>
<li><a href="#/rを使いこなそうmap関数スクレイピング地図情報" id="/toc-rを使いこなそうmap関数スクレイピング地図情報">Ⅵ. Rを使いこなそう：map()関数・スクレイピング・地図情報</a></li>
<li><a href="#/さらに学ぶために" id="/toc-さらに学ぶために">Ⅶ.さらに学ぶために</a></li>
<li><a href="#/引用文献" id="/toc-引用文献">引用文献</a></li>
</ul>
</nav>
</section>
<section>
<section id="実行環境と自己紹介" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>0. 実行環境と自己紹介</h1>

</section>
<section id="実行環境" class="slide level2">
<h2>実行環境</h2>
<ul>
<li>R version 4.5.1 (2025-06-13)</li>
<li>R Studio 2025.09.1+401</li>
<li>Platform aarch64, darwin20</li>
<li>Running under: macOS Tahoe 26.1</li>
</ul>
</section>
<section id="自己紹介" class="slide level2">
<h2>自己紹介</h2>
<ul>
<li><strong>氏名</strong>：苅谷千尋（かりやちひろ）</li>
<li><strong>所属</strong>：金沢大学教育支援センター
<ul>
<li>主担当業務：高大接続コア・センター業務</li>
</ul></li>
<li><strong>専門</strong>：政治学 &gt; 政治思想史（イギリス）
<ul>
<li>18世紀イギリスの議会政治と議会ジャーナリズム</li>
<li>レトリックの受容史：キケロ；サルスティウス；タキトゥス</li>
</ul></li>
<li><strong>Webサイト</strong>
<ul>
<li><a href="https://kariyach.github.io">personal website - en</a> / <a href="https://researchmap.jp/kariya/">researchmap - ja</a></li>
</ul></li>
</ul>
</section>
<section id="自己紹介レトリックの受容史" class="slide level2">
<h2>自己紹介：レトリックの受容史</h2>
<h3 id="プルタルコス">プルタルコス</h3>
<div class="columns">
<div class="column" style="width:60%;">
<blockquote>
<p>民衆が演説をどう受け止めるかに関心を持たない者は、すなわち寡頭制を支持する者、説得よりも暴力に頼ろうとする者である。</p>
</blockquote>
</div><div class="column" style="width:40%;">
<p><img data-src="img/Plutarch.jpg" style="width:40.0%"></p>
</div></div>
<h3 id="タキトゥス">タキトゥス</h3>
<div class="columns">
<div class="column" style="width:60%;">
<blockquote>
<p>今昔を比較して暇を潰す老人らは、つぎのことに気がついた。国家を統治した歴代の元首のうちで、他人の雄弁術を必要としたのは、ネロが最初であると。</p>
</blockquote>
</div><div class="column" style="width:40%;">
<p><img data-src="img/tacitus.jpg" style="width:40.0%"></p>
</div></div>
</section>
<section id="自己紹介レトリックの受容史-1" class="slide level2">
<h2>自己紹介：レトリックの受容史</h2>
<h3 id="サミュエルジョンソン">サミュエル・ジョンソン</h3>
<div class="columns">
<div class="column" style="width:80%;">
<blockquote>
<p>最後に演説された貴族議員〔Hurgo院Heryef卿〕はあまりに偉大な雄弁の達人です。その巧みさゆえに、人は、彼の言葉を聞くに当たって、喜びから自然に生まれるあらゆる注意力を向けることがありません。聴き手の心には、部分的な表現や巧みな推論に惑わされるのではないか、という恐れから不安が生じるものです。しかし、彼はこのような<em>あらゆる不安を生じさせないほどに恐ろしい、理路整然と論じられる人</em>（reasoner）なのです。諸君、私が常に恐れているのは、この貴族議員の想像力が与える装飾（ornaments）のなかで、<em>誤謬が真実であるかのように見えすぎてしまう</em>ことなのです。そしてまた、理性の光によって導かれる自分自身を想像しながらも、その詭弁（sophitry）が私の知性（understanding）を惑わすことなのです。諸君、そこで私は、彼の装飾を再検討し、それが<em>真実の力によるものなのか、それとも雄弁によるものなのか</em>、私は試してみようと思う。</p>
</blockquote>
</div><div class="column" style="width:20%;">
<p><img data-src="img/SamuelJohnson.jpg"></p>
<p><img data-src="img/gentleman-s-magazine-1731.jpg"></p>
</div></div>
</section>
<section id="自己紹介レトリックの受容史-2" class="slide level2">
<h2>自己紹介：レトリックの受容史</h2>
<h3 id="エドマンドバーク">エドマンド・バーク</h3>
<div class="columns">
<div class="column" style="width:80%;">
<blockquote>
<p>ある古代の著述家（プルタルコスだと思う）は､「聴衆の心に刺を刺した唯一の雄弁家」と呼ばれるペリクレスの雄弁について､幾つか詩を引用している。ペリクレスと同様に､<em>この声明の雄弁さは､真の人間性（humanity）の感性と矛盾せず､むしろ感性を強化するものであり､私の心には皮膚以上に深く刺さった刺が残っている</em>。この刺は､殺人者が外科であらゆる手を尽くして取り除こうとしても取り除くことはできず､また､<em>この刺が生み出した胸の高鳴りは､強奪や没収という皮膚を和らげる湿布薬をもってしても和らげることはできない。私はこの〔革命フランス〕共和国を愛すことができない</em>。</p>
</blockquote>
</div><div class="column" style="width:20%;">
<p><img data-src="img/Burke.jpg"></p>
</div></div>
</section></section>
<section>
<section id="この講習会で学べること-学べないこと" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅰ. この講習会で学べること / 学べないこと</h1>

</section>
<section id="この講習会で学べること-学べないこと-1" class="slide level2">
<h2>この講習会で学べること / 学べないこと</h2>
<h3 id="学べること">学べること</h3>
<ul>
<li>Rの何がよいのか、Rで何ができるかの理解</li>
<li>Rの基本操作の習得</li>
<li>Rの応用操作の見通し</li>
</ul>
<h3 id="学べないこと">学べないこと</h3>
<ul>
<li>データの形を整える操作（前処理）の詳細</li>
<li>ggplotで作図した図の見た目（文字の大きさなど）を細かく変える方法</li>
<li>専門性の高いパッケージ</li>
<li>専門性の高い分析手法（回帰分析の発展的手法、パス解析、因子分析、多重指標モデルなど）</li>
</ul>
</section></section>
<section>
<section id="rの基礎概念" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅱ. Rの基礎概念</h1>

</section>
<section id="なぜrなのか-なぜquartoなのか" class="slide level2">
<h2>なぜRなのか / なぜquartoなのか</h2>
<h3 id="無料">1. 無料</h3>
<h3 id="コードスクリプト">2. コード（スクリプト）</h3>
<ul>
<li>再現可能性
<ul>
<li>マウス操作と違い､手順を説明する必要性が少ない（真似しやすい）</li>
<li>操作を忘れてもコードが残る</li>
<li><em>ミスも再現できる</em></li>
</ul></li>
<li><em>使い回せる</em>（作業の効率化）</li>
<li>安全性（<em>元データは加工されない</em>）</li>
</ul>
<h3 id="豊富な可視化ツール">3. 豊富な可視化ツール</h3>
<ul>
<li><a href="https://ggplot2.tidyverse.org">ggplot2</a> / <a href="https://pmassicotte.github.io/paletteer_gallery/">カラーパッケージ</a></li>
</ul>
</section>
<section id="なぜrなのか-なぜquartoなのか-1" class="slide level2">
<h2>なぜRなのか / なぜquartoなのか</h2>
<h3 id="豊富な出力形態quarto">4. 豊富な出力形態（quarto）</h3>
<ul>
<li><a href="https://quarto.org/docs/output-formats/html-basics.html">Documents</a> / <a href="https://quarto.org/docs/presentations/">Presentations</a> / <a href="https://quarto.org/docs/dashboards/">Dashboards</a> / <a href="https://quarto.org/docs/websites/">Website</a></li>
</ul>
<h3 id="親切なコミュニティ">5. 親切なコミュニティ</h3>
<ul>
<li><em>各専門分野の研究者が､当該分野の分析に最適化したパッケージを作っている</em> （探せばだいたい欲しいパッケージがある）</li>
<li>困っていることはみんな一緒（先達の回答が参考になる）
<ul>
<li><a href="https://tokyor.connpass.com">Tokyo.R</a> / <a href="https://kanazawar.connpass.com/event/369362/?utm_campaign=event_publish_to_series_watcher&amp;utm_source=notifications&amp;utm_medium=email&amp;utm_content=detail_btn">Kanazawa.R</a>（次回2025年11月15日(土)開催）</li>
</ul></li>
</ul>
<h3 id="簡易的な記述法">6. 簡易的な記述法</h3>
<ul>
<li>markdown</li>
</ul>
</section>
<section id="rの構造" class="slide level2">
<h2>Rの構造</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph BT
    A(["&lt;strong&gt;Base R&lt;/strong&gt;
Rの基本構文・関数
例: mean(), sum(), if"]) --&gt; 
    B(["&lt;strong&gt;Modern R&lt;/strong&gt;
便利な文法・スタイル
例: |&gt; パイプ, tibble, dplyr 文法,&lt;br&gt; ggplot2 文法"]) --&gt; 
    C(["&lt;strong&gt;Packages&lt;/strong&gt;
Rに追加するツール集
例: tidyverse, ggplot2,&lt;br&gt;readr, lubridate, shiny"])


%% ノードのスタイル
style A text-align:center
style B text-align:center
style A text-align:center, fill:#FFD700,stroke:#333,stroke-width:1px,font-weight:bold;
style B text-align:center, fill:#87CEFA,stroke:#333,stroke-width:1px,font-weight:bold;
style C text-align:center, fill:#90EE90,stroke:#333,stroke-width:1px,font-weight:bold;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li>Packages
<ul>
<li>目的別に追加するツール：<em>家具や家電</em></li>
</ul></li>
<li>Modern R：tidyな（整然とした）R
<ul>
<li>近年の改良で、より読みやすく・便利になった文法：<em>家の「骨組み・壁・柱」や「設計の考え方」</em></li>
</ul></li>
<li>Base R
<ul>
<li>R言語そのもの：<em>家の基礎部分</em></li>
</ul></li>
</ul>
</div></div>
<ul>
<li>tidyverse は家具も文法も含むが、文法部分は Modern R、インストールして使う部分は Packages に分類できる</li>
</ul>
</section>
<section id="rの手順" class="slide level2">
<h2>Rの手順</h2>
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    Start([YAML設定（ドキュメントの設定）:&lt;br&gt; タイトル、出力形式、テーマなど]) --&gt; B[データの読み込み・前処理:&lt;br&gt; dplyr / tidyr
    &lt;br&gt;（フィルタリング / 集計・要約 / 新列作成・計算&lt;br&gt;/ 縦持ち・横持ち変換 / 欠損値処理）]
    B --&gt; C1[データの探索・可視化:&lt;br&gt; skim, gt_summary / ggplot2]
    B --&gt; C2[統計分析・モデル構築:&lt;br&gt; lm, glm, 因果推論]
    C1 --&gt; D[結果の評価・解釈:&lt;br&gt; broom, modelsummary, performance]
    C2 --&gt; D
    D --&gt; End([レポート作成（レンダー）:&lt;br&gt; knitr / rmarkdown&lt;br&gt;（pdf; reveal.js; webpage; docx; pptx; pdf）])

    %% 色付け
    style Start fill:#a2d4f1,stroke:#333,stroke-width:2px
    style End fill:#f1d4a2,stroke:#333,stroke-width:2px
    style C1 fill:#d4f1a2,stroke:#333,stroke-width:1px
    style C2 fill:#f1a2d4,stroke:#333,stroke-width:1px
    
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="整然データと雑然データ" class="slide level2">
<h2>整然データと雑然データ</h2>
<h3 id="整然tidyデータ">整然（tidy）データ</h3>
<ol type="1">
<li>各変数は独立した列で表現される</li>
<li>観測した値は1行に記録される</li>
<li>観測データの集合はテーブルを表現する</li>
</ol>
<p>（<span class="citation" data-cites="HealyK:2021book1_translJA">ヒーリー， (<a href="#/引用文献-1" role="doc-biblioref" onclick="">2021</a>)</span>, 「付録A.1.3「Tidyデータ」329-332ページ）</p>
</section>
<section id="整然データと雑然データ-1" class="slide level2">
<h2>整然データと雑然データ</h2>
<h3 id="雑然messyデータ">雑然（messy）データ</h3>
<ul>
<li>整然データではないデータ</li>
<li>上記に加え､不要な空白行（セル）
<ul>
<li><a href="https://www.e-stat.go.jp/stat-search/files?page=1&amp;layout=normal&amp;toukei=00450071&amp;survey=毎月勤労統計調査&amp;result_page=1&amp;metadata=1&amp;data=1">毎月勤労統計調査</a></li>
</ul></li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>コンピュータが理解できるデータ形式は、<em>1行目がカラム名、2行目以降が値</em>であることを特に覚えておきましょう</li>
<li>Rに限りませんが、Rなどのプログラム系の統計ソフトで<em>指示する対象は「カラム名」</em>（実質的には変数）です
<ul>
<li>例えば一つのデータに同じカラム名があると動かない、もしくは強制的にカラム名が変更（メモリ上。元ファイルはそのまま）されます</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="r環境の整備" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅲ. R環境の整備</h1>

</section>
<section id="r-studioとquartoファイル" class="slide level2">
<h2>R Studioとquartoファイル</h2>
<h3 id="r-studio">R Studio</h3>
<ul>
<li>Rを効率的に使うための統合開発環境（IDE）
<ul>
<li>「コードを書く・実行する・結果を見る」ための道具</li>
<li>Cf. R 本体:「計算・統計処理」を行う（R Studioを起動すれば、内部でRが自動的に動く）</li>
<li><a href="https://posit.co">posit</a>社のアプリ（今日のR開発を牽引）</li>
<li>Pythonとの共存を目指す<a href="https://positron.posit.co">Positron</a>の開発が進行中（Microsoft VS Codeに類似したインターフェイス）</li>
</ul></li>
</ul>
</section>
<section id="r-studioとquartoファイル-1" class="slide level2">
<h2>R Studioとquartoファイル</h2>
<h3 id="quartoファイル">quartoファイル</h3>
<ul>
<li>拡張子qmd</li>
<li>コード（R Chunk）と文章（Markdown）をひとつのファイルにまとめて書き、実行結果つきのレポートやスライドを自動で作成できる
<ul>
<li>YAMLのformatを書き換えるだけで多様な出力が可能
<ul>
<li>HTML, PDF, Reveal.js, docx, pptx など</li>
</ul></li>
<li>R Markdown（拡張子Rmd）の拡張版</li>
</ul></li>
</ul>
</section>
<section id="準備インストール" class="slide level2">
<h2>準備：インストール</h2>
<h3 id="r本体">1. R：本体</h3>
<ul>
<li>ブラウザから<a href="https://cran.rstudio.com">R</a>にアクセス</li>
<li>手持ちのPCに適したファイルをダウンロードして、実行
<ul>
<li>Windows / macOS / Linux</li>
</ul></li>
</ul>
<h3 id="r-studio-1">2. R Studio</h3>
<ul>
<li>ブラウザから<a href="https://posit.co/download/rstudio-desktop/">R Studio</a>にアクセス</li>
<li>手持ちのPCに適したファイルをダウンロード、実行
<ul>
<li>Windows / macOS / Ubuntu</li>
</ul></li>
</ul>
</section>
<section id="準備ファイルの作成" class="slide level2">
<h2>準備：ファイルの作成</h2>
<h3 id="この講習会用のフォルダ作成osで操作">3. この講習会用のフォルダ作成（OSで操作）</h3>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>ファイル名は<em>念のため英数のみ</em>とし、また<em>空白文字を使わない</em>で下さい</p>
</div>
</div>
</div>
<h3 id="プロジェクトの作成r-studioで操作">4. プロジェクトの作成（R Studioで操作）</h3>
<ul>
<li>メニュー &gt; File &gt; New Project &gt; Existing Directory &gt; 3で作成した フォルダを指定 &gt; Create Project</li>
</ul>
<h3 id="rprojファイル">Rprojファイル</h3>
<ul>
<li>Rprojファイル は RStudio プロジェクトを管理するための設定ファイル で、作業ディレクトリや環境設定、ファイルの表示状態などを保存する</li>
<li>プロジェクトを開くと、自動でそのフォルダが作業ディレクトリになり、パスの管理や依存関係の整理が簡単になる</li>
</ul>
</section>
<section id="準備ファイルの作成-1" class="slide level2">
<h2>準備：ファイルの作成</h2>
<h3 id="r-quartoファイルの作成studioで操作">5. R quartoファイルの作成（Studioで操作）</h3>
<ul>
<li>メニュー &gt; File &gt; Quarto Document &gt; Create</li>
<li>Title: 任意</li>
<li>HTML / PDF / Word → HTMLにチェック</li>
<li>「Editor: Use visual markdown editor」のチェックを外す（外れていることを確認する）</li>
<li>名前をつけて保存</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>ファイル名は<em>念のため英数のみ</em>とし、また<em>空白文字を使わない</em>で下さい</p>
</div>
</div>
</div>
</section>
<section id="準備うまくいかない場合" class="slide level2">
<h2>準備：うまくいかない場合</h2>
<ul>
<li>Consoleパネルに表示されるメッセージが英語の場合：
<ul>
<li>エラーメッセージの日本語化（ターミナル操作が必要）</li>
<li><a href="https://maku77.github.io/r/basic/locale.html">Mac: R 環境の Locale 設定（日本語を使用する）</a></li>
<li><a href="https://niszet.hatenablog.com/entry/2022/04/25/083000">Win: (R) R4.2でWindowsでもUTF-8を設定できることを確認した</a></li>
</ul></li>
<li>インストールがうまくいかない場合：
<ul>
<li><a href="https://okumuralab.org/~okumura/stat/R-win.html">WindowsでのR/RStudioのインストール</a></li>
<li><a href="http://nineworks2.blog.fc2.com/blog-entry-123.html">RStudioで日本語ユーザー名だとパッケージがインストールできない問題の解決方法</a></li>
</ul></li>
</ul>
</section>
<section id="準備r-studioペインの見方" class="slide level2">
<h2>準備：R Studio（ペイン）の見方</h2>

<img data-src="img/pane.png" class="r-stretch"></section>
<section id="準備r-studioソースペインの外観の変更" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>
<ul>
<li>コードを書くうえで、<em>視認性はとても重要</em></li>
</ul>
<h3 id="文字の配色の変更">文字の配色の変更</h3>
<ul>
<li>メニュー &gt; Tools &gt; Global Options &gt; Appearance &gt; Editor Theme
<ul>
<li>私（苅谷）は<a href="https://github.com/max-alletsee/rstudio-themes">rstudio-themes</a>からダウンロードしたrscodeioをaddで追加しています</li>
</ul></li>
</ul>
<h3 id="不可視文字を表示">不可視文字を表示</h3>
<ul>
<li>メニュー &gt; Tools &gt; Global Options &gt; Code &gt; Display &gt; Show whitespace charactersにチェック / Indentation guides:から適当なものを選択
<ul>
<li>themeによってはIndentation guidesが適用されない（rscodeioも適用対象外）</li>
</ul></li>
</ul>
</section>
<section id="準備r-studioソースペインの外観の変更-1" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>

<img data-src="img/theme.png" class="r-stretch"></section>
<section id="準備r-studioソースペインの外観の変更-2" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>

<img data-src="img/空白の可視化.png" class="r-stretch"></section>
<section id="準備目次の追加yaml" class="slide level2">
<h2>準備：目次の追加（YAML）</h2>
<ul>
<li>YAMLを改変して､目次を表示させる
<ul>
<li>目次を付けると見出しレベルを意識しやすくなり､論理的に整ったレポートを作成できる</li>
</ul></li>
</ul>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/YAML_toc.png" style="width:50.0%"></p>
</div><div class="column" style="width:70%;">
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>YAMLは構文が厳格で、エラーが起きやすいです</li>
<li>YAML領域では、半角と全角の違いに注意し、インデントや記号（: ハイフンなど）は<em>全て半角</em>で入力すること</li>
<li>「toc:」と「true」の間に<em>半角空きあり</em></li>
<li>YAML領域は「—」で始まり「—」で終わります。<em>「—」を消さないこと</em></li>
</ul>
</div>
</div>
</div>
</div></div>
<ul>
<li>YAMLを入力できたら、outlineをクリック</li>
</ul>
</section>
<section id="準備目次の追加yaml-1" class="slide level2">
<h2>準備：目次の追加（YAML）</h2>
<ul>
<li>Renderをクリック
<ul>
<li>YAMLで設定している出力形式に従って右下のペイン（Viewer/Presentation）にレポートが出力される（全てのR Chunkが実行される（後述））</li>
</ul></li>
</ul>

<img data-src="img/toc.png" class="r-stretch"></section>
<section id="準備パッケージの追加tidyverse" class="slide level2">
<h2>準備：パッケージの追加（tidyverse）</h2>
<ul>
<li><p>modern Rは、tidyverse（整然としたデータ世界）という思想からなるパッケージ群</p></li>
<li><p>base Rには組み込まれていないので、パッケージとして追加することが必要</p></li>
<li><p>tidyverseの中身</p>
<ul>
<li>dplyr（データ操作）</li>
<li>tidyr（データ整形）</li>
<li>ggplot2（可視化）</li>
<li>readr（データ読み込み）</li>
<li>purrr（関数型操作）</li>
<li>tibble（データフレーム拡張）</li>
</ul></li>
</ul>
</section>
<section id="準備パッケージの追加tidyverse-1" class="slide level2">
<h2>準備：パッケージの追加（tidyverse）</h2>
<h3 id="r-studioで操作">7. R Studioで操作:</h3>
<ul>
<li>Consoleパネル（画面左下）にカーソルを合わせる</li>
<li>以下のコードを入力（または「クリップボード」でコピー）して実行（Enter）</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>パッケージのインストールは最初の一回だけで大丈夫です</li>
<li>次回以降は、library() で読み込むだけで使えます（後述）</li>
</ul>
</div>
</div>
</div>
</section>
<section id="準備setup-chunkの作成" class="slide level2">
<h2>準備：setup chunkの作成</h2>
<h3 id="r-chunk">R Chunk</h3>
<ul>
<li>R Chunkは、Quartoファイルの中で Rのコードを書くためのブロック</li>
<li>一つのR Chunkで、一つの作図、分析を行うのが基本</li>
</ul>
<h3 id="setup-chunk">Setup Chunk</h3>
<ul>
<li>R Chunkの一種だが、R全体の設定や、使うパッケージの読み込みをまとめて書く場所
<ul>
<li>パッケージの読み込み / データの読み込み / 前処理（縦持ちデータへの変換など）</li>
</ul></li>
</ul>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>この部分を整えておくと、後の分析がスムーズになります</p>
</div>
</div>
</div>
</section>
<section id="準備setup-chunkの作成-1" class="slide level2">
<h2>準備：Setup Chunkの作成</h2>
<h3 id="作業領域souceペイン">作業領域：Souceペイン</h3>
<ul>
<li>YAMLの下にSetup Chunkを作成</li>
<li>メニュー &gt; Code &gt; Insert Chunk &gt; Rの後にsetupと入力</li>
<li>Chunk Optionの設定（以下のコードを入力）</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="co">#| echo: false</span></span>
<span id="cb2-2"><a></a><span class="co">#| output: false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column" style="width:50%;">
<p><img data-src="img/setupchunk.png"></p>
</div></div>
<ul>
<li>echo: false:「このチャンクのコードは見せなくていい」</li>
<li>output: false：「コードを実行しても、結果は出力に表示しない」</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>コードブロックは「てんてんてん（バッククォート）」3つで始まり、同じく「てんてんてん（バッククォート）」3つで終わるのが規則です。この中にRのコードを書きます。間違って消さないようにしましょう</p>
</div>
</div>
</div>
</section>
<section id="準備パッケージの読み込み" class="slide level2">
<h2>準備：パッケージの読み込み</h2>
<ul>
<li>先に作成したSetup Chunkで、modern Rの基本パッケージ群tidyverseを読み込む</li>
</ul>
<h3 id="souceペイン内で作業">Souceペイン内で作業</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># パッケージの読み込み ---- #「# ○○-----」と書いておくと、Outlineに表示されてみやすい</span></span>
<span id="cb3-2"><a></a><span class="fu">library</span>(tidyverse) <span class="co"># modern Rの基本パッケージ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>R Chunk内では #（ハッシュ）をコードの前につけると、その行は実行されずにメモとして残せます</li>
<li><h1 id="より右側の文字もrでは実行されませんコメントアウトと呼びます">より右側の文字もRでは実行されません（コメントアウトと呼びます）</h1></li>
<li>特定のコード（行）が動かないなどの理由で、問題を特定したい場合にも便利です</li>
</ul>
</div>
</div>
</div>
</section>
<section id="準備日本語表示mac" class="slide level2">
<h2>準備：日本語表示（Mac）</h2>
<ul>
<li>ggplot（作図パッケージ）は初期設定のままでは日本語を表示できません</li>
<li>YAMLに以下のコードを書いて下さい</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># 描画設定 -----</span></span>
<span id="cb4-2"><a></a><span class="co"># フォントファミリとサイズ</span></span>
<span id="cb4-3"><a></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb4-4"><a></a>  ggplot2<span class="sc">::</span><span class="fu">theme_get</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb4-6"><a></a>)</span>
<span id="cb4-7"><a></a></span>
<span id="cb4-8"><a></a><span class="do">## text/labelのフォントファミリとサイズ</span></span>
<span id="cb4-9"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb4-10"><a></a>  <span class="st">"text"</span>,</span>
<span id="cb4-11"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb4-12"><a></a>)</span>
<span id="cb4-13"><a></a></span>
<span id="cb4-14"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb4-15"><a></a>  <span class="st">"label"</span>,</span>
<span id="cb4-16"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb4-17"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="準備日本語対応windows" class="slide level2">
<h2>準備：日本語対応（Windows）</h2>
<ul>
<li>ggplot（作図パッケージ）は初期設定のままでは日本語を表示できません</li>
<li>YAMLに以下のコードを書いて下さい</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># 描画設定 -----</span></span>
<span id="cb5-2"><a></a><span class="co"># フォントファミリとサイズ</span></span>
<span id="cb5-3"><a></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb5-4"><a></a>  ggplot2<span class="sc">::</span><span class="fu">theme_get</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb5-6"><a></a>)</span>
<span id="cb5-7"><a></a></span>
<span id="cb5-8"><a></a><span class="do">## text/labelのフォントファミリとサイズ</span></span>
<span id="cb5-9"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb5-10"><a></a>  <span class="st">"text"</span>,</span>
<span id="cb5-11"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb5-12"><a></a>)</span>
<span id="cb5-13"><a></a></span>
<span id="cb5-14"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb5-15"><a></a>  <span class="st">"label"</span>,</span>
<span id="cb5-16"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb5-17"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>文字が表示されない（＝日本語が□で表示されたら）教えてください</li>
</ul>
</section></section>
<section>
<section id="rにふれてみようpalmer-penguins" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅳ. Rにふれてみよう：palmer penguins</h1>

</section>
<section id="rにふれてみようpalmer-penguins-1" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データセットpalmer-penguins">データセット：palmer penguins</h3>
<ul>
<li><a href="https://allisonhorst.com">palmer penguins</a>は、R本体に組み込まれている練習用のデータセット（R4.5以降）
<ul>
<li>これは、パッケージを追加したり、データを読み込む必要がないことを意味する</li>
<li>従来のデータセット（irisなど）とは違い、カラム名、naなどの点で、教育的配慮のあるデータセットとされる</li>
</ul></li>
</ul>
</section>
<section id="rにふれてみようpalmer-penguins-2" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<ul>
<li>パーマーランド（南極）の3つの島に住むペンギンたちのデータ（<a href="https://allisonhorst.github.io/cv.html">Allison Horst</a>さん作成）</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="ペンギンの種類">ペンギンの種類：</h3>
<ul>
<li>Adelie（アデリーペンギン）</li>
<li>Gentoo（ジェンツーペンギン）</li>
<li>Chinstrap（ヒゲペンギン）</li>
</ul>
<h3 id="島の名前">島の名前：</h3>
<ul>
<li>Biscoe（ビスコー）</li>
<li>Dream（ドリーム）</li>
<li>Torgersen（トージャーセン）</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/penguins-small.png"></p>
</div></div>
</section>
<section id="rにふれてみようpalmer-penguins-3" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データを確認しよう">データを確認しよう</h3>
<ul>
<li>関数：Rに「こういう処理をしてね」とお願いする命令書</li>
</ul>
<h4 id="view関数">view()関数</h4>
<ul>
<li>データを表にして見やすく開く関数。データ全体をチェックしたり、列名や値をざっと確認するときに便利</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a></a>  <span class="fu">view</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h4 id="head関数">head()関数</h4>
<ul>
<li>データフレームやベクトルの先頭の数行（デフォルトは6行）だけを表示する</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-4" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データの型">データの型</h3>

<img data-src="img/データの型.png" class="r-stretch"></section>
<section id="rにふれてみようpalmer-penguins-5" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="レンダーrenderとrun">レンダー（render）とrun</h3>
<ul>
<li>render：描画
<ul>
<li>YAMLのformatで設定した形式のファイルが出力される すべてのrのコードを実行し、ファイルを出力</li>
<li>出力先：quartoと同じフォルダ。Viewer画面でも確認できる。自動的にブラウザが開く場合もある（設定？）</li>
</ul></li>
<li>run：rの実行
<ul>
<li>図や表の出力に関数する関数がある場合、chunkの下に描画される</li>
</ul></li>
</ul>
</section>
<section id="rにふれてみようpalmer-penguins-6" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="パイプ">パイプ</h3>
<ul>
<li><em>|&gt;</em> または <em>%&gt;%</em></li>
<li>modern Rの大きな特徴の一つ</li>
<li>処理を連続させるための記号
<ul>
<li>より正確には「前の結果を次の関数に渡して、処理を順番につなげるための記号」</li>
</ul></li>
<li>Rを初めて学ぶ人、あるいは他のプログラミング言語に慣れた人にとって つまずきやすく、でも、もっとも大切な考え方</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>データ <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a></a>  処理<span class="fu">A</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a></a>  処理<span class="fu">B</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>料理で喩えると：「材料を選んで → 炒めて → 味付けする」</li>
</ul>
</section>
<section id="rにふれてみようpalmer-penguins-7" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="パイプを使った書き方modern-r">パイプを使った書き方（modern R）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>penguins <span class="sc">|&gt;</span> <span class="co"># ペンギンというデータ（正確には「オブジェクト」と表現します）を使って</span></span>
<span id="cb9-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> <span class="co"># 種類ごとにグループを分けて</span></span>
<span id="cb9-3"><a></a>  <span class="fu">summarize</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># 平均の体重を計算する（na.rm = TRUEは、欠損値を除外する指示）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>オブジェクトをどう処理したいのかが書きやすい（読みやすい）</li>
</ul>
<h3 id="パイプを使わない書き方base-r">パイプを使わない書き方（base R）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="fu">summarize</span>(</span>
<span id="cb10-2"><a></a>  <span class="fu">group_by</span>(penguins, species),</span>
<span id="cb10-3"><a></a>  <span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>関数が入れ子構造（ネスト）になり、どこからどこまでが特定の関数なのかわかりにくい</li>
<li>処理の順番がわかりにくく、かっこの対応関係も見づらい</li>
</ul>
</section>
<section id="rにふれてみようpalmer-penguins-8" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="パッケージの一括インストール">パッケージの一括インストール</h3>
<ul>
<li><p>パッケージは各自の必要に応じてインストールすべきですが、時間の都合上、以下のスライドで使用するコードを一括でインストールしましょう。どのパッケージも今日、標準的なものです</p></li>
<li><p>任意のR Chunkで操作（インストール後に削除可）</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co"># インストールするパッケージをまとめて指定</span></span>
<span id="cb11-2"><a></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb11-3"><a></a>  <span class="st">"readxl"</span>,     <span class="co"># Excelファイルの読み込み</span></span>
<span id="cb11-4"><a></a>  <span class="st">"conflicted"</span>, <span class="co"># 複数のパッケージで同じ関数名があるとき、使う方を選べるようにする</span></span>
<span id="cb11-5"><a></a>  <span class="st">"stringi"</span>,    <span class="co"># 文字列操作</span></span>
<span id="cb11-6"><a></a>  <span class="st">"gt"</span>,         <span class="co"># 表作成</span></span>
<span id="cb11-7"><a></a>  <span class="st">"crosstable"</span>, <span class="co"># クロス表</span></span>
<span id="cb11-8"><a></a>  <span class="st">"skimr"</span>,      <span class="co"># データ要約</span></span>
<span id="cb11-9"><a></a>  <span class="st">"scales"</span>,     <span class="co"># 軸やラベルのスケール調整</span></span>
<span id="cb11-10"><a></a>  <span class="st">"zipangu"</span>,    <span class="co"># 元号を西暦に変換</span></span>
<span id="cb11-11"><a></a>  <span class="st">"rvest"</span>,      <span class="co"># Webスクレイピング</span></span>
<span id="cb11-12"><a></a>  <span class="st">"httr2"</span>,      <span class="co"># HTTPリクエスト</span></span>
<span id="cb11-13"><a></a>  <span class="st">"xml2"</span>,       <span class="co"># XML解析</span></span>
<span id="cb11-14"><a></a>  <span class="st">"maps"</span>,       <span class="co"># アメリカの地図情報（地理データ）</span></span>
<span id="cb11-15"><a></a>  <span class="st">"socviz"</span>,     <span class="co"># 政治・社会・教育に関連するデータセットが中心（初学者の演習や可視化の教材として便利）</span></span>
<span id="cb11-16"><a></a>  <span class="st">"paletteer"</span>,  <span class="co"># カラーパレット</span></span>
<span id="cb11-17"><a></a>  <span class="st">"ngramr"</span>,     <span class="co"># Google Ngram Trends</span></span>
<span id="cb11-18"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-9" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="パッケージの一括インストール-1">パッケージの一括インストール</h3>
<ul>
<li>以下のコードをコンソールに入力して実行</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="co"># 一括インストール</span></span>
<span id="cb12-2"><a></a><span class="fu">install.packages</span>(packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-10" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="パッケージの一括インストール-2">パッケージの一括インストール</h3>
<ul>
<li>以下のコードをSetup Chunkに入力して実行（Run）</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># パッケージの読み込み</span></span>
<span id="cb13-2"><a></a><span class="fu">library</span>(readxl)    <span class="co"># Excelファイルの読み込み</span></span>
<span id="cb13-3"><a></a><span class="fu">library</span>(conflicted)<span class="co"># 名前空間の衝突を防ぐ</span></span>
<span id="cb13-4"><a></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter) <span class="co"># filter関数はdplyrを優先</span></span>
<span id="cb13-5"><a></a><span class="fu">library</span>(stringi)   <span class="co"># 文字列操作</span></span>
<span id="cb13-6"><a></a><span class="fu">library</span>(gt)        <span class="co"># 表作成</span></span>
<span id="cb13-7"><a></a><span class="fu">library</span>(crosstable)<span class="co"># クロス表</span></span>
<span id="cb13-8"><a></a><span class="fu">library</span>(skimr)     <span class="co"># データ要約</span></span>
<span id="cb13-9"><a></a><span class="fu">library</span>(scales)    <span class="co"># 軸やラベルのスケール調整</span></span>
<span id="cb13-10"><a></a><span class="fu">library</span>(zipangu)   <span class="co"># 元号を西暦に変換</span></span>
<span id="cb13-11"><a></a><span class="fu">library</span>(rvest)     <span class="co"># Webスクレイピング</span></span>
<span id="cb13-12"><a></a><span class="fu">library</span>(httr2)     <span class="co"># HTTPリクエスト</span></span>
<span id="cb13-13"><a></a><span class="fu">library</span>(xml2)      <span class="co"># XML解析</span></span>
<span id="cb13-14"><a></a><span class="fu">library</span>(maps)      <span class="co"># アメリカの地図情報</span></span>
<span id="cb13-15"><a></a><span class="fu">library</span>(socviz)    <span class="co"># 社会・政治・教育関連データセット</span></span>
<span id="cb13-16"><a></a><span class="fu">library</span>(paletteer) <span class="co"># カラーパレット</span></span>
<span id="cb13-17"><a></a><span class="fu">library</span>(ngramr)    <span class="co"># Google Ngram Trends</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-11" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="ショートカット">ショートカット</h3>
<ul>
<li>R Chunkは頻繁に作成します。ショートカットを覚えましょう</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tips | R Chunkのショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Win: Ctrl + Alt + I<br>
</li>
<li>Mac: Command + option + I
<ul>
<li>日本語キーボード：Shift + @ / 英語キーボード：数字の1の左</li>
</ul></li>
</ul>
</div>
</div>
</div>
<ul>
<li>インデントを揃える癖をつけましょう</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tips | インデントの調整のショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Win: Ctrl + I / Mac: Command + I</li>
</ul>
</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-12" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データの型-1">データの型</h3>
<ul>
<li>すべてのオブジェクトは型（クラス）をもつ
<ul>
<li>R（tidyverse）がデータを読み､適切と思われる型を割り当てる</li>
</ul></li>
<li>重要な型
<ul>
<li>numeric（数字）</li>
<li>character（文字）</li>
<li><em>factor（ファクター（因子）：レベルを設定できる）</em></li>
<li>logical（true / false）</li>
<li>data.frame（baseRのテーブル形式）</li>
<li>tibble（tidyverseのテーブル形式）</li>
</ul></li>
</ul>
</section>
<section id="rにふれてみようpalmer-penguins-13" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データの型-2">データの型</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>同じ文字でもデータの型が違う可能性がある</strong></p>
</div>
<div class="callout-content">
<ul>
<li>numeric/character/factor</li>
<li>ggplot（作図）で特に問題になります
<ul>
<li>例えば散布図はnumeric（数字）であることが基本なので、数字以外の型の場合、プロットできません</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-14" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="データを要約する">データを要約する</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span> <span class="co"># データの中で、1つでも欠損値（NA）がある行を削除する</span></span>
<span id="cb14-3"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> <span class="co"># speciesで分類する</span></span>
<span id="cb14-4"><a></a>  <span class="fu">summarise</span>( <span class="co"># データを要約する</span></span>
<span id="cb14-5"><a></a>    <span class="at">max =</span> <span class="fu">max</span>(bill_len), <span class="co"># 「bill_len」の列の最大値</span></span>
<span id="cb14-6"><a></a>    <span class="at">min =</span> <span class="fu">min</span>(bill_len), <span class="co"># 「bill_len」の列の最小値</span></span>
<span id="cb14-7"><a></a>    <span class="at">mean =</span> <span class="fu">round</span>(<span class="fu">mean</span>(bill_len), <span class="dv">2</span>), <span class="co"># 「bill_len」の列の平均、round関数で小数点以下2桁に丸める</span></span>
<span id="cb14-8"><a></a>    <span class="at">sd =</span> <span class="fu">sd</span>(bill_len) <span class="co"># 「bill_len」の列の標準偏差、roundしないとこうなる</span></span>
<span id="cb14-9"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a></a>  <span class="fu">gt</span>() <span class="co"># 以上の集計結果を表にする</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="djdfsalbre" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#djdfsalbre table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#djdfsalbre thead, #djdfsalbre tbody, #djdfsalbre tfoot, #djdfsalbre tr, #djdfsalbre td, #djdfsalbre th {
  border-style: none;
}

#djdfsalbre p {
  margin: 0;
  padding: 0;
}

#djdfsalbre .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#djdfsalbre .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#djdfsalbre .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#djdfsalbre .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#djdfsalbre .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djdfsalbre .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djdfsalbre .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djdfsalbre .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#djdfsalbre .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#djdfsalbre .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#djdfsalbre .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#djdfsalbre .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#djdfsalbre .gt_spanner_row {
  border-bottom-style: hidden;
}

#djdfsalbre .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#djdfsalbre .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#djdfsalbre .gt_from_md > :first-child {
  margin-top: 0;
}

#djdfsalbre .gt_from_md > :last-child {
  margin-bottom: 0;
}

#djdfsalbre .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#djdfsalbre .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#djdfsalbre .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#djdfsalbre .gt_row_group_first td {
  border-top-width: 2px;
}

#djdfsalbre .gt_row_group_first th {
  border-top-width: 2px;
}

#djdfsalbre .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djdfsalbre .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#djdfsalbre .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#djdfsalbre .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djdfsalbre .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djdfsalbre .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#djdfsalbre .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#djdfsalbre .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#djdfsalbre .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djdfsalbre .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djdfsalbre .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djdfsalbre .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djdfsalbre .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djdfsalbre .gt_left {
  text-align: left;
}

#djdfsalbre .gt_center {
  text-align: center;
}

#djdfsalbre .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#djdfsalbre .gt_font_normal {
  font-weight: normal;
}

#djdfsalbre .gt_font_bold {
  font-weight: bold;
}

#djdfsalbre .gt_font_italic {
  font-style: italic;
}

#djdfsalbre .gt_super {
  font-size: 65%;
}

#djdfsalbre .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#djdfsalbre .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#djdfsalbre .gt_indent_1 {
  text-indent: 5px;
}

#djdfsalbre .gt_indent_2 {
  text-indent: 10px;
}

#djdfsalbre .gt_indent_3 {
  text-indent: 15px;
}

#djdfsalbre .gt_indent_4 {
  text-indent: 20px;
}

#djdfsalbre .gt_indent_5 {
  text-indent: 25px;
}

#djdfsalbre .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#djdfsalbre div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="max" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">max</th>
<th id="min" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">min</th>
<th id="mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mean</th>
<th id="sd" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">sd</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="species">Adelie</td>
<td class="gt_row gt_right" headers="max">46.0</td>
<td class="gt_row gt_right" headers="min">32.1</td>
<td class="gt_row gt_right" headers="mean">38.82</td>
<td class="gt_row gt_right" headers="sd">2.662597</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="species">Chinstrap</td>
<td class="gt_row gt_right" headers="max">58.0</td>
<td class="gt_row gt_right" headers="min">40.9</td>
<td class="gt_row gt_right" headers="mean">48.83</td>
<td class="gt_row gt_right" headers="sd">3.339256</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="species">Gentoo</td>
<td class="gt_row gt_right" headers="max">59.6</td>
<td class="gt_row gt_right" headers="min">40.9</td>
<td class="gt_row gt_right" headers="mean">47.57</td>
<td class="gt_row gt_right" headers="sd">3.106116</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>gt()はスライドに表示するために書いています gt()はtidyveseに入っていないパッケージです。tidyverseと同じように、インストールと読み込み（library）が必要です。標準的なパッケージですので、インストールを推奨します</p>
</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-15" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>生成AI活用の勧め</strong></p>
</div>
<div class="callout-content">
<ul>
<li>以降のコードは初学者にはやや難しく、また時間的に丁寧に解説できません（関数はシンプルな英語なので直感的には理解できるとは思いますが）</li>
<li>コードをそのまま貼り付け、解説を求めましょう</li>
</ul>
</div>
</div>
</div>
<h4 id="出力例chatgpt">出力例（ChatGPT）</h4>
<pre><code>- ① filter(!if_any(everything(), is.na))
  - 意味：欠損値（NA）が含まれている行をすべて取り除きます。
  - everything() は「すべての列」を意味します。
  - if_any(..., is.na)は「どの列か1つでもNAがあるか？」を判定します。! は「〜でない」という否定なので、「NAがない行だけ残す」ことになります。
  - 👉 欠損のない完全なデータだけを残す処理。</code></pre>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p><a href="https://dplyr.tidyverse.org">dplyr</a>も生成AIを導入しました（右上のAsk AI）。日本語にも対応しています</p>
</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-16" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="図を作るggplotに渡した後にデータを計算する">図を作る：ggplotに渡した後にデータを計算する</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span>  <span class="co"># ggplotでグラフ作成、x軸に種類、y軸に体重、棒の色を種類ごとに分ける</span></span>
<span id="cb16-3"><a></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>) <span class="sc">+</span>                  <span class="co"># 各種類の体重の平均を計算して棒グラフにする</span></span>
<span id="cb16-4"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb16-5"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,                                             <span class="co"># x軸のラベルを「種類」に変更</span></span>
<span id="cb16-6"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span>                                         <span class="co"># y軸のラベルを「体重 (g)」に変更</span></span>
<span id="cb16-7"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="rにふれてみようpalmer-penguins-17" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="図を作るggplotに渡す前にデータを整形する">図を作る：ggplotに渡す前にデータを整形する</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb17-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> mean_body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb17-5"><a></a>  <span class="fu">geom_col</span>() <span class="sc">+</span>   <span class="co"># geom_colはデータに渡されたyをそのまま棒の高さに使う</span></span>
<span id="cb17-6"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb17-7"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,</span>
<span id="cb17-8"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span></span>
<span id="cb17-9"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="rにふれてみようpalmer-penguins-18" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="相関係数の算出">相関係数の算出</h3>
<ul>
<li>bill_len: くちばしの長さ
<ul>
<li>魚をつかまえたり、巣材をくわえたりすることに関わる</li>
</ul></li>
<li>bill_dep: くちばしの奥行き
<ul>
<li>くちばしの太さや力強さの目安になる</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb18-4"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-5"><a></a>    <span class="at">cor_bill =</span> <span class="fu">round</span>(<span class="fu">cor</span>(bill_len, bill_dep), <span class="dv">3</span>)</span>
<span id="cb18-6"><a></a>  ) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="lqphnctasr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lqphnctasr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lqphnctasr thead, #lqphnctasr tbody, #lqphnctasr tfoot, #lqphnctasr tr, #lqphnctasr td, #lqphnctasr th {
  border-style: none;
}

#lqphnctasr p {
  margin: 0;
  padding: 0;
}

#lqphnctasr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lqphnctasr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lqphnctasr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lqphnctasr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lqphnctasr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lqphnctasr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lqphnctasr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lqphnctasr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lqphnctasr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lqphnctasr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lqphnctasr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lqphnctasr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lqphnctasr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lqphnctasr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lqphnctasr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lqphnctasr .gt_from_md > :first-child {
  margin-top: 0;
}

#lqphnctasr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lqphnctasr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lqphnctasr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lqphnctasr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lqphnctasr .gt_row_group_first td {
  border-top-width: 2px;
}

#lqphnctasr .gt_row_group_first th {
  border-top-width: 2px;
}

#lqphnctasr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lqphnctasr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lqphnctasr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lqphnctasr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lqphnctasr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lqphnctasr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lqphnctasr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lqphnctasr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lqphnctasr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lqphnctasr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lqphnctasr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lqphnctasr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lqphnctasr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lqphnctasr .gt_left {
  text-align: left;
}

#lqphnctasr .gt_center {
  text-align: center;
}

#lqphnctasr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lqphnctasr .gt_font_normal {
  font-weight: normal;
}

#lqphnctasr .gt_font_bold {
  font-weight: bold;
}

#lqphnctasr .gt_font_italic {
  font-style: italic;
}

#lqphnctasr .gt_super {
  font-size: 65%;
}

#lqphnctasr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lqphnctasr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lqphnctasr .gt_indent_1 {
  text-indent: 5px;
}

#lqphnctasr .gt_indent_2 {
  text-indent: 10px;
}

#lqphnctasr .gt_indent_3 {
  text-indent: 15px;
}

#lqphnctasr .gt_indent_4 {
  text-indent: 20px;
}

#lqphnctasr .gt_indent_5 {
  text-indent: 25px;
}

#lqphnctasr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lqphnctasr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="cor_bill" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cor_bill</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="species">Adelie</td>
<td class="gt_row gt_right" headers="cor_bill">0.386</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="species">Chinstrap</td>
<td class="gt_row gt_right" headers="cor_bill">0.654</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="species">Gentoo</td>
<td class="gt_row gt_right" headers="cor_bill">0.654</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-19" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="散布図の作成">散布図の作成</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span>  </span>
<span id="cb19-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_len, <span class="at">y =</span> bill_dep, <span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb19-4"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="rにふれてみようpalmer-penguins-20" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="見比べる">見比べる</h3>
<ul>
<li>species（種）とisland（島）に関係はあるの？</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a></a>  <span class="fu">group_by</span>(species, island) <span class="sc">|&gt;</span> <span class="co"># グルーピングに住んでいる島を追加</span></span>
<span id="cb20-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb20-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> mean_body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb20-5"><a></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb20-6"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb20-7"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,</span>
<span id="cb20-8"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span></span>
<span id="cb20-9"><a></a>  ) <span class="sc">+</span></span>
<span id="cb20-10"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>island) <span class="co">#指定の変数(カラム名、ここではisland)によって小さなグラフを作って並べる</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="rにふれてみようpalmer-penguins-21" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="クロス集計">クロス集計</h3>
<ul>
<li>gtsummaryパッケージを追加（インストール後、Setup Chunkで読み込み）</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a></a>  <span class="fu">tbl_cross</span>(</span>
<span id="cb21-4"><a></a>    <span class="at">row =</span> species, <span class="co"># rowに行変数</span></span>
<span id="cb21-5"><a></a>    <span class="at">col =</span> island, <span class="co"># colに列変数を指定</span></span>
<span id="cb21-6"><a></a>    <span class="at">percent =</span> <span class="st">"row"</span> <span class="co"># 行ごとの割合を表示</span></span>
<span id="cb21-7"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="mlvkxeudya" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mlvkxeudya table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mlvkxeudya thead, #mlvkxeudya tbody, #mlvkxeudya tfoot, #mlvkxeudya tr, #mlvkxeudya td, #mlvkxeudya th {
  border-style: none;
}

#mlvkxeudya p {
  margin: 0;
  padding: 0;
}

#mlvkxeudya .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mlvkxeudya .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mlvkxeudya .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mlvkxeudya .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mlvkxeudya .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlvkxeudya .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlvkxeudya .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlvkxeudya .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mlvkxeudya .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mlvkxeudya .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mlvkxeudya .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mlvkxeudya .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mlvkxeudya .gt_spanner_row {
  border-bottom-style: hidden;
}

#mlvkxeudya .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mlvkxeudya .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mlvkxeudya .gt_from_md > :first-child {
  margin-top: 0;
}

#mlvkxeudya .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mlvkxeudya .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mlvkxeudya .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mlvkxeudya .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mlvkxeudya .gt_row_group_first td {
  border-top-width: 2px;
}

#mlvkxeudya .gt_row_group_first th {
  border-top-width: 2px;
}

#mlvkxeudya .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlvkxeudya .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mlvkxeudya .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mlvkxeudya .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlvkxeudya .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlvkxeudya .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mlvkxeudya .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mlvkxeudya .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mlvkxeudya .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlvkxeudya .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlvkxeudya .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlvkxeudya .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlvkxeudya .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlvkxeudya .gt_left {
  text-align: left;
}

#mlvkxeudya .gt_center {
  text-align: center;
}

#mlvkxeudya .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mlvkxeudya .gt_font_normal {
  font-weight: normal;
}

#mlvkxeudya .gt_font_bold {
  font-weight: bold;
}

#mlvkxeudya .gt_font_italic {
  font-style: italic;
}

#mlvkxeudya .gt_super {
  font-size: 65%;
}

#mlvkxeudya .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mlvkxeudya .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mlvkxeudya .gt_indent_1 {
  text-indent: 5px;
}

#mlvkxeudya .gt_indent_2 {
  text-indent: 10px;
}

#mlvkxeudya .gt_indent_3 {
  text-indent: 15px;
}

#mlvkxeudya .gt_indent_4 {
  text-indent: 20px;
}

#mlvkxeudya .gt_indent_5 {
  text-indent: 25px;
}

#mlvkxeudya .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mlvkxeudya div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="level 1; stat_1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
island
</div></th>
<th rowspan="2" id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total</th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Biscoe</th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Dream</th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Torgersen</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">species</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Adelie</td>
<td class="gt_row gt_center" headers="stat_1">44 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">56 (37%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (34%)</td>
<td class="gt_row gt_center" headers="stat_0">152 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chinstrap</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">68 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">68 (100%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gentoo</td>
<td class="gt_row gt_center" headers="stat_1">124 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">124 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">168 (49%)</td>
<td class="gt_row gt_center" headers="stat_2">124 (36%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (15%)</td>
<td class="gt_row gt_center" headers="stat_0">344 (100%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>件数と割合を自動計算して表にしてくれる</li>
<li>見やすく整形され、発表資料にも向く</li>
</ul>
</div></div>
</section>
<section id="rにふれてみようpalmer-penguins-22" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="クロス集計-1">クロス集計</h3>
<ul>
<li>add_p()を加えるだけでカイ二乗検定（またはFisher検定）を自動で実行してくれる</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22" data-code-line-numbers="8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a></a>  <span class="fu">tbl_cross</span>(</span>
<span id="cb22-4"><a></a>    <span class="at">row =</span> species,</span>
<span id="cb22-5"><a></a>    <span class="at">col =</span> island,</span>
<span id="cb22-6"><a></a>    <span class="at">percent =</span> <span class="st">"row"</span></span>
<span id="cb22-7"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a></a>  <span class="fu">add_p</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ruwmumsbha" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ruwmumsbha table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ruwmumsbha thead, #ruwmumsbha tbody, #ruwmumsbha tfoot, #ruwmumsbha tr, #ruwmumsbha td, #ruwmumsbha th {
  border-style: none;
}

#ruwmumsbha p {
  margin: 0;
  padding: 0;
}

#ruwmumsbha .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ruwmumsbha .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ruwmumsbha .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ruwmumsbha .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ruwmumsbha .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ruwmumsbha .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ruwmumsbha .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ruwmumsbha .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ruwmumsbha .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ruwmumsbha .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ruwmumsbha .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ruwmumsbha .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ruwmumsbha .gt_spanner_row {
  border-bottom-style: hidden;
}

#ruwmumsbha .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ruwmumsbha .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ruwmumsbha .gt_from_md > :first-child {
  margin-top: 0;
}

#ruwmumsbha .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ruwmumsbha .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ruwmumsbha .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ruwmumsbha .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ruwmumsbha .gt_row_group_first td {
  border-top-width: 2px;
}

#ruwmumsbha .gt_row_group_first th {
  border-top-width: 2px;
}

#ruwmumsbha .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ruwmumsbha .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ruwmumsbha .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ruwmumsbha .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ruwmumsbha .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ruwmumsbha .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ruwmumsbha .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ruwmumsbha .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ruwmumsbha .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ruwmumsbha .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ruwmumsbha .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ruwmumsbha .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ruwmumsbha .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ruwmumsbha .gt_left {
  text-align: left;
}

#ruwmumsbha .gt_center {
  text-align: center;
}

#ruwmumsbha .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ruwmumsbha .gt_font_normal {
  font-weight: normal;
}

#ruwmumsbha .gt_font_bold {
  font-weight: bold;
}

#ruwmumsbha .gt_font_italic {
  font-style: italic;
}

#ruwmumsbha .gt_super {
  font-size: 65%;
}

#ruwmumsbha .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ruwmumsbha .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ruwmumsbha .gt_indent_1 {
  text-indent: 5px;
}

#ruwmumsbha .gt_indent_2 {
  text-indent: 10px;
}

#ruwmumsbha .gt_indent_3 {
  text-indent: 15px;
}

#ruwmumsbha .gt_indent_4 {
  text-indent: 20px;
}

#ruwmumsbha .gt_indent_5 {
  text-indent: 25px;
}

#ruwmumsbha .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ruwmumsbha div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" style="width:100%;" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="level 1; stat_1" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
island
</div></th>
<th rowspan="2" id="stat_0" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Total</th>
<th rowspan="2" id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">p-value<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
<tr class="gt_col_headings even">
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Biscoe</th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Dream</th>
<th id="stat_3" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Torgersen</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">species</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Adelie</td>
<td class="gt_row gt_center" headers="stat_1">44 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">56 (37%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (34%)</td>
<td class="gt_row gt_center" headers="stat_0">152 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chinstrap</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">68 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">68 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gentoo</td>
<td class="gt_row gt_center" headers="stat_1">124 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">124 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">168 (49%)</td>
<td class="gt_row gt_center" headers="stat_2">124 (36%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (15%)</td>
<td class="gt_row gt_center" headers="stat_0">344 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Pearson’s Chi-squared test</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-23" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="クロス集計-2">クロス集計</h3>
<ul>
<li>crosstableパッケージの場合</li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>多くの人がパッケージを開発しているため、同様の機能をもつ複数のパッケージがあります</p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a></a>  <span class="fu">crosstable</span>(<span class="at">by =</span> species,</span>
<span id="cb23-5"><a></a>             <span class="at">cols =</span> island,</span>
<span id="cb23-6"><a></a>             <span class="at">total =</span> <span class="st">"row"</span>,</span>
<span id="cb23-7"><a></a>             <span class="at">funs =</span> <span class="fu">list</span>(<span class="at">prop =</span> <span class="sc">~</span><span class="fu">prop.table</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb23-8"><a></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="kpnjumodmm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kpnjumodmm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kpnjumodmm thead, #kpnjumodmm tbody, #kpnjumodmm tfoot, #kpnjumodmm tr, #kpnjumodmm td, #kpnjumodmm th {
  border-style: none;
}

#kpnjumodmm p {
  margin: 0;
  padding: 0;
}

#kpnjumodmm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kpnjumodmm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kpnjumodmm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kpnjumodmm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kpnjumodmm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpnjumodmm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnjumodmm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kpnjumodmm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kpnjumodmm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kpnjumodmm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kpnjumodmm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kpnjumodmm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kpnjumodmm .gt_spanner_row {
  border-bottom-style: hidden;
}

#kpnjumodmm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kpnjumodmm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kpnjumodmm .gt_from_md > :first-child {
  margin-top: 0;
}

#kpnjumodmm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kpnjumodmm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kpnjumodmm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnjumodmm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kpnjumodmm .gt_row_group_first td {
  border-top-width: 2px;
}

#kpnjumodmm .gt_row_group_first th {
  border-top-width: 2px;
}

#kpnjumodmm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnjumodmm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kpnjumodmm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kpnjumodmm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnjumodmm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnjumodmm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kpnjumodmm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kpnjumodmm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kpnjumodmm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kpnjumodmm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpnjumodmm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnjumodmm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kpnjumodmm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kpnjumodmm .gt_left {
  text-align: left;
}

#kpnjumodmm .gt_center {
  text-align: center;
}

#kpnjumodmm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kpnjumodmm .gt_font_normal {
  font-weight: normal;
}

#kpnjumodmm .gt_font_bold {
  font-weight: bold;
}

#kpnjumodmm .gt_font_italic {
  font-style: italic;
}

#kpnjumodmm .gt_super {
  font-size: 65%;
}

#kpnjumodmm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kpnjumodmm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kpnjumodmm .gt_indent_1 {
  text-indent: 5px;
}

#kpnjumodmm .gt_indent_2 {
  text-indent: 10px;
}

#kpnjumodmm .gt_indent_3 {
  text-indent: 15px;
}

#kpnjumodmm .gt_indent_4 {
  text-indent: 20px;
}

#kpnjumodmm .gt_indent_5 {
  text-indent: 25px;
}

#kpnjumodmm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kpnjumodmm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a.id" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.id</th>
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">label</th>
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="Adelie" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Adelie</th>
<th id="Chinstrap" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chinstrap</th>
<th id="Gentoo" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Gentoo</th>
<th id="Total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Biscoe</td>
<td class="gt_row gt_right" headers="Adelie">44 (26.19%)</td>
<td class="gt_row gt_right" headers="Chinstrap">0 (0%)</td>
<td class="gt_row gt_right" headers="Gentoo">124 (73.81%)</td>
<td class="gt_row gt_right" headers="Total">168 (48.84%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Dream</td>
<td class="gt_row gt_right" headers="Adelie">56 (45.16%)</td>
<td class="gt_row gt_right" headers="Chinstrap">68 (54.84%)</td>
<td class="gt_row gt_right" headers="Gentoo">0 (0%)</td>
<td class="gt_row gt_right" headers="Total">124 (36.05%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Torgersen</td>
<td class="gt_row gt_right" headers="Adelie">52 (100.00%)</td>
<td class="gt_row gt_right" headers="Chinstrap">0 (0%)</td>
<td class="gt_row gt_right" headers="Gentoo">0 (0%)</td>
<td class="gt_row gt_right" headers="Total">52 (15.12%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-24" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<h3 id="代入">代入</h3>
<ul>
<li>代入 = 値や計算結果を変数や列に「入れる」こと</li>
<li>Rでは「<em>&lt;-</em>」（左向き矢印）が一般的</li>
</ul>
<h3 id="新しいオブジェクトを作る">新しいオブジェクトを作る</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>penguins2 <span class="ot">&lt;-</span></span>
<span id="cb24-2"><a></a>  penguins <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass <span class="sc">/</span> <span class="dv">1000</span>)  <span class="co"># g → kg に変換して新しい列に代入</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="オブジェクトを上書きする">オブジェクトを上書きする</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>penguins <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a></a>  penguins <span class="sc">|&gt;</span> <span class="co"># 同じオブジェクト名を指定</span></span>
<span id="cb25-3"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass))  <span class="co"># NA を除いたデータに上書き</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>元のpenguinsは NAを含む元のデータではなくなります</p>
</div>
</div>
</div>
</section>
<section id="rにふれてみようpalmer-penguins-25" class="slide level2">
<h2>Rにふれてみよう：palmer penguins</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tips | 代入演算子（&lt;-）のショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>チャンク内で
<ul>
<li>Win: Alt + 「-」キー</li>
<li>Mac: Option + 「-」キー</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tips | 特定のチャンクが動かない</strong></p>
</div>
<div class="callout-content">
<ul>
<li>原因がすぐにわからないエラーが出ても安心です（よくあることです）</li>
<li>そのチャンクだけ実行をスキップできるので、レポート全体のレンダーに影響しません（冒頭に「#| eval: false」と書く）</li>
</ul>
</div>
</div>
</div>

<img data-src="img/eval_false.png" class="r-stretch"></section></section>
<section>
<section id="rを動かしてみよう社会科学のデータ" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅴ. Rを動かしてみよう：社会科学のデータ</h1>

</section>
<section id="rを動かしてみようoecd景気先行指数" class="slide level2">
<h2>Rを動かしてみよう：OECD景気先行指数</h2>
<ul>
<li><a href="https://www.oecd.org/en/data.html">OECDデータセット</a>
<ul>
<li>Composite Leading Indicators (CLI)</li>
</ul></li>
<li>urlを指定して、データを取得
<ul>
<li>ファイルをダウンロードせず、Rに直接、渡す</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>url <span class="ot">&lt;-</span> <span class="st">"https://sdmx.oecd.org/public/rest/data/OECD.SDD.STES,DSD_STES@DF_CLI/.M.LI...AA...H?startPeriod=2023-02&amp;dimensionAtObservation=AllDimensions&amp;format=csvfilewithlabels"</span></span>
<span id="cb26-2"><a></a></span>
<span id="cb26-3"><a></a>df_oecd_cli <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url) <span class="co"># 指定したURLからデータを読み込む</span></span>
<span id="cb26-4"><a></a></span>
<span id="cb26-5"><a></a><span class="co"># URLにアクセスできない場合（同じサイトに短時間でたくさんアクセスすると、サイト側が「アクセスが多すぎる」と判断して接続を拒否することがあります。その場合は、エラーが出てデータを取得できません。以下のコメントアウトを外してrunして下さい（ハッシュタグを削除））</span></span>
<span id="cb26-6"><a></a><span class="co"># df_oecd_cli &lt;-</span></span>
<span id="cb26-7"><a></a><span class="co">#  read_csv("data/df_oecd_cli.csv")</span></span>
<span id="cb26-8"><a></a></span>
<span id="cb26-9"><a></a>df_oecd_cli <span class="ot">&lt;-</span> </span>
<span id="cb26-10"><a></a>  df_oecd_cli <span class="sc">|&gt;</span> <span class="co"># 必要な列を取り出す</span></span>
<span id="cb26-11"><a></a><span class="fu">select</span>(REF_AREA, TIME_PERIOD, OBS_VALUE) <span class="sc">|&gt;</span> </span>
<span id="cb26-12"><a></a><span class="fu">mutate</span>(<span class="at">TIME_PERIOD =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(TIME_PERIOD, <span class="st">"-01"</span>))) <span class="sc">|&gt;</span> <span class="co"># 日付形式に変換（例：2025 → "2025-01-01"）</span></span>
<span id="cb26-13"><a></a><span class="fu">mutate</span>(<span class="at">TIME_PERIOD =</span> <span class="fu">as.Date</span>(TIME_PERIOD)) <span class="co"># as.Date() で日付型を再確認（実質は不要な場合もある）</span></span>
<span id="cb26-14"><a></a></span>
<span id="cb26-15"><a></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JPN"</span>, <span class="st">"USA"</span>, <span class="st">"DEU"</span>, <span class="st">"FRA"</span>, <span class="st">"KOR"</span>) <span class="co">#主要国だけ選ぶ（主要国のオブジェクトを作る）</span></span>
<span id="cb26-16"><a></a></span>
<span id="cb26-17"><a></a>df_oecd_cli <span class="sc">|&gt;</span></span>
<span id="cb26-18"><a></a>  <span class="fu">filter</span>(REF_AREA <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> <span class="co"># REF_AREA が countries に含まれる行だけを抽出</span></span>
<span id="cb26-19"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME_PERIOD, <span class="at">y =</span> OBS_VALUE, <span class="at">color =</span> REF_AREA)) <span class="sc">+</span></span>
<span id="cb26-20"><a></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="rを動かしてみようoecd景気先行指数-1" class="slide level2">
<h2>Rを動かしてみよう：OECD景気先行指数</h2>
<h3 id="見た目を整える">見た目を整える</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>df_oecd_cli <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a></a>  <span class="fu">filter</span>(REF_AREA <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME_PERIOD, <span class="at">y =</span> OBS_VALUE, <span class="at">color =</span> REF_AREA)) <span class="sc">+</span></span>
<span id="cb27-4"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb27-6"><a></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="st">"3 months"</span>),</span>
<span id="cb27-7"><a></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_date_short</span>()</span>
<span id="cb27-8"><a></a>  ) <span class="sc">+</span></span>
<span id="cb27-9"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb27-10"><a></a>    <span class="st">"Composite Leading Indicator (CLI)"</span>,       <span class="co"># y軸ラベル</span></span>
<span id="cb27-11"><a></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="dv">8</span>),       <span class="co"># 目盛りの個数を指定</span></span>
<span id="cb27-12"><a></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>) <span class="co"># 数値表示（小数なし）</span></span>
<span id="cb27-13"><a></a>  ) <span class="sc">+</span></span>
<span id="cb27-14"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb27-15"><a></a>    <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"CLI"</span>,</span>
<span id="cb27-16"><a></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb27-17"><a></a>  ) <span class="sc">+</span></span>
<span id="cb27-18"><a></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"awtools::mpalette"</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="rを動かしてみよう訪日外客数の推移" class="slide level2">
<h2>Rを動かしてみよう：訪日外客数の推移</h2>
<ul>
<li>日本の観光統計データ &gt; 「<a href="https://statistics.jnto.go.jp/graph/#graph--inbound--travelers--transition">年別 訪日外客数の推移</a>」から「データをダウンロード」</li>
<li>エディタに貼り付けて保存
<ul>
<li>保存形式はcsvとする</li>
<li>新たにdataというフォルダを作って、そこに保存</li>
</ul></li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>e-statに格納されている多くのデータは、「表」形式（messyデータ）でまとめられており、使いづらい（大きな加工が必要。dplyr/tidyrの熟練した操作を要する）</p>
</div>
</div>
</div>
</section>
<section id="rを動かしてみよう訪日外客数の推移-1" class="slide level2">
<h2>Rを動かしてみよう：訪日外客数の推移</h2>
<ul>
<li>データの読み込み：read_csv()関数</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>read.csv関数が補完入力されるかもしれません。read.csv関数はbase Rの関数で、今日では標準ではありません（<em>.ドットと_アンダースコア</em>の違い）</p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a>df_inbound <span class="ot">&lt;-</span></span>
<span id="cb28-2"><a></a>  <span class="fu">read_csv</span>(<span class="st">"data/inbound_travelers.csv"</span>)</span>
<span id="cb28-3"><a></a></span>
<span id="cb28-4"><a></a>df_inbound <span class="sc">|&gt;</span> </span>
<span id="cb28-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Visitor Arrivals</span><span class="st">`</span>)) <span class="sc">+</span> <span class="co"># カラム名に空白や記号が含まれている場合は、バッククォート（`）で囲む</span></span>
<span id="cb28-6"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-7"><a></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb28-8"><a></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1964</span>, <span class="dv">2025</span>, <span class="at">by =</span> <span class="dv">5</span>)  <span class="co"># 5年刻み</span></span>
<span id="cb28-9"><a></a>  ) <span class="sc">+</span></span>
<span id="cb28-10"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"年"</span>,</span>
<span id="cb28-11"><a></a>       <span class="at">y =</span> <span class="st">"訪日外国人客数"</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb28-13"><a></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb28-14"><a></a>  ) <span class="co"># 指数表記を通常表記に（指数表記をあらためるためには、scalesパッケージを追加する必要があります）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section>
<section id="rを動かしてみようデータの読み込み" class="slide level2">
<h2>Rを動かしてみよう：データの読み込み</h2>
<h3 id="データの読み込み">データの読み込み</h3>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>文字コード</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Windows標準やExcel標準（日本）のCP932形式（Shift_JIS）で作成されたファイルを読み込むには、文字コードを指定する必要あります
<ul>
<li>文字化けの原因のほとんどは文字コードに起因する</li>
</ul></li>
<li>現在の世界標準の文字コードはユニコード(UTF-8)
<ul>
<li>特別の指定なく読み込める</li>
</ul></li>
<li>エディタで文字コードを変更するのではなく、読み込みの段階で文字コードを変更する（<em>locale = locale(encoding = “cp932”</em>）癖をつけましょう
<ul>
<li>元ファイルは触らないのが原則</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a><span class="fu">read_csv</span>(<span class="st">"filename.csv"</span></span>
<span id="cb29-2"><a></a>         , <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"cp932"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rを動かしてみようデータの読み込み-1" class="slide level2">
<h2>Rを動かしてみよう：データの読み込み</h2>
<h3 id="エクセルファイルを読み込む">エクセルファイルを読み込む</h3>
<ul>
<li>readxl()関数を使用
<ul>
<li>tidyverseパッケージに入っていないので、追加インストールが必要</li>
</ul></li>
</ul>
<h3 id="基本形">基本形</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb30-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="シートを指定して読み込む">シートを指定して読み込む</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb31-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"2024年データ"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="列名を含めない1行目をデータとして扱う">列名を含めない（1行目をデータとして扱う）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb32-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rを動かしてみようデータの読み込み-2" class="slide level2">
<h2>Rを動かしてみよう：データの読み込み</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>CSVエディタの勧め</strong></p>
</div>
<div class="callout-content">
<ul>
<li>CSVファイルは、単純なテキスト形式のデータです</li>
<li>Microsoft Excel で開くと、CP932形式（Shift_JIS）となります。日付や数値の形式が自動で変わってしまうことがあります</li>
<li>データを正確に扱いたい場合は、専用のCSVエディタやテキストエディタの使用をお勧めします</li>
</ul>
</div>
</div>
</div>
<ul>
<li><a href="https://www.moderncsv.com/download/">Modern CSV</a>
<ul>
<li>Windows / macOS / Windows Portable / Linux</li>
<li>基本的な操作は無償版でも十分可能</li>
</ul></li>
</ul>
</section>
<section id="rを動かしてみよう選挙" class="slide level2">
<h2>Rを動かしてみよう：選挙</h2>
<h3 id="データを読み込む">データを読み込む</h3>
<ol type="1">
<li><a href="https://drive.google.com/drive/folders/1ZkAaooz5znCVIuqgmxhyfGhq7UpOR6a3?usp=sharing">Google Drive</a>からファイルをダウンロード（出典：<a href="https://yukiyanai.github.io/jp/resources/data/hr2021_pr_parties.csv">Yuki Yanai</a>）</li>
<li>dataフォルダに保存</li>
</ol>
<ul>
<li>以下のコードは、全てのR Chunkで使うことを想定するものなので、本来はSetup Chunkに書くことが望ましい</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>df_pr_parties_2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hr2021_pr_parties.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a></a>  <span class="fu">mutate</span>(, <span class="at">.before =</span> block,</span>
<span id="cb33-3"><a></a>         <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb33-4"><a></a>  ) </span>
<span id="cb33-5"><a></a></span>
<span id="cb33-6"><a></a>df_pr_parties_2024 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hr2024_pr_parties.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-7"><a></a>  <span class="fu">mutate</span>(, <span class="at">.before =</span> block,</span>
<span id="cb33-8"><a></a>         <span class="at">year =</span> <span class="dv">2024</span></span>
<span id="cb33-9"><a></a>  )</span>
<span id="cb33-10"><a></a>  </span>
<span id="cb33-11"><a></a>df_pr_parties <span class="ot">&lt;-</span> </span>
<span id="cb33-12"><a></a>  <span class="fu">bind_rows</span>(df_pr_parties_2021, df_pr_parties_2024) <span class="sc">|&gt;</span> <span class="co"># 上記の二つのオブジェクトを結合します</span></span>
<span id="cb33-13"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-14"><a></a>    <span class="at">block =</span> <span class="fu">factor</span>(block, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"北海道"</span>, <span class="st">"東北"</span>, <span class="st">"北関東"</span>, <span class="st">"南関東"</span>, <span class="st">"東京"</span>, <span class="st">"北陸信越"</span>, <span class="st">"東海"</span>, <span class="st">"近畿"</span>, <span class="st">"中国"</span>, <span class="st">"四国"</span>, <span class="st">"九州"</span>)) <span class="co"># factorにして、レベル（順序）を指定します</span></span>
<span id="cb33-15"><a></a>  )</span>
<span id="cb33-16"><a></a></span>
<span id="cb33-17"><a></a>主要政党 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"自由民主党"</span>, <span class="st">"立憲民主党"</span>, <span class="st">"公明党"</span>, <span class="st">"国民民主党"</span>, <span class="st">"日本維新の会"</span>, <span class="st">"日本共産党"</span>, <span class="st">"社会民主党"</span>, <span class="st">"れいわ新選組"</span>, <span class="st">"参政党"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="rを動かしてみよう選挙-1" class="slide level2">
<h2>Rを動かしてみよう：選挙</h2>
<h3 id="衆議院議員選挙-比例代表得票数2021-vs.-2024">衆議院議員選挙 比例代表得票数：2021 vs.&nbsp;2024</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>df_pr_parties <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a></a>  <span class="fu">group_by</span>(year, party) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb34-4"><a></a>    <span class="at">votes =</span> <span class="fu">sum</span>(votes)</span>
<span id="cb34-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb34-6"><a></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb34-7"><a></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> 主要政党) <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-9"><a></a>    <span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"自由民主党"</span>, <span class="st">"立憲民主党"</span>, <span class="st">"公明党"</span>, <span class="st">"国民民主党"</span>, <span class="st">"日本維新の会"</span>, <span class="st">"日本共産党"</span>, <span class="st">"社会民主党"</span>, <span class="st">"れいわ新選組"</span>, <span class="st">"参政党"</span>))</span>
<span id="cb34-10"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb34-11"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> party, <span class="at">y =</span> votes, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span> <span class="co"># yearをfactorにします（標準では数字です）</span></span>
<span id="cb34-12"><a></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># 棒グラフを横並びにする</span></span>
<span id="cb34-13"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> zipangu<span class="sc">::</span><span class="fu">label_kansuji</span>()) <span class="sc">+</span> <span class="co"># y軸のラベルをわかりやすくします（zipanguパッケージ要）</span></span>
<span id="cb34-14"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"得票数"</span>, <span class="at">fill =</span> <span class="st">"年"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="rを動かしてみよう選挙-2" class="slide level2">
<h2>Rを動かしてみよう：選挙</h2>
<h3 id="衆議院議員選挙-比例代表得票率2021-vs.-2024">衆議院議員選挙 比例代表得票率：2021 vs.&nbsp;2024</h3>

<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="rを動かしてみよう金沢広域急病センター利用者数" class="slide level2">
<h2>Rを動かしてみよう：金沢広域急病センター利用者数</h2>
<h3 id="データを読み込む-1">データを読み込む</h3>
<ol type="1">
<li><a href="https://drive.google.com/drive/folders/1ZkAaooz5znCVIuqgmxhyfGhq7UpOR6a3?usp=sharing">Google Drive</a>からファイルをダウンロード（出典：<a href="https://catalog-data.city.kanazawa.ishikawa.jp/dataset/172014-kouikikyubyocenter_riyousyasuu/resource/246ad33b-8141-4672-b5ec-f6e52ae4263b">ckan: 金沢市 &gt; 金沢広域急病センター利用者数</a>）</li>
<li>dataフォルダに保存</li>
</ol>
<ul>
<li>以下のコードは、全てのR Chunkで使うことを想定するものなので、本来はSetup Chunkに書くことが望ましい</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a>df_hospital <span class="ot">&lt;-</span> </span>
<span id="cb35-2"><a></a>  <span class="fu">read_csv</span>(<span class="st">"data/金沢広域急病センター利用者数.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-4"><a></a>    曜日 <span class="ot">=</span> <span class="fu">factor</span>(曜日, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"月"</span>, <span class="st">"火"</span>, <span class="st">"水"</span>, <span class="st">"木"</span>, <span class="st">"金"</span>, <span class="st">"土"</span>, <span class="st">"日"</span>)) <span class="co"># 曜日順に並べるための処理</span></span>
<span id="cb35-5"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rを動かしてみよう金沢広域急病センター利用者数-1" class="slide level2">
<h2>Rを動かしてみよう：金沢広域急病センター利用者数</h2>
<h3 id="データの確認横持ちデータ">データの確認：横持ちデータ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a>df_hospital <span class="sc">|&gt;</span> <span class="fu">view</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>小児科/内科が別の列になっていることを確認</li>
<li>「専門」というカラムに「小児科/内科」という値が入っていると便利なのにな・・・</li>
</ul>
</section>
<section id="rを動かしてみよう金沢広域急病センター利用者数-2" class="slide level2">
<h2>Rを動かしてみよう：金沢広域急病センター利用者数</h2>
<h3 id="データの変換横持ちデータから縦持ちデータへ">データの変換：横持ちデータから縦持ちデータへ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>df_hospital_long <span class="ot">&lt;-</span> </span>
<span id="cb37-2"><a></a>  df_hospital <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb37-4"><a></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"小児科"</span>, <span class="st">"内科"</span>),</span>
<span id="cb37-5"><a></a>    <span class="at">names_to =</span> <span class="st">"専門"</span>,</span>
<span id="cb37-6"><a></a>    <span class="at">values_to =</span> <span class="st">"利用者数"</span></span>
<span id="cb37-7"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb37-8"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-9"><a></a>    専門 <span class="ot">=</span> <span class="fu">factor</span>(専門, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"内科"</span>, <span class="st">"小児科"</span>))</span>
<span id="cb37-10"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb37-11"><a></a>  <span class="fu">select</span>(日付, 曜日, 土日祝, 専門, 利用者数) <span class="sc">|&gt;</span> </span>
<span id="cb37-12"><a></a>  <span class="fu">mutate</span>(日付 <span class="ot">=</span> <span class="fu">as.POSIXct</span>(日付), <span class="co"># 日付をデータの型が「date」になるように変形」」</span></span>
<span id="cb37-13"><a></a>         日付 <span class="ot">=</span> <span class="fu">as.Date</span>(日付))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rを動かしてみよう金沢広域急病センター利用者数-3" class="slide level2">
<h2>Rを動かしてみよう：金沢広域急病センター利用者数</h2>
<h3 id="縦持ちデータカラム専門の活用">縦持ちデータ（カラム「専門」）の活用</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a>df_hospital_long <span class="sc">|&gt;</span>  </span>
<span id="cb38-2"><a></a>    <span class="fu">group_by</span>(曜日, 専門) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a></a>      利用者数_曜日 <span class="ot">=</span> <span class="fu">sum</span>(利用者数)</span>
<span id="cb38-5"><a></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 曜日, <span class="at">y =</span> 利用者数_曜日, <span class="at">fill =</span> 専門)) <span class="sc">+</span></span>
<span id="cb38-7"><a></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-37-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="rを使いこなそうmap関数スクレイピング地図情報" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅵ. Rを使いこなそう：map()関数・スクレイピング・地図情報</h1>

</section>
<section id="rを使いこなそうmap関数-penguin" class="slide level2">
<h2>Rを使いこなそう：map()関数 ＞ penguin</h2>
<h3 id="map関数の利点">map()関数の利点</h3>
<ul>
<li>グループごとに自動で処理できる
<ul>
<li>手作業でspeciesごとに分けてコードを書く必要がない</li>
<li>例：ペンギンの種類ごとに、くちばしの長さ(bill_len)と深さ(bill_dep)の関係を回帰分析で調べる</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a></a>  <span class="fu">nest</span>() <span class="sc">|&gt;</span>                  <span class="co"># グループごとにデータフレームをリスト化して1列にまとめる</span></span>
<span id="cb39-4"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-5"><a></a>    <span class="at">bill_lm_result =</span> <span class="fu">map</span>(    <span class="co"># map() でリストの各要素（データフレーム）に同じ処理を適用</span></span>
<span id="cb39-6"><a></a>      data,                  <span class="co"># 対象は nest() で作った 'data' 列</span></span>
<span id="cb39-7"><a></a>      <span class="cf">function</span>(df) {</span>
<span id="cb39-8"><a></a>        lm_result <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_len <span class="sc">~</span> bill_dep, <span class="at">data =</span> df)  <span class="co"># bill_len を目的変数、bill_dep を説明変数に回帰</span></span>
<span id="cb39-9"><a></a>        <span class="fu">return</span>(lm_result)                              <span class="co"># lm の結果を返す</span></span>
<span id="cb39-10"><a></a>      }</span>
<span id="cb39-11"><a></a>    ),</span>
<span id="cb39-12"><a></a>    <span class="at">coefficients =</span> <span class="fu">map</span>(      <span class="co"># map() で各回帰結果から係数を取り出す</span></span>
<span id="cb39-13"><a></a>      bill_lm_result, </span>
<span id="cb39-14"><a></a>      pluck, </span>
<span id="cb39-15"><a></a>      <span class="st">"coefficients"</span></span>
<span id="cb39-16"><a></a>    )</span>
<span id="cb39-17"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb39-18"><a></a>  <span class="fu">unnest_wider</span>(coefficients, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span>   <span class="co"># coefficients 列を列ごとに展開（intercept や傾きが列になる）</span></span>
<span id="cb39-19"><a></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   species [3]
  species   data     bill_lm_result coefficients_(Interc…¹ coefficients_bill_dep
  &lt;fct&gt;     &lt;list&gt;   &lt;list&gt;                          &lt;dbl&gt;                 &lt;dbl&gt;
1 Adelie    &lt;tibble&gt; &lt;lm&gt;                             23.1                 0.857
2 Gentoo    &lt;tibble&gt; &lt;lm&gt;                             17.2                 2.02 
3 Chinstrap &lt;tibble&gt; &lt;lm&gt;                             13.4                 1.92 
# ℹ abbreviated name: ¹​`coefficients_(Intercept)`</code></pre>
</div>
</div>
</section>
<section id="rを使いこなそうmap関数-penguin-1" class="slide level2">
<h2>Rを使いこなそう：map()関数 ＞ penguin</h2>
<h3 id="mapを使わない場合">map()を使わない場合</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a><span class="co"># データを種別ごとに分ける</span></span>
<span id="cb41-2"><a></a>adelie <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>)</span>
<span id="cb41-3"><a></a><span class="co"># chinstrap &lt;- penguins |&gt; filter(species == "Chinstrap")</span></span>
<span id="cb41-4"><a></a><span class="co"># gentoo &lt;- penguins |&gt; filter(species == "Gentoo")</span></span>
<span id="cb41-5"><a></a></span>
<span id="cb41-6"><a></a><span class="co"># 種別ごとに回帰分析を個別に書く</span></span>
<span id="cb41-7"><a></a>adelie_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_len <span class="sc">~</span> bill_dep, <span class="at">data =</span> adelie)</span>
<span id="cb41-8"><a></a><span class="co"># chinstrap_lm &lt;- lm(bill_len ~ bill_dep, data = chinstrap)</span></span>
<span id="cb41-9"><a></a><span class="co"># gentoo_lm &lt;- lm(bill_len ~ bill_dep, data = gentoo)</span></span>
<span id="cb41-10"><a></a></span>
<span id="cb41-11"><a></a><span class="co"># 結果を確認</span></span>
<span id="cb41-12"><a></a><span class="fu">print</span>(adelie_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bill_len ~ bill_dep, data = adelie)

Coefficients:
(Intercept)     bill_dep  
     23.068        0.857  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="co"># print(chinstrap_lm)</span></span>
<span id="cb43-2"><a></a><span class="co"># print(gentoo_lm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>回帰分析をtidyverseスタイルで行うなら、parsnipパッケージが便利です。tidymodelsパッケージに含まれています。モデル結果を表形式に整理するにはbroomパッケージも使います</p>
</div>
</div>
</div>
</section>
<section id="rを使いこなそうmap関数-選挙" class="slide level2">
<h2>Rを使いこなそう：map()関数 ＞ 選挙</h2>
<ul>
<li>map() ：同じ処理を、たくさんのデータに順番に適用する」関数
<ul>
<li>「たくさんのファイル」や「いくつかのグループ（島・年・地域など）」に対して、同じ処理（たとえば平均を出す・グラフを描く）を自動で繰り返す</li>
</ul></li>
<li>比例区の得票数を地域ブロックごとに集計、描画したい</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a><span class="co"># 1. データを整形して新しいオブジェクトに保存</span></span>
<span id="cb44-2"><a></a>df_plot <span class="ot">&lt;-</span> df_pr_parties <span class="sc">|&gt;</span></span>
<span id="cb44-3"><a></a>  <span class="fu">group_by</span>(year, party, block) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a></a>  <span class="fu">summarise</span>(<span class="at">votes =</span> <span class="fu">sum</span>(votes), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-5"><a></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> 主要政党) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a></a>  <span class="fu">mutate</span>(<span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> 主要政党))</span>
<span id="cb44-7"><a></a></span>
<span id="cb44-8"><a></a><span class="co"># 2. block ごとに分割（factor → character に変換）</span></span>
<span id="cb44-9"><a></a>df_list <span class="ot">&lt;-</span> <span class="fu">split</span>(df_plot, <span class="fu">as.character</span>(df_plot<span class="sc">$</span>block))</span>
<span id="cb44-10"><a></a></span>
<span id="cb44-11"><a></a><span class="co"># 3. ggplot を作成</span></span>
<span id="cb44-12"><a></a>plots <span class="ot">&lt;-</span> <span class="fu">map</span>(df_list, <span class="sc">~</span> <span class="fu">ggplot</span>(.x, <span class="fu">aes</span>(<span class="at">x =</span> party, <span class="at">y =</span> votes, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span></span>
<span id="cb44-13"><a></a>                       <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb44-14"><a></a>                       <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">unique</span>(.x<span class="sc">$</span>block), <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"得票数"</span>) <span class="sc">+</span></span>
<span id="cb44-15"><a></a>                       <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)))</span>
<span id="cb44-16"><a></a></span>
<span id="cb44-17"><a></a><span class="co"># 4. プロットを表示</span></span>
<span id="cb44-18"><a></a><span class="fu">walk</span>(plots, print)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="rを使いこなそうpdf-からテキストを抽出する" class="slide level2">
<h2>Rを使いこなそう：PDF からテキストを抽出する</h2>
<ul>
<li>別途、pdftoolsをインストールして下さい</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a><span class="fu">library</span>(pdftools)</span>
<span id="cb45-2"><a></a></span>
<span id="cb45-3"><a></a><span class="co"># PDFファイルを読み込む</span></span>
<span id="cb45-4"><a></a>text <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(<span class="st">"data/sample.pdf"</span>)</span>
<span id="cb45-5"><a></a></span>
<span id="cb45-6"><a></a>text <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1   # Lorem\n\n2\n\n3   &gt; Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor\n\n    incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud\n\n    exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure\n\n    dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.\n\n    Excepteur sint occaecat cupidatat non proident, sunt in culpa qui oﬃcia deserunt\n\n    mollit anim id est laborum.\n"</code></pre>
</div>
</div>
</section>
<section id="rを使いこなそうスクレイピング-総理の演説記者会見など" class="slide level2">
<h2>Rを使いこなそう：スクレイピング ＞ 総理の演説・記者会見など</h2>
<ul>
<li>首相官邸に掲載されている石破首相の「総理の演説・記者会見など」を一括取得し、speech_ishiba.rdsとして書き出す</li>
<li>スクレイピングパッケージ
<ul>
<li>rvest; httr2; xml2</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>base_urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb47-2"><a></a>  <span class="st">"https://www.kantei.go.jp/jp/102_ishiba/statement/index.html"</span>,</span>
<span id="cb47-3"><a></a>  <span class="st">"https://www.kantei.go.jp/jp/103/statement/index.html"</span></span>
<span id="cb47-4"><a></a>)</span>
<span id="cb47-5"><a></a></span>
<span id="cb47-6"><a></a>years <span class="ot">&lt;-</span> <span class="dv">2024</span><span class="sc">:</span><span class="dv">2025</span></span>
<span id="cb47-7"><a></a></span>
<span id="cb47-8"><a></a>all_index_pages <span class="ot">&lt;-</span> <span class="fu">map</span>(base_urls, <span class="cf">function</span>(base) {</span>
<span id="cb47-9"><a></a>  resp <span class="ot">&lt;-</span> <span class="fu">request</span>(base) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb47-10"><a></a>  html <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(resp)</span>
<span id="cb47-11"><a></a>  </span>
<span id="cb47-12"><a></a>  <span class="co"># index_YYYY.html のリンクも取得</span></span>
<span id="cb47-13"><a></a>  archive_links <span class="ot">&lt;-</span> html <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"a"</span>) <span class="sc">|&gt;</span> <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb47-14"><a></a>  archive_links <span class="ot">&lt;-</span> archive_links[<span class="fu">str_detect</span>(archive_links, <span class="st">"statement/index_</span><span class="sc">\\</span><span class="st">d{4}</span><span class="sc">\\</span><span class="st">.html$"</span>)]</span>
<span id="cb47-15"><a></a>  archive_links <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://www.kantei.go.jp"</span>, archive_links)</span>
<span id="cb47-16"><a></a>  </span>
<span id="cb47-17"><a></a>  <span class="fu">c</span>(base, archive_links)</span>
<span id="cb47-18"><a></a>}) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb47-19"><a></a></span>
<span id="cb47-20"><a></a>get_article_urls <span class="ot">&lt;-</span> <span class="cf">function</span>(page_url) {</span>
<span id="cb47-21"><a></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(page_url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb47-22"><a></a>  html <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(req)</span>
<span id="cb47-23"><a></a>  </span>
<span id="cb47-24"><a></a>  hrefs <span class="ot">&lt;-</span> html <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"a"</span>) <span class="sc">|&gt;</span> <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb47-25"><a></a>  </span>
<span id="cb47-26"><a></a>  <span class="co"># 102_ishiba と 103 の両方に対応</span></span>
<span id="cb47-27"><a></a>  relative_urls <span class="ot">&lt;-</span> hrefs[<span class="fu">str_detect</span>(hrefs, <span class="st">"^/jp/(102_ishiba|103)/statement/</span><span class="sc">\\</span><span class="st">d{4}/</span><span class="sc">\\</span><span class="st">d{4}.*</span><span class="sc">\\</span><span class="st">.html$"</span>)]</span>
<span id="cb47-28"><a></a>  relative_urls <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">unique</span>(relative_urls))</span>
<span id="cb47-29"><a></a>  </span>
<span id="cb47-30"><a></a>  <span class="fu">paste0</span>(<span class="st">"https://www.kantei.go.jp"</span>, relative_urls)</span>
<span id="cb47-31"><a></a>}</span>
<span id="cb47-32"><a></a></span>
<span id="cb47-33"><a></a>article_urls <span class="ot">&lt;-</span> <span class="fu">map</span>(all_index_pages, get_article_urls) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb47-34"><a></a><span class="fu">message</span>(<span class="st">"取得した記事数: "</span>, <span class="fu">length</span>(article_urls))</span>
<span id="cb47-35"><a></a></span>
<span id="cb47-36"><a></a>articles_info <span class="ot">&lt;-</span> <span class="fu">map</span>(article_urls, extract_article_info)</span>
<span id="cb47-37"><a></a>articles_info <span class="ot">&lt;-</span> <span class="fu">compact</span>(articles_info)</span>
<span id="cb47-38"><a></a>articles_df <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(articles_info)</span>
<span id="cb47-39"><a></a></span>
<span id="cb47-40"><a></a>articles_df <span class="ot">&lt;-</span> articles_df <span class="sc">|&gt;</span></span>
<span id="cb47-41"><a></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">convert_jdate</span>(date)) <span class="sc">|&gt;</span> </span>
<span id="cb47-42"><a></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb47-43"><a></a></span>
<span id="cb47-44"><a></a><span class="fu">saveRDS</span>(articles_df, <span class="st">"speech_ishiba.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="rを使いこなそう地図情報-アメリカの選挙" class="slide level2">
<h2>Rを使いこなそう：地図情報 ＞ アメリカの選挙</h2>
<h3 id="前処理">前処理</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a>us_states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb48-2"><a></a></span>
<span id="cb48-3"><a></a><span class="co"># アメリカ主要政党のカラーコード</span></span>
<span id="cb48-4"><a></a>party_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2E74C0"</span>, <span class="st">"#CB454A"</span>)</span>
<span id="cb48-5"><a></a></span>
<span id="cb48-6"><a></a>us_state_elec <span class="ot">&lt;-</span> </span>
<span id="cb48-7"><a></a>  election <span class="sc">|&gt;</span> <span class="co"># データセットsocvizに含まれています</span></span>
<span id="cb48-8"><a></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">tolower</span>(state)) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a></a>  <span class="fu">left_join</span>(us_states, <span class="at">by =</span> <span class="st">"region"</span>) <span class="co"># データの結合</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rを使いこなそう地図情報-アメリカの選挙-1" class="slide level2">
<h2>Rを使いこなそう：地図情報 ＞ アメリカの選挙</h2>
<h3 id="年アメリカ大統領選挙結果">2016年アメリカ大統領選挙結果</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a>us_state_elec <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb49-3"><a></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a></a>  <span class="fu">coord_map</span>(<span class="at">projection =</span> <span class="st">"albers"</span>, <span class="at">lat0 =</span> <span class="dv">39</span>, <span class="at">lat1 =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb49-6"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"アメリカ大統領選挙結果 2016"</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a></a>  <span class="fu">theme_map</span>(<span class="at">base_family =</span> <span class="st">"HiraKakuProN-W3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-46-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><ul>
<li>コードの出典：<span class="citation" data-cites="HealyK:2021book1_translJA">ヒーリー， (<a href="#/引用文献-1" role="doc-biblioref" onclick="">2021</a>)</span></li>
</ul>
</section>
<section id="rを使いこなそう地図情報-アメリカの人口密度" class="slide level2">
<h2>Rを使いこなそう：地図情報 ＞ アメリカの人口密度</h2>
<h3 id="アメリカの人口密度">アメリカの人口密度</h3>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a></a>county_full <span class="ot">&lt;-</span></span>
<span id="cb50-2"><a></a>  county_map <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a></a>  <span class="fu">left_join</span>(county_data, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb50-4"><a></a></span>
<span id="cb50-5"><a></a>county_full <span class="sc">|&gt;</span>  </span>
<span id="cb50-6"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat,</span>
<span id="cb50-7"><a></a>         <span class="at">fill =</span> pop_dens,</span>
<span id="cb50-8"><a></a>         <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb50-9"><a></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb50-10"><a></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb50-11"><a></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb50-12"><a></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-10"</span>, <span class="st">"10-50"</span>, <span class="st">"50-100"</span>, <span class="st">"100-500"</span>, <span class="st">"500-1,000"</span>, <span class="st">"1,000-5,000"</span>, <span class="st">"&gt;5,000"</span>)) <span class="sc">+</span></span>
<span id="cb50-13"><a></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Population per</span><span class="sc">\n</span><span class="st">square mile"</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a></a>  <span class="fu">theme_map</span>() <span class="sc">+</span></span>
<span id="cb50-15"><a></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-16"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-47-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><ul>
<li>コードの出典：<span class="citation" data-cites="HealyK:2021book1_translJA">ヒーリー， (<a href="#/引用文献-1" role="doc-biblioref" onclick="">2021</a>)</span></li>
</ul>
</section>
<section id="rを使いこなそうおまけgoogle-ngram-trends" class="slide level2">
<h2>Rを使いこなそう（おまけ）：Google Ngram Trends</h2>
<ul>
<li>別途、ngramrをインストールして下さい</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="fu">library</span>(ngramr)</span>
<span id="cb51-2"><a></a></span>
<span id="cb51-3"><a></a>words <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cicero"</span>, <span class="st">"Tacitus"</span>, <span class="st">"Sallust"</span>,<span class="st">"Plutarch"</span>, <span class="st">"Aristotle"</span>, <span class="st">"Shakespeare"</span>, <span class="st">"Milton"</span>)</span>
<span id="cb51-4"><a></a></span>
<span id="cb51-5"><a></a>df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(words, <span class="sc">~</span><span class="fu">ngram</span>(.x, <span class="at">corpus =</span> <span class="st">"eng_gb_2019"</span>, <span class="at">year_start =</span> <span class="dv">1500</span>, <span class="at">year_end =</span> <span class="dv">2020</span>))</span>
<span id="cb51-6"><a></a></span>
<span id="cb51-7"><a></a>df <span class="sc">|&gt;</span> </span>
<span id="cb51-8"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Frequency, <span class="at">color =</span> Phrase)) <span class="sc">+</span></span>
<span id="cb51-9"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"ggthemr::solarized"</span>) <span class="sc">+</span></span>
<span id="cb51-11"><a></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-12"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Google Ngram Trends"</span>, <span class="at">y =</span> <span class="st">"Frequency (%)"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="さらに学ぶために" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅶ.さらに学ぶために</h1>

</section>
<section id="基本書" class="slide level2">
<h2>基本書</h2>
<ul>
<li>Wickham, Hadley and Çetinkaya-Rundel, Mine and Grolemund, Garrett. ‘<a href="https://r4ds.hadley.nz">R for Data Science (2e)</a>’</li>
<li>キーラン・ヒーリー（2021）『データ分析のためのデータ可視化入門』（瓜生真也・ 江口哲史・三村喬生 訳）、講談社（<a href="https://www.kspub.co.jp/book/detail/5164044.html">LINK</a>）</li>
<li>松村優哉・湯谷啓明・紀ノ定保礼・前田和寛（2021）『改訂2版 RユーザのためのRStudio「実践」入門：tidyverseによるモダンな分析フローの世界』、技術評論社（<a href="https://gihyo.jp/book/2021/978-4-297-12170-9">LINK</a>）</li>
<li>松村優哉・瓜生真也・吉村広志（2023）『Rユーザのためのtidymodels「実践」入門：モダンな統計・機械学習モデリングの世界』、技術評論社（<a href="https://gihyo.jp/book/2018/978-4-7741-9853-8">LINK</a>）</li>
<li>Kosuke Imai and Nora Webb Williams, “Quantitative Social Science: An Introduction in tidyverse”（<a href="https://press.princeton.edu/books/hardcover/9780691222271/quantitative-social-science">LINK</a>、旧版（非tidyverse）は翻訳あり（<a href="https://www.iwanami.co.jp/book/b352348.html">LINK</a>）</li>
</ul>
</section>
<section id="基本書-1" class="slide level2">
<h2>基本書</h2>
<ul>
<li>轟亮・杉野勇・平沢和司編『入門・社会調査法〔第4版〕：2ステップで基礎から学ぶ』（<a href="https://www.hou-bun.com/cgi-bin/search/detail.cgi?c=ISBN978-4-589-04141-8">LINK</a>）</li>
</ul>
</section>
<section id="専門的なパッケージ" class="slide level2">
<h2>専門的なパッケージ</h2>
<ul>
<li>社会科学：<a href="http://www.strengejacke.de/sjPlot/index.html">sjPlot</a>
<ul>
<li>回帰分析結果の可視化、アンケートデータの表作成</li>
</ul></li>
<li>政治学（議会の構成）：<a href="https://zmeers.github.io/ggparliament/">ggparliament</a>
<ul>
<li>議席構成や投票結果の可視化</li>
</ul></li>
<li>経済学：<a href="https://business-science.github.io/tidyquant/">tidyquant</a>
<ul>
<li>株価データや金融指標の分析、時系列処理</li>
</ul></li>
<li>心理学：<a href="https://cran.r-project.org/web/packages/psych/index.html">psych</a>
<ul>
<li>心理尺度の分析、因子分析、信頼性分析</li>
<li>psychの補助ツール：<a href="https://personality-project.org/r/psych-manual.pdf">psychTools</a></li>
</ul></li>
</ul>
</section>
<section id="専門的なパッケージ-1" class="slide level2">
<h2>専門的なパッケージ</h2>
<ul>
<li>分子生物学・ゲノム科学 <a href="https://cran.r-project.org/web/packages/gggenes/vignettes/introduction-to-gggenes.html">gggenes</a>
<ul>
<li>遺伝子・オペロン構造の可視化</li>
</ul></li>
<li>医学・疫学：<a href="https://github.com/therneau/survival">survival</a>
<ul>
<li>生存解析、カプラン・マイヤー曲線の描画</li>
</ul></li>
<li>ネットワーク分析：<a href="https://igraph.org">igraph</a>
<ul>
<li>ネットワーク・関係データの解析・可視化</li>
</ul></li>
<li>時系列分析：<a href="https://github.com/robjhyndman/forecast">forecast</a>
<ul>
<li>経済・環境データの予測・解析</li>
</ul></li>
</ul>
</section>
<section id="データ" class="slide level2">
<h2>データ</h2>
<h3 id="e-statの処理">e-statの処理</h3>
<ul>
<li><a href="https://uchidamizuki.quarto.pub/blog/posts/2022/12/call-e-stat-api-in-r.html">Rで日本の統計データを効率的に取得しよう</a></li>
<li><a href="https://icu-hsuzuki.github.io/ds4aj/estat.html">みんなのデータサイエンス：e-Stat</a></li>
<li><a href="https://indenkun.hatenablog.com/entry/2023/02/14/144118">Rでe-statからxls（xlsx）ファイルをダウンロードするときにうまくいかなかったときに対処したメモ</a></li>
<li><a href="https://yo5uke.com/pages/tips/240622_census_cleansing/index.html">国勢調査データのクレンジング</a></li>
<li><a href="https://yo5uke.com/pages/tips/240622_census_cleansing/index.html">simplecensus</a></li>
</ul>
<h3 id="政治に関わる諸データ">政治に関わる諸データ</h3>
<ul>
<li><a href="https://www.soumu.go.jp/senkyo/senkyo_s/data/index.html">総務省トップ &gt; 政策 &gt; 選挙・政治資金制度 &gt; 選挙 &gt; 選挙関連資料</a></li>
<li><a href="https://gentokatozemi.github.io/projects/usefreedata/">加藤言人ゼミナール &gt; Rによる無料データの入手と利用</a></li>
</ul>
</section>
<section id="教材" class="slide level2">
<h2>教材</h2>
<h3 id="学部生向け授業教材">学部生向け授業教材</h3>
<ul>
<li><a href="https://kariyach.github.io/teaching/RandQuarto_2025/">RとQuartoではじめるデータサイエンス：データを可視化する《2025》</a>
<ul>
<li>私（苅谷）が授業に作成した教材です。本論で挙げたものが多いですが、可視化の体裁変更などは参考になると思います</li>
</ul></li>
</ul>
<h3 id="初学者向け教材">初学者向け教材</h3>
<ul>
<li>宋財泫・矢内勇生 <a href="https://www.jaysong.net/RBook/">私たちのR：ベストプラクティスの探求</a></li>
<li><a href="https://qiita.com/nekobo/items/cbf32a13637273f229da">R初学者のためのtidyverse100本ノック</a></li>
</ul>
</section></section>
<section>
<section id="引用文献" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>引用文献</h1>

</section>
<section id="引用文献-1" class="slide level2 smaller scrollable">
<h2>引用文献</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-HealyK:2021book1_translJA" class="csl-entry" role="listitem">
ヒーリー，キーラン., 2021. データ分析のためのデータ可視化入門, 瓜生真也・江口哲史・三村喬生 訳. 講談社.
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../../site_libs/revealjs/plugin/multimodal/multimodal.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'scrollProgress': "true",
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"wide","numbers":true},
'chalkboard': {"buttons":false},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, Multimodal, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/kariyach\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // default icon
                link.classList.add("external");
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>