<!DOCTYPE html>
<html lang="en"><head>
<link href="../../img/favicon-16x16.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.34">

  <meta name="author" content="苅谷千尋">
  <meta name="dcterms.date" content="2025-11-02">
  <title>CHIHIRO KARIYA – 初心者向けR Studioの使い方</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-b19a2bf941cb4055375897722564be0c.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/multimodal/multimodal.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
  <script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
  <link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/logo_金沢大学.png" data-background-position="90% 90%" data-background-size="10%" class="quarto-title-block center">
  <h1 class="title">初心者向けR Studioの使い方</h1>
  <p class="subtitle">Ｒを用いて学ぶ量的テキスト分析講習会</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
苅谷千尋 <a href="https://orcid.org/0009-0008-3085-947X" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:kariyach@staff.kanazawa-u.ac.jp">kariyach@staff.kanazawa-u.ac.jp</a>
</div>
        <p class="quarto-title-affiliation">
            金沢大学
          </p>
    </div>
</div>

  <p class="date">November 2, 2025</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#/実行環境と自己紹介" id="/toc-実行環境と自己紹介">0. 実行環境と自己紹介</a></li>
<li><a href="#/この講習会で学べること-学べないこと" id="/toc-この講習会で学べること-学べないこと">Ⅰ. この講習会で学べること / 学べないこと</a></li>
<li><a href="#/rの基礎概念" id="/toc-rの基礎概念">Ⅱ. Rの基礎概念</a></li>
<li><a href="#/r環境の整備" id="/toc-r環境の整備">Ⅲ. R環境の整備</a></li>
<li><a href="#/基本編rにふれてみようpalmer-penguins" id="/toc-基本編rにふれてみようpalmer-penguins">Ⅳ. 《基本編》Rにふれてみよう：palmer penguins</a></li>
<li><a href="#/実践編rを動かしてみよう社会科学のデータ" id="/toc-実践編rを動かしてみよう社会科学のデータ">Ⅴ. 《実践編》Rを動かしてみよう：社会科学のデータ</a></li>
<li><a href="#/発展編rを使いこなそうスクレーピングmap関数ほか" id="/toc-発展編rを使いこなそうスクレーピングmap関数ほか">Ⅵ. 《発展編》Rを使いこなそう：スクレーピング・map()関数ほか</a></li>
<li><a href="#/さらに学ぶために" id="/toc-さらに学ぶために">Ⅶ. さらに学ぶために</a></li>
<li><a href="#/参考文献" id="/toc-参考文献">参考文献</a></li>
</ul>
</nav>
</section>
<section>
<section id="実行環境と自己紹介" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>0. 実行環境と自己紹介</h1>

</section>
<section id="実行環境" class="slide level2">
<h2>実行環境</h2>
<ul>
<li>R version 4.5.1 (2025-06-13),
<ul>
<li>nickname: Great Square Root <sup>1</sup> <sup>2</sup></li>
</ul></li>
<li>R Studio 2025.09.2+418
<ul>
<li>release name: ucumberleaf Sunflower</li>
</ul></li>
<li>Platform aarch64, darwin20</li>
<li>Running under: macOS Tahoe 26.1</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>nicknameは、Charles M. SchulzのPeanutsにちなんで名付けられる（<a href="https://www.youtube.com/watch?v=z1vTSdRolgI">R Consortium: What’s in a name? 20 years of R release management (via YouTube)</a>; <a href="https://en.wikipedia.org/wiki/R_(programming_language)#Version_names">Wikipedia</a>)。</p></li><li id="fn2"><p>Charles M. Schulz, Peanut, “Great Square Root”: Charlie Brown, ‘I HATE BEING A NOTHING! I REFUSE TO GO THROUGH THE REST OF MY LIFE AS A ZERO!’, Lucy Van Pelt, ‘WHAT WOULD YOU LIKE TO BE, CHARLIE BROWN, A FIVE? OR HOW ABOUT A TWENTY-SIX? OR A PAR SEVENTY-TWO?’, ‘I KNOW WHAT YOU COULD BE, CHARLIE BROWN…A SQUARE ROOT!’,‘I THINK YOUD MAKE A GREAT SQUARE ROOT, CHARLIE BROWN’, Brown, ‘I CANT STAND IT!’</p></li></ol></aside></section>
<section id="自己紹介" class="slide level2">
<h2>自己紹介</h2>
<ul>
<li>氏名：苅谷千尋（かりやちひろ）</li>
<li>所属：金沢大学 教育支援センター
<ul>
<li>主担当業務：高大接続コア・センター業務</li>
</ul></li>
<li>専門：政治学 &gt; 政治思想史（イギリス）
<ul>
<li>18世紀イギリスの議会政治と議会ジャーナリズム</li>
<li>レトリックの受容史：キケロ；サルスティウス；タキトゥス</li>
</ul></li>
<li>Webサイト
<ul>
<li><a href="https://kariyach.github.io">personal website - en</a></li>
<li><a href="https://researchmap.jp/kariya/">researchmap - ja</a></li>
</ul></li>
</ul>
</section>
<section id="自己紹介レトリックの受容史" class="slide level2">
<h2>自己紹介：レトリックの受容史</h2>
<h3 id="プルタルコス">プルタルコス</h3>
<div class="columns">
<div class="column" style="width:85%;">
<blockquote>
<p>民衆が演説をどう受け止めるかに関心を持たない者は、すなわち寡頭制を支持する者、説得よりも暴力に頼ろうとする者である。</p>
</blockquote>
</div><div class="column" style="width:15%;">
<p><img data-src="img/Plutarch.jpg" style="width:80.0%"></p>
</div></div>
<h3 id="タキトゥス">タキトゥス</h3>
<div class="columns">
<div class="column" style="width:85%;">
<blockquote>
<p>今昔を比較して暇を潰す老人らは、つぎのことに気がついた。国家を統治した歴代の元首のうちで、他人の雄弁術を必要としたのは、ネロが最初であると。</p>
</blockquote>
</div><div class="column" style="width:15%;">
<p><img data-src="img/tacitus.jpg" style="width:80.0%"></p>
</div></div>
</section>
<section id="自己紹介レトリックの受容史-議会ジャーナリズム" class="slide level2">
<h2>自己紹介：レトリックの受容史 / 議会ジャーナリズム</h2>
<h3 id="サミュエルジョンソンthe-gentlemans-magazine">サミュエル・ジョンソン（The Gentleman’s Magazine）</h3>
<div class="columns">
<div class="column" style="width:80%;">
<blockquote>
<p>最後に演説された貴族議員〔Hurgo院Heryef卿〕はあまりに偉大な雄弁の達人です。その巧みさゆえに、人は、彼の言葉を聞くに当たって、喜びから自然に生まれるあらゆる注意力を向けることがありません。聴き手の心には、部分的な表現や巧みな推論に惑わされるのではないか、という恐れから不安が生じるものです。しかし、彼はこのような<em>あらゆる不安を生じさせないほどに恐ろしい、理路整然と論じられる人</em>（reasoner）なのです。諸君、私が常に恐れているのは、この貴族議員の想像力が与える装飾（ornaments）のなかで、<em>誤謬が真実であるかのように見えすぎてしまう</em>ことなのです。そしてまた、理性の光によって導かれる自分自身を想像しながらも、その詭弁（sophitry）が私の知性（understanding）を惑わすことなのです。諸君、そこで私は、彼の装飾を再検討し、それが<em>真実の力によるものなのか、それとも雄弁によるものなのか</em>、私は試してみようと思う。</p>
</blockquote>
</div><div class="column" style="width:20%;">
<p><img data-src="img/SamuelJohnson.jpg"></p>
<p><img data-src="img/gentleman-s-magazine-1731.jpg"></p>
</div></div>
</section>
<section id="自己紹介レトリックの受容史-議会ジャーナリズム-1" class="slide level2">
<h2>自己紹介：レトリックの受容史 / 議会ジャーナリズム</h2>
<h3 id="エドマンドバーク">エドマンド・バーク</h3>
<div class="columns">
<div class="column" style="width:80%;">
<!-- 1793年10月29日に出された政府声明は､これまでに発せられたあらゆる政府の文書のなかで､もっとも雄弁であり､また完成度の高い文体で書かれ､トピックの選択はもっとも思慮深く､配列はもっとも整然としており､潤色もまたもっともゆたかで､それでいて少しの誇張もない。 -->
<blockquote>
<p>ある古代の著述家（プルタルコスだと思う）は､「聴衆の心に刺を刺した唯一の雄弁家」と呼ばれるペリクレスの雄弁について､幾つか詩を引用している。ペリクレスと同様に､<em>この声明の雄弁さは､真の人間性（humanity）の感性と矛盾せず､むしろ感性を強化するものであり､私の心には皮膚以上に深く刺さった刺が残っている</em>。この刺は､殺人者が外科であらゆる手を尽くして取り除こうとしても取り除くことはできず､また､<em>この刺が生み出した胸の高鳴りは､強奪や没収という皮膚を和らげる湿布薬をもってしても和らげることはできない。私はこの〔革命フランス〕共和国を愛すことができない</em>。</p>
</blockquote>
</div><div class="column" style="width:20%;">
<p><img data-src="img/Burke.jpg"></p>
</div></div>
</section></section>
<section>
<section id="この講習会で学べること-学べないこと" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅰ. この講習会で学べること / 学べないこと</h1>

</section>
<section id="この講習会で学べること-学べないこと-1" class="slide level2">
<h2>この講習会で学べること / 学べないこと</h2>
<h3 id="学べること">学べること</h3>
<ul>
<li>Rの何がよいのか、Rで何ができるかの理解</li>
<li>Rの基本操作の習得（基本編；実践編）</li>
<li>Rの応用操作の見通し（発展編）</li>
</ul>
<h3 id="学べないこと">学べないこと</h3>
<ul>
<li>データの形を整える操作（前処理）の詳細</li>
<li>ggplotで作図した図の見た目（文字の大きさなど）を細かく変える方法</li>
<li>専門性の高いパッケージ</li>
<li>専門性の高い分析手法（回帰分析の発展的手法、パス解析、因子分析、多重指標モデルなど）</li>
</ul>
</section></section>
<section>
<section id="rの基礎概念" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅱ. Rの基礎概念</h1>

</section>
<section id="基礎なぜrなのか-なぜquartoなのか" class="slide level2">
<h2>基礎：なぜRなのか / なぜQuartoなのか</h2>
<h3 id="コードスクリプト">1. コード（スクリプト）</h3>
<ul>
<li>再現可能性
<ul>
<li>コードは<em>すべての手順が残る</em>
<ul>
<li>真似しやすい / <em>生成AIと親和性が高い</em> / <em>ミスも再現できる</em> / 共同作業・共同研究しやすい</li>
</ul></li>
<li>Cf. マウス操作（GUI）中心：<a href="https://www.microsoft.com/ja-jp/microsoft-365/excel?msockid=2fc8d8cc7e2a6c5821f0ceb37f326da4">Microsoft Excel</a>; <a href="https://www.ibm.com/jp-ja/products/spss">SPSS</a>; <a href="https://khcoder.net">KH Coder</a></li>
</ul></li>
<li>作業の効率化
<ul>
<li>一度作ったコード（データ処理）を別のデータでも使い回せる</li>
</ul></li>
<li>安全性
<ul>
<li><em>元データ（ファイル）を加工しない</em></li>
<li>Rが、メモリ上にデータを保持し、そのコピーを操作する</li>
</ul></li>
</ul>
</section>
<section id="基礎なぜrなのか-なぜquartoなのか-1" class="slide level2">
<h2>基礎：なぜRなのか / なぜQuartoなのか</h2>
<h3 id="r言語の特性">2. R言語の特性</h3>
<ul>
<li><a href="https://www.r-project.org/about.html">R</a>：統計解析・データ分析に特化して開発された言語、構文
<ul>
<li>Cf. <a href="https://www.python.org">Python</a>：機械学習・AI・Web系のライブラリに強みあり</li>
</ul></li>
</ul>
<h3 id="豊富な可視化ツール">3. 豊富な可視化ツール</h3>
<ul>
<li><a href="https://ggplot2.tidyverse.org">ggplot2</a> / <a href="https://pmassicotte.github.io/paletteer_gallery/">カラーパレットパッケージ</a></li>
</ul>
<h3 id="オープンソースと親切なコミュニティ">4. オープンソースと親切なコミュニティ</h3>
<ul>
<li><em>各専門分野の研究者が､当該分野に最適なパッケージを作っている</em>
<ul>
<li>私（苅谷の場合）：<a href="#/Google-Ngram-Trends">Google Ngram Trends</a>; <a href="https://cran.r-project.org/web/packages/gutenbergr/refman/gutenbergr.html">gutenbergr</a></li>
</ul></li>
<li>困っていることはみんな一緒（先達の回答が参考になる）
<ul>
<li><a href="https://tokyor.connpass.com">Tokyo.R</a> / <a href="https://r-wakalang.slack.com/join/shared_invite/enQtMzI3OTUxMjMyMjYwLTlhMDMxYjJkZmY3NDhmOWFlNGJmNTgyY2FiMzRjZmQxMzFiM2E3YzAwZGYzZDY4MGZiYTQ2YzMzOWRlMWRjMWY#/shared-invite/email">Tokyo.R—Slack</a> / <a href="https://kanazawar.connpass.com/event/369362/?utm_campaign=event_publish_to_series_watcher&amp;utm_source=notifications&amp;utm_medium=email&amp;utm_content=detail_btn">Kanazawa.R</a>（次回11月15日(土)）</li>
</ul></li>
</ul>
</section>
<section id="基礎なぜrなのか-なぜquartoなのか-2" class="slide level2">
<h2>基礎：なぜRなのか / なぜQuartoなのか</h2>
<h3 id="簡易的な記述法quarto">5. 簡易的な記述法（Quarto）</h3>
<ul>
<li><a href="https://www.markdownguide.org/cheat-sheet/">Markdown</a></li>
</ul>
<table class="caption-top">
<thead>
<tr class="header">
<th>要素</th>
<th>Markdown構文</th>
<th>例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>見出し</td>
<td><code># H1</code><br><code>## H2</code></td>
<td>H1 見出し <br> H2 見出し</td>
</tr>
<tr class="even">
<td>太字</td>
<td><code>**bold text**</code></td>
<td><strong>bold text</strong></td>
</tr>
<tr class="odd">
<td>イタリック</td>
<td><code>*italicized text*</code></td>
<td><em>italicized text</em></td>
</tr>
<tr class="even">
<td>引用</td>
<td><code>&gt; blockquote</code></td>
<td>&gt; blockquote</td>
</tr>
<tr class="odd">
<td>リンク</td>
<td><code>[金沢大学](https://www.kanazawa-u.ac.jp)</code></td>
<td><a href="https://www.kanazawa-u.ac.jp">金沢大学</a></td>
</tr>
<tr class="even">
<td>画像</td>
<td><code>![alt text](img/logo_金沢大学.jpg)</code></td>
<td><img data-src="img/logo_金沢大学.jpg" style="width:30.0%" alt="alt text"></td>
</tr>
</tbody>
</table>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>色や文字の大きさは、別途、CSSファイルを用意して、変更する必要があります</p>
</div>
</div>
</div>
</section>
<section id="基礎なぜrなのか-なぜquartoなのか-3" class="slide level2">
<h2>基礎：なぜRなのか / なぜQuartoなのか</h2>
<h3 id="レポーティング機能と多様な出力形態quarto">6. レポーティング機能と多様な出力形態（Quarto）</h3>
<ul>
<li>Rは単なる分析ツールではなく、結果をそのままレポートやスライドとしてまとめるレポーティング機能を備える</li>
<li>出力形式は多様であり、YAML（ヤムル・後述）の設定を少し変えるだけ
<ul>
<li>Documents: <a href="https://quarto.org/docs/output-formats/html-basics.html">html</a>; <a href="https://quarto.org/docs/output-formats/ms-word.html">MS Word</a>; <a href="https://quarto.org/docs/output-formats/typst.html">PDF: Typst</a></li>
<li>Presentations: <a href="https://quarto.org/docs/presentations/revealjs/">reveal.js</a>; <a href="https://quarto.org/docs/presentations/powerpoint.html">PowerPoint</a>; <a href="https://quarto.org/docs/presentations/beamer.html">PDF: Beamer</a></li>
<li><a href="https://quarto.org/docs/dashboards/">Dashboards</a></li>
<li><a href="https://quarto.org/docs/websites/">Website</a></li>
</ul></li>
</ul>
<h3 id="無料">7. 無料</h3>
</section>
<section id="基礎rの構造" class="slide level2">
<h2>基礎：Rの構造</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">graph BT
    A(["&lt;strong&gt;base R&lt;/strong&gt;
Rの基本構文・関数
例: mean(), sum(), if"]) --&gt; 
    B(["&lt;strong&gt;modern R&lt;/strong&gt;
便利な文法・スタイル
例: |&gt; パイプ, tibble, dplyr 文法,&lt;br&gt; ggplot2 文法"]) --&gt; 
    C(["&lt;strong&gt;Packages&lt;/strong&gt;
Rに追加するツール集
例: tidyverse, ggplot2,&lt;br&gt;readr, shiny"])


%% ノードのスタイル
style A text-align:center
style B text-align:center
style A text-align:center, fill:#FFD700,stroke:#333,stroke-width:1px,font-weight:bold;
style B text-align:center, fill:#87CEFA,stroke:#333,stroke-width:1px,font-weight:bold;
style C text-align:center, fill:#90EE90,stroke:#333,stroke-width:1px,font-weight:bold;
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li>Packages
<ul>
<li>目的別に追加するツール：<em>家具や家電</em></li>
</ul></li>
<li>modern R：tidyな（整然とした）R:
<ul>
<li>Hadley Wickham（ハドリー・ウィッカム）が2016年に開発（<a href="https://business.nikkei.com/atcl/report/16/122700258/010900004/">統計言語 「R」の神はなぜ無償で貢献したのか</a>）</li>
<li>近年の改良で、より読みやすく・便利になった文法：<em>家の骨組み・壁・柱、設計の考え方</em></li>
</ul></li>
<li>base R：統計学者が1990年代に開発（S言語を継承）
<ul>
<li>R言語そのもの：<em>家の基礎部分</em></li>
</ul></li>
</ul>
</div></div>
<!-- - tidyverseは家具も文法も含むが、文法部分はmodern R、インストールして使う部分はPackagesに分類できる -->
</section>
<section id="基礎rの手順" class="slide level2">
<h2>基礎：Rの手順</h2>
<div class="center">
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    Start([YAML設定（ドキュメントの設定）:&lt;br&gt; タイトル、出力形式、テーマなど]) --&gt; B[データの読み込み・前処理:&lt;br&gt; dplyr / tidyr
    &lt;br&gt;（フィルタリング / 新列作成・計算&lt;br&gt;/ 縦持ち・横持ち変換 / 欠損値処理）]
    B --&gt; C1[データの概要と可視化:&lt;br&gt; skim, gt_summary / ggplot2]
    B --&gt; C2[統計分析・モデル構築:&lt;br&gt; lm, glm, 因果推論]
    C1 --&gt; D[結果の評価・解釈:&lt;br&gt; broom, modelsummary, performance]
    C2 --&gt; D
    D --&gt; End([レポート作成（レンダー）:&lt;br&gt; knitr / rmarkdown&lt;br&gt;（pdf; reveal.js; webpage; docx; pptx; pdf）])

    %% 色付け
    style Start fill:#a2d4f1,stroke:#333,stroke-width:2px
    style End fill:#f1d4a2,stroke:#333,stroke-width:2px
    style C1 fill:#d4f1a2,stroke:#333,stroke-width:1px
    style C2 fill:#f1a2d4,stroke:#333,stroke-width:1px
    
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</div>
</section>
<section id="基礎整然データと雑然データ" class="slide level2">
<h2>基礎：整然データと雑然データ</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="整然tidyデータ">整然（tidy）データ</h3>
<ol type="1">
<li>各変数は独立した列で表現される</li>
<li>観測した値は1行に記録される</li>
<li>観測データの集合はテーブルを表現する</li>
</ol>
<p>（<span class="citation" data-cites="WickhamH_etal:2023book">Wickham et al. (<a href="#/参考文献-1" role="doc-biblioref" onclick="">2023</a>)</span>, <a href="https://r4ds.hadley.nz/data-tidy.html">Data tidying</a>）</p>
</div><div class="column" style="width:50%;">
<h3 id="雑然messyデータ">雑然（messy）データ</h3>
<ul>
<li>左の定義に合わないデータ
<ul>
<li>例：次のページのような横持ちデータ</li>
</ul></li>
<li>不要な空白行や結合セルからなる表
<ul>
<li><a href="https://www.e-stat.go.jp/stat-search/files?page=1&amp;layout=normal&amp;toukei=00450071&amp;survey=毎月勤労統計調査&amp;result_page=1&amp;metadata=1&amp;data=1">毎月勤労統計調査</a></li>
</ul></li>
</ul>
</div></div>
</section>
<section id="基礎整然データと雑然データ-1" class="slide level2">
<h2>基礎：整然データと雑然データ</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="整然とした縦持ちデータ">整然とした縦持ちデータ</h3>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">地域</th>
<th style="text-align: left;">曜日</th>
<th style="text-align: left;">天気</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">東京</td>
<td style="text-align: left;">月曜</td>
<td style="text-align: left;">晴れ</td>
</tr>
<tr class="even">
<td style="text-align: left;">東京</td>
<td style="text-align: left;">火曜</td>
<td style="text-align: left;">曇り</td>
</tr>
<tr class="odd">
<td style="text-align: left;">東京</td>
<td style="text-align: left;">水曜</td>
<td style="text-align: left;">雨</td>
</tr>
<tr class="even">
<td style="text-align: left;">大阪</td>
<td style="text-align: left;">月曜</td>
<td style="text-align: left;">曇り</td>
</tr>
<tr class="odd">
<td style="text-align: left;">大阪</td>
<td style="text-align: left;">火曜</td>
<td style="text-align: left;">晴れ</td>
</tr>
<tr class="even">
<td style="text-align: left;">大阪</td>
<td style="text-align: left;">水曜</td>
<td style="text-align: left;">晴れ</td>
</tr>
</tbody>
</table>
<p>「地域」「曜日」「天気」がそれぞれ1つの変数として1列にまとまっており、<em>1行が1つの観測</em>になっている（tidyのルールを満たす）</p>
</div><div class="column" style="width:50%;">
<h3 id="雑然とした横持ちデータ">雑然とした横持ちデータ</h3>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">地域</th>
<th style="text-align: left;">月曜</th>
<th style="text-align: left;">火曜</th>
<th style="text-align: left;">水曜</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">東京</td>
<td style="text-align: left;">晴れ</td>
<td style="text-align: left;">曇り</td>
<td style="text-align: left;">雨</td>
</tr>
<tr class="even">
<td style="text-align: left;">大阪</td>
<td style="text-align: left;">曇り</td>
<td style="text-align: left;">晴れ</td>
<td style="text-align: left;">晴れ</td>
</tr>
</tbody>
</table>
<p>人間には見慣れた表（行と列の交差点（セル）に意味があることを直感的に認識できるから）だが、<em>曜日が複数列に分かれている</em>ため「1列＝1変数」というtidyのルールに合わない。値が晴れ、曇りなどの天気である以上、カラム名（変数）は天気であるべき。このようなデータフレームでは、集計、プロットすることが難しい</p>
</div></div>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p><em>カラム名は列に含まれる値全体を説明する</em>ものであるべき（カテゴリカルな名詞）</p>
</div>
</div>
</div>
</section>
<section id="基礎整然データと雑然データ-2" class="slide level2">
<h2>基礎：整然データと雑然データ</h2>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>コンピュータが理解できるデータ形式は、<em>1行目がカラム名、2行目以降が値</em>になっているものです
<ul>
<li>Rでは、この「カラム（列）」の中身を<em>ベクトル（値の並び）</em>として扱います</li>
</ul></li>
<li>Rなどのプログラム系の統計ソフトでは、<em>操作や分析の対象を「カラム名」で指定</em>します。この「カラム」は、統計学の文脈では「<em>変数</em>」と呼ばれます
<ul>
<li>人間には判読できることがコンピュータにはできません</li>
<li>例えば一つのデータに同じカラム名があると動かない、もしくは強制的にカラム名が変更（メモリ上。元ファイルはそのまま）されます</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="r環境の整備" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅲ. R環境の整備</h1>

</section>
<section id="準備r-studioとquartoファイル" class="slide level2">
<h2>準備：R StudioとQuartoファイル</h2>
<h3 id="r-studio">R Studio</h3>
<ul>
<li>Rを効率的に使うための統合開発環境（IDE）
<ul>
<li>「コードを書く・実行する・結果を見る」ための道具</li>
<li>Cf. R 本体:「計算・統計処理」を行う（R Studioを起動すれば、内部でRが自動的に動く）</li>
<li><a href="https://posit.co">posit</a>社のアプリ（今日のR開発を牽引）</li>
<li>Pythonとの共存を目指す<a href="https://positron.posit.co">Positron</a>（Microsoft VS Codeに類似したインターフェイス）の開発が進行中</li>
</ul></li>
</ul>
</section>
<section id="準備r-studioとquartoファイル-1" class="slide level2">
<h2>準備：R StudioとQuartoファイル</h2>
<h3 id="quartoファイル">Quartoファイル</h3>
<ul>
<li><a href="https://quarto.org">Quarto</a> / 拡張子qmd</li>
<li>コード（R Chunk）と文章（Markdown）をひとつのファイルにまとめて書き、実行結果つきのレポートやスライドを自動で作成できる
<ul>
<li>YAMLのformatを書き換えるだけで多様な出力が可能
<ul>
<li>HTML, PDF, Reveal.js, docx, pptx など</li>
</ul></li>
<li>R Markdown（拡張子Rmd）の拡張版</li>
<li><a href="https://posit.co">posit</a>社が開発したファイル形式</li>
</ul></li>
</ul>
</section>
<section id="準備インストール" class="slide level2">
<h2>準備：インストール</h2>
<ul>
<li>13のステップに分けて説明します</li>
</ul>
<h3 id="r本体をインストール">1. R本体をインストール</h3>
<ul>
<li>ブラウザから<a href="https://cran.rstudio.com">R</a>にアクセス</li>
<li>手持ちのPCに適したファイルをダウンロードして、実行
<ul>
<li>Windows / macOS / Linux</li>
</ul></li>
</ul>
<h3 id="r-studioをインストール">2. R Studioをインストール</h3>
<ul>
<li>ブラウザから<a href="https://posit.co/download/rstudio-desktop/">R Studio</a>にアクセス</li>
<li>手持ちのPCに適したファイルをダウンロード、実行
<ul>
<li>Windows / macOS / Ubuntu</li>
</ul></li>
</ul>
</section>
<section id="準備ファイルの作成" class="slide level2">
<h2>準備：ファイルの作成</h2>
<h3 id="この講習会用のフォルダ作成osで操作">3. この講習会用のフォルダ作成（OSで操作）</h3>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>ファイル名は<em>念のため英数のみ</em>とし、また<em>空白文字を使わない</em>で下さい</p>
</div>
</div>
</div>
<h3 id="プロジェクトの作成r-studioで操作以後同じ">4. プロジェクトの作成（R Studioで操作、以後同じ）</h3>
<ul>
<li>メニュー &gt; File &gt; New Project &gt; Existing Directory &gt; 3で作成した フォルダを指定 &gt; Create Project</li>
</ul>
<h4 id="rprojファイル">Rprojファイル</h4>
<ul>
<li>Rprojファイルは、RStudioプロジェクトを管理するための設定ファイルで、作業ディレクトリや環境設定、ファイルの表示状態などを保存する</li>
<li>プロジェクトを開くと、自動でそのフォルダが作業ディレクトリになり、パスの管理や依存関係の整理が簡単になる</li>
</ul>
</section>
<section id="準備ファイルの作成-1" class="slide level2">
<h2>準備：ファイルの作成</h2>
<h3 id="r-quartoファイルの作成">5. R Quartoファイルの作成</h3>
<ul>
<li>メニュー &gt; File &gt; Quarto Document &gt; Create
<ul>
<li>Title: 任意</li>
<li>HTML / PDF / Word → HTMLにチェック</li>
<li>「Editor: Use visual markdown editor」のチェックを外す（外れていることを確認する）</li>
</ul></li>
<li>名前をつけて保存</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>ファイル名は<em>念のため英数のみ</em>とし、また<em>空白文字を使わない</em>で下さい</p>
</div>
</div>
</div>
</section>
<section id="準備うまくいかない場合" class="slide level2">
<h2>準備：うまくいかない場合</h2>
<ul>
<li>Consoleパネルに表示されるメッセージが英語の場合：
<ul>
<li>エラーメッセージの日本語化（ターミナル操作が必要）</li>
<li><a href="https://maku77.github.io/r/basic/locale.html">Mac: R 環境の Locale 設定（日本語を使用する）</a></li>
<li><a href="https://niszet.hatenablog.com/entry/2022/04/25/083000">Win: (R) R4.2でWindowsでもUTF-8を設定できることを確認した</a></li>
</ul></li>
<li>インストールがうまくいかない場合：
<ul>
<li><a href="https://okumuralab.org/~okumura/stat/R-win.html">WindowsでのR/RStudioのインストール</a></li>
<li><a href="http://nineworks2.blog.fc2.com/blog-entry-123.html">RStudioで日本語ユーザー名だとパッケージがインストールできない問題の解決方法</a></li>
</ul></li>
</ul>
</section>
<section id="準備r-studioペインの見方" class="slide level2">
<h2>準備：R Studio（ペイン）の見方</h2>
<ul>
<li>4画面構成
<ul>
<li>主要な操作は左上のソースペインで行う</li>
</ul></li>
</ul>

<img data-src="img/pane.png" class="r-stretch"></section>
<section id="準備r-studioソースペインの外観の変更" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>
<ul>
<li>コードを書くうえで、<em>視認性はとても重要</em>です</li>
</ul>
<h3 id="文字の配色の変更">6. 文字の配色の変更</h3>
<ul>
<li>メニュー &gt; Tools &gt; Global Options &gt; Appearance &gt; Editor Theme
<ul>
<li>私（苅谷）は<a href="https://github.com/max-alletsee/rstudio-themes">rstudio-themes</a>からダウンロードしたrscodeio (anthonynorth) をaddで追加しています</li>
</ul></li>
</ul>
<h3 id="不可視文字を表示">7. 不可視文字を表示</h3>
<ul>
<li>メニュー &gt; Tools &gt; Global Options &gt; Code &gt; Display &gt; Show whitespace charactersにチェック / Indentation guides:から適当なものを選択
<ul>
<li>themeによってはIndentation guidesが適用されない（rscodeioも適用対象外）</li>
</ul></li>
</ul>
</section>
<section id="準備r-studioソースペインの外観の変更-1" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>

<img data-src="img/theme.png" class="r-stretch"></section>
<section id="準備r-studioソースペインの外観の変更-2" class="slide level2">
<h2>準備：R Studio（ソースペイン）の外観の変更</h2>

<img data-src="img/空白の可視化.png" class="r-stretch"></section>
<section id="準備r-studioの保存復元設定" class="slide level2">
<h2>準備：R Studioの保存・復元設定</h2>
<ul>
<li>意図しない古いデータが使われることを避ける必要があります</li>
</ul>
<h3 id="rdata保存をオフにする">8. 「.RData」保存をオフにする</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>メニュー &gt; Tools &gt; Global Options &gt; General &gt; Workspace
<ul>
<li>Restore .RData into workspace at startup: <em>チェックを外す</em></li>
<li>Save workspace to .RData on exit: <em>Neverを選択</em></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/restore.png"></p>
</div></div>
</section>
<section id="準備r-studioの保存復元設定-1" class="slide level2">
<h2>準備：R Studioの保存・復元設定</h2>
<ul>
<li>「.RData」には、前回の作業中のすべてのオブジェクト（データフレーム・関数・変数など）が保存される
<ul>
<li>再起動時にそれを読み込むと、前回の環境がそのまま復活する。一見便利そうだが、トラブルの元になる
<ul>
<li>以前のオブジェクトが残っていて、意図せず「古い値」が使われる（結果を再現できない）</li>
<li>どこで作られたデータかわからなくなる</li>
<li>コードを一から実行しても、同じ結果にならない</li>
</ul></li>
<li>「.RData」は作業データすべてを保存するため、大規模データを扱うと数百MB〜数GBにもなることがある</li>
</ul></li>
</ul>
</section>
<section id="準備目次の追加yaml" class="slide level2">
<h2>準備：目次の追加（YAML）</h2>
<h3 id="yamlを改変して目次を表示させる">9. YAMLを改変して､目次を表示させる</h3>
<ul>
<li>ソースペインの冒頭部分（YAML）を以下の様にする（タイトルは任意）</li>
</ul>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>目次を付けると見出しレベルを意識しやすくなり､論理的に整ったレポートを作成できます</p>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>title<span class="sc">:</span> <span class="st">"任意"</span></span>
<span id="cb1-2"><a></a>format<span class="sc">:</span></span>
<span id="cb1-3"><a></a>  html<span class="sc">:</span></span>
<span id="cb1-4"><a></a>   toc<span class="sc">:</span> true</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:70%;">
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>YAMLは構文が厳格で、エラーが起きやすいです</li>
<li>YAML領域では、特に半角と全角の違いに注意し、インデントや記号（: ハイフンなど）は<em>全て半角</em>で入力する</li>
<li>「toc:」と「true」の間に<em>半角空きあり</em></li>
<li>YAML領域は「—」で始まり「—」で終わります。<em>「—」を消さないこと</em></li>
</ul>
</div>
</div>
</div>
</div></div>
<ul>
<li>YAMLを入力（またはコピー）できたら、「Outline」をクリック</li>
</ul>
</section>
<section id="準備目次の追加yaml-1" class="slide level2">
<h2>準備：目次の追加（YAML）</h2>
<ul>
<li>Renderをクリック
<ul>
<li>YAMLで設定している出力形式に従って右下のペイン（Viewer/Presentation）にレポートが出力される（全てのR Chunkが実行される（後述））</li>
</ul></li>
</ul>

<img data-src="img/toc.png" class="r-stretch"></section>
<section id="準備パッケージの追加tidyverse" class="slide level2">
<h2>準備：パッケージの追加（tidyverse）</h2>
<ul>
<li><p>modern Rは、tidyverse（整然としたデータ世界）という思想にもとづくパッケージ群からなる</p></li>
<li><p>base Rには組み込まれていないので、パッケージとして追加することが必要</p></li>
<li><p>tidyverseの中身</p>
<ul>
<li>dplyr（データ操作）</li>
<li>tidyr（データ整形）</li>
<li>ggplot2（可視化）</li>
<li>readr（データ読み込み）</li>
<li>purrr（関数型操作）</li>
<li>tibble（データフレーム拡張）</li>
</ul></li>
</ul>
</section>
<section id="準備パッケージの追加tidyverse-1" class="slide level2">
<h2>準備：パッケージの追加（tidyverse）</h2>
<h3 id="パッケージの追加">10. パッケージの追加</h3>
<ul>
<li>Consoleパネル（画面左下）にカーソルを合わせる</li>
<li>以下のコードを入力（または「クリップボード」でコピー）して実行（Enter）</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>インストール後、自動でパッケージを使えるわけではありません。各Quartoファイル内において、使いたいパッケージを<em>library() 関数で読み込む</em>必要があります（後述）</p>
</div>
</div>
</div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>パッケージは、一度インストールすれば、同じPCではもう一度、インストールする必要はありません（パッケージはR内部から利用する設計になっており、初心者がファイルを探す、触る必要はありません）</p>
</div>
</div>
</div>
</section>
<section id="準備setup-chunkの作成" class="slide level2">
<h2>準備：Setup Chunkの作成</h2>
<h3 id="r-chunk">R Chunk</h3>
<ul>
<li>R Chunkは、Quartoファイルの中でRのコードを書くためのブロック</li>
<li>一つのR Chunkで、一つの作図、分析を行うのが基本</li>
</ul>
<h3 id="setup-chunk">Setup Chunk</h3>
<ul>
<li>R Chunkの一種だが、文書全体の設定を行うために慣例的に使われる特別なコードブロック
<ul>
<li>パッケージ・読み込み / 前処理（縦持ちデータへの変換など）</li>
</ul></li>
<li>Quartoは「ドキュメント内の最初にあるコードチャンク」を<em>自動的にグローバルな設定チャンクとして実行する</em>（ラベルは便宜的なもの）</li>
</ul>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Setup Chunkを整え、前処理に関わるコードをまとめておくと、後の分析がスムーズになります</p>
</div>
</div>
</div>
</section>
<section id="準備setup-chunkの作成-1" class="slide level2">
<h2>準備：Setup Chunkの作成</h2>
<h3 id="setup-chunkの作成">11. Setup Chunkの作成</h3>
<ul>
<li>ソースペインで、YAMLの下に、Setup Chunkを作成
<ul>
<li>メニュー &gt; Code &gt; Insert Chunk &gt; 以下のコードを入力（貼り付けでよい）</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co">#| label: setup</span></span>
<span id="cb3-2"><a></a><span class="co">#| echo: false</span></span>
<span id="cb3-3"><a></a><span class="co">#| output: false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>label: setup: このチャンクをセットアップチャンクと名付ける</li>
<li>echo: false: このチャンクのコードは表示しない</li>
<li>output: false：コードを実行しても、結果は出力に表示しない</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>コードブロックは「てんてんてん（バッククォート）」3つで始まり、同じく「てんてんてん」3つで終わるのが規則です。この中にRのコードを書きます。<em>間違って消さないように！</em></p>
</div>
</div>
</div>
</section>
<section id="準備パッケージの読み込み" class="slide level2">
<h2>準備：パッケージの読み込み</h2>
<ul>
<li>先に作成したSetup Chunkで、modern Rの基本パッケージ群tidyverseを読み込む</li>
</ul>
<h3 id="パッケージの読み込み">12. パッケージの読み込み</h3>
<p>ソースペインで、Setup Chunk内に以下のコードを書く</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="co"># パッケージの読み込み ---- #「○○ ----」と書いておくと、Outlineに表示されて見やすい（R Studioが区切り線として認識）</span></span>
<span id="cb4-2"><a></a><span class="fu">library</span>(tidyverse) <span class="co"># modern Rの基本パッケージ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>R Chunk内では #（ハッシュ）をコードの前につけると、その行は実行されずにメモとして残せます</li>
<li>＃ より右側の文字もRでは実行されません（コメントアウトと呼びます）</li>
<li>特定のコード（行）が動かないなどの理由で、問題を特定したい場合にも便利です</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>可読性、判読性、視認性を上げ、<a href="https://ja.wikipedia.org/wiki/スパゲティプログラム">スパゲティコード</a>にならないようにすることが重要です</p>
</div>
</div>
</div>
</section>
<section id="準備日本語表示ggplot2" class="slide level2">
<h2>準備：日本語表示（ggplot2）</h2>
<div class="callout callout-important callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>ggplot2（作図パッケージ）の諸関数は、初期設定のままでは、日本語を正しく表示できない場合があります
<ul>
<li>特に、WindowsやmacOSでは、デフォルトのフォント設定に日本語フォントが含まれていないため、文字化けや「□」「?」のような記号に置き換えられることがあります</li>
<li>Linux環境では日本語フォントが標準でインストールされ、日本語がそのまま表示できることが多いです</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="ggplot-japanese-mac" class="slide level2">
<h2>準備：日本語表示（ggplot2: Mac）</h2>
<h3 id="日本語表示に対応する">13. 日本語表示に対応する</h3>
<ul>
<li>ggplot()の諸関数で日本語を出力するために、YAMLに以下のコードを書く（動作は後ほど確認します）</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># 描画設定 -----</span></span>
<span id="cb5-2"><a></a><span class="co"># フォントファミリとサイズ</span></span>
<span id="cb5-3"><a></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb5-4"><a></a>  ggplot2<span class="sc">::</span><span class="fu">theme_get</span>() <span class="sc">+</span></span>
<span id="cb5-5"><a></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb5-6"><a></a>)</span>
<span id="cb5-7"><a></a></span>
<span id="cb5-8"><a></a><span class="do">## text/labelのフォントファミリとサイズ</span></span>
<span id="cb5-9"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb5-10"><a></a>  <span class="st">"text"</span>,</span>
<span id="cb5-11"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb5-12"><a></a>)</span>
<span id="cb5-13"><a></a></span>
<span id="cb5-14"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb5-15"><a></a>  <span class="st">"label"</span>,</span>
<span id="cb5-16"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"HiraginoSans-W3"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb5-17"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ggplot-japanese-win" class="slide level2">
<h2>準備：日本語表示（ggplot2: Windows）</h2>
<h3 id="日本語表示に対応する-1">13. 日本語表示に対応する</h3>
<ul>
<li>ggplot()の諸関数で日本語を出力するために、YAMLに以下のコードを書く（動作は後ほど確認します）</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># 描画設定 -----</span></span>
<span id="cb6-2"><a></a><span class="co"># フォントファミリとサイズ</span></span>
<span id="cb6-3"><a></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(</span>
<span id="cb6-4"><a></a>  ggplot2<span class="sc">::</span><span class="fu">theme_get</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">8</span>))</span>
<span id="cb6-6"><a></a>)</span>
<span id="cb6-7"><a></a></span>
<span id="cb6-8"><a></a><span class="do">## text/labelのフォントファミリとサイズ</span></span>
<span id="cb6-9"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb6-10"><a></a>  <span class="st">"text"</span>,</span>
<span id="cb6-11"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb6-12"><a></a>)</span>
<span id="cb6-13"><a></a></span>
<span id="cb6-14"><a></a>ggplot2<span class="sc">::</span><span class="fu">update_geom_defaults</span>(</span>
<span id="cb6-15"><a></a>  <span class="st">"label"</span>,</span>
<span id="cb6-16"><a></a>  <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Meiryo"</span>, <span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb6-17"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="準備quartoファイル" class="slide level2">
<h2>準備：Quartoファイル</h2>
<h3 id="quartoファイルの構成パターン">Quartoファイルの構成パターン</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    A["YAML領域"]:::yaml
    B["R Setup Chunk（セットアップ領域）"]:::setup
    C["R Chunk領域"]:::chunk
    D["Markdown領域"]:::md

    A --&gt; B
    B --&gt; C
    B --&gt; D

    classDef yaml fill:#FFF7D6,stroke:#E3B505,color:#333,font-weight:bold;
    classDef setup fill:#FFF0F5,stroke:#D96BA8,color:#333,font-weight:bold;
    classDef chunk fill:#E7F5FF,stroke:#4A90E2,color:#333,font-weight:bold;
    classDef md fill:#E8F6E0,stroke:#7CB518,color:#333,font-weight:bold;

</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>ハッシュタグの解釈がR ChunkとMarkdownで異なる</strong></p>
</div>
<div class="callout-content">
<ul>
<li>R Chunk: コメントアウト</li>
<li>Markdown: 見出しレベル</li>
</ul>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>YAML
<ul>
<li>ファイル全体の設定や出力形式の指定する領域</li>
</ul></li>
<li>R Chunk
<ul>
<li>Rコードを実行して、分析や図表を作成する領域</li>
</ul></li>
<li>Markdown
<ul>
<li>見出しや本文、解説文などを記述する領域</li>
<li><em>コードで囲っていない部分は、すべてマークダウン領域</em>となる</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="準備quartoファイル-1" class="slide level2">
<h2>準備：Quartoファイル</h2>

<img data-src="img/画面構成.png" class="r-stretch"></section></section>
<section>
<section id="基本編rにふれてみようpalmer-penguins" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅳ. 《基本編》Rにふれてみよう：palmer penguins</h1>

</section>
<section id="基本データセット" class="slide level2">
<h2>基本：データセット</h2>
<h3 id="データセットpalmer-penguins">データセット：palmer penguins</h3>
<ul>
<li><a href="https://allisonhorst.com">palmer penguins</a>は、R本体に組み込まれている練習用のデータセット（R4.5以降）
<ul>
<li>これは、パッケージを追加したり、データを読み込む必要がないことを意味する</li>
<li>従来のデータセット（irisなど）とは違い、カラム名、欠損値（na）などの点で、教育的配慮のあるデータセットとされる</li>
</ul></li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>以前は、<a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a>という個別パッケージを読み込み、使用する必要がありました。パッケージで提供されるデータセットと、base Rのそれで、カラム名が一部、異なっています。インターネットで検索すると、パッケージのカラム名のコードが現状では多いので、気をつけて下さい</p>
</div>
</div>
</div>
</section>
<section id="基本データセット-1" class="slide level2">
<h2>基本：データセット</h2>
<ul>
<li>パーマーランド（南極）の3つの島に住むペンギンたちのデータ（<a href="https://allisonhorst.github.io/cv.html">Allison Horst</a>さん作成）</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="ペンギンの種類">ペンギンの種類：</h3>
<ul>
<li>Adelie（アデリーペンギン）</li>
<li>Gentoo（ジェンツーペンギン）</li>
<li>Chinstrap（ヒゲペンギン）</li>
</ul>
<h3 id="島の名前">島の名前：</h3>
<ul>
<li>Biscoe（ビスコー）</li>
<li>Dream（ドリーム）</li>
<li>Torgersen（トージャーセン）</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/penguins-small.png"></p>
</div></div>
</section>
<section id="基本簡単な関数" class="slide level2">
<h2>基本：簡単な関数</h2>
<h3 id="データを確認する">データを確認する</h3>
<ul>
<li>関数を使ってみよう。以下のコードを入力（<em>自動補完</em>機能を確認下さい）</li>
</ul>
<h4 id="view関数">view()関数</h4>
<ul>
<li>データを表にして見やすく開く関数。データ全体をチェックしたり、列名や値、また集計途中のデータをざっと確認するときに便利</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a></a>  <span class="fu">view</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h4 id="head関数">head()関数</h4>
<ul>
<li>データフレームやベクトルの先頭の数行（デフォルトは6行）だけを表示</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本データの型" class="slide level2">
<h2>基本：データの型</h2>
<h3 id="データの型">データの型</h3>

<img data-src="img/データの型.png" class="r-stretch"></section>
<section id="基本データフレームの型" class="slide level2">
<h2>基本：データフレームの型</h2>
<h3 id="データフレームの型">データフレームの型</h3>

<img data-src="img/データフレームの型.png" class="r-stretch"><ul>
<li><em>tibble（ティブル）</em>はtidyverseで使われるデータフレームの新しい形式
<ul>
<li>base Rのデータフレームであるdata.frameを、より見やすく、扱いやすく改良したもの</li>
<li>dplyrやggplot2などの関数と相性がよい</li>
<li>tibbleは列にlistを入れられるので、グループごとのデータをまとめて操作する「ネスト処理」と相性がよい</li>
<li>文字列を自動的にfactorにしない、出力が見やすい（先頭だけを整形して表示）間などの特徴もある</li>
</ul></li>
</ul>
</section>
<section id="基本実行と出力" class="slide level2">
<h2>基本：実行と出力</h2>
<h3 id="実行runと出力レンダーrender">実行（run）と出力（レンダー、render）</h3>
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="runrの実行">run：rの実行</h4>
<ul>
<li>図や表の出力に関数する関数がある場合、Chunkの下に描画される
<ul>
<li>個々のChunkを実行する場合は、Chunk右端の▶️をクリック</li>
<li>全てのコードを実行する場合は、Run &gt; Run All</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<h4 id="render出力描画">render：出力（描画）</h4>
<ul>
<li>すべてのコードを実行し、YAMLのformatで設定した形式のファイルが出力される（出力先：Quartoファイルと同じフォルダ）</li>
<li>出力はViewer画面でも確認できる（show new windowでブラウザで確認できる）
<ul>
<li>自動的にブラウザが開く場合もある</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="基本パイプ処理" class="slide level2">
<h2>基本：パイプ処理</h2>
<h3 id="パイプ処理">パイプ処理</h3>
<ul>
<li><em>|&gt;</em> または <em>%&gt;%</em></li>
<li>modern Rの大きな特徴の一つ<sup>1</sup></li>
<li>処理を連続させるための記号（正確には、演算子という）
<ul>
<li>より正確には「前の結果を次の関数に渡して、処理を順番につなげるための記号」</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a>データ <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a></a>  処理<span class="fu">A</span>() <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a></a>  処理<span class="fu">B</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>料理で喩えると：「材料を選んで → 炒めて → 味付けする」</li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn3"><p>R 4.1.0（2021年5月）で、R本体に組み込まれ、ネイティブ構文に</p></li></ol></aside></section>
<section id="基本パイプ処理-1" class="slide level2">
<h2>基本：パイプ処理</h2>
<ul>
<li>パイプ演算子は頻繁に使います。ショートカットを覚えましょう</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>パイプのショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Win: Ctrl + Shift + M</li>
<li>Mac: Command + Shift + M</li>
</ul>
</div>
</div>
</div>
<ul>
<li>R Studioの設定（Tools &gt; Grobal Options &gt; Code &gt; Editing &gt; Use native pipe operator）で、<em>|&gt;</em> と <em>%&gt;%</em> のどちらを挿入するかを選択できる
<ul>
<li>デフォルトは<em>|&gt;</em></li>
</ul></li>
</ul>
</section>
<section id="基本パイプ処理-2" class="slide level2">
<h2>基本：パイプ処理</h2>
<h3 id="パイプを使った書き方modern-r-tidyverse">パイプを使った書き方（modern R = tidyverse）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a>penguins <span class="sc">|&gt;</span> <span class="co"># ペンギンというデータ（正確には「オブジェクト」と表現します）を使って</span></span>
<span id="cb10-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> <span class="co"># 種類ごとにグループを分けて</span></span>
<span id="cb10-3"><a></a>  <span class="fu">summarize</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># 平均の体重を計算する（na.rm = TRUEは、欠損値を除外する指示）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>オブジェクトをどう処理したいのかが書きやすい（読みやすい）</li>
</ul>
<h3 id="パイプを使わない書き方base-r">パイプを使わない書き方（base R）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">summarize</span>(</span>
<span id="cb11-2"><a></a>  <span class="fu">group_by</span>(penguins, species),</span>
<span id="cb11-3"><a></a>  <span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-4"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>関数が入れ子構造（ネスト）になり、どこからどこまでが特定の関数なのかわかりにくい</li>
<li>処理の順番がわかりにくく、かっこの対応関係も見づらい
<ul>
<li>入れ子人形（マトリョーシカ）（<a href="https://www.jumpingrivers.com/blog/refactoring-russian-doll-code/">Refactoring Russian Doll Code</a>）</li>
</ul></li>
</ul>
</section>
<section id="基本パイプ処理-3" class="slide level2">
<h2>基本：パイプ処理</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h3 id="パイプありmodern-r-tidyverse">パイプあり（modern R = tidyverse）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<h3 id="パイプなしbase-r">パイプなし（base R）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="fu">head</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
<ul>
<li>どちらも同じ処理</li>
<li>処理を連続させないのであれば、右のコードでよい</li>
<li>base Rでは、関数のかっこの中に第1引数（後述）として、処理・操作したいデータを書くが、パイプを使うと、そのデータを関数の外（左側・コードの最初）に置くことができる
<ul>
<li><em>可読性の高いコード</em>になる</li>
</ul></li>
</ul>
</section>
<section id="基本パッケージのインストール" class="slide level2">
<h2>基本：パッケージのインストール</h2>
<h3 id="パッケージの一括インストール">パッケージの一括インストール</h3>
<ul>
<li><p>パッケージは各自の必要に応じてインストールすべきですが、時間の都合上、以下のスライドで使用するコードを一括でインストールしましょう。上からpatchworkまでのパッケージは、今日、標準的なものです</p></li>
<li><p>任意のR Chunkで操作（このR Chunkはインストール後に削除して下さい）</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="co"># インストールするパッケージをまとめて指定</span></span>
<span id="cb14-2"><a></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-3"><a></a>  <span class="st">"readxl"</span>,     <span class="co"># Excelファイルの読み込み</span></span>
<span id="cb14-4"><a></a>  <span class="st">"conflicted"</span>, <span class="co"># 複数のパッケージで同じ関数名があるとき、使う方を選べるようにする</span></span>
<span id="cb14-5"><a></a>  <span class="st">"stringi"</span>,    <span class="co"># 文字列操作</span></span>
<span id="cb14-6"><a></a>  <span class="st">"glue"</span>,       <span class="co"># 文字列の埋め込み</span></span>
<span id="cb14-7"><a></a>  <span class="st">"gt"</span>,         <span class="co"># 表作成</span></span>
<span id="cb14-8"><a></a>  <span class="st">"skimr"</span>,      <span class="co"># データ要約</span></span>
<span id="cb14-9"><a></a>  <span class="st">"scales"</span>,     <span class="co"># 軸やラベルのスケール調整</span></span>
<span id="cb14-10"><a></a>  <span class="st">"patchwork"</span>,  <span class="co"># 複数のggplotの出力結果を並べる</span></span>
<span id="cb14-11"><a></a><span class="do">## 以下のパッケージは標準的ではないが、本日の講習会で使っているものです</span></span>
<span id="cb14-12"><a></a>  <span class="st">"crosstable"</span>, <span class="co"># クロス表</span></span>
<span id="cb14-13"><a></a>  <span class="st">"zipangu"</span>,    <span class="co"># 日本固有の表記（和暦、都道府県名、住所など）を処理</span></span>
<span id="cb14-14"><a></a>  <span class="st">"rvest"</span>,      <span class="co"># Webスクレイピング</span></span>
<span id="cb14-15"><a></a>  <span class="st">"httr2"</span>,      <span class="co"># HTTPリクエスト</span></span>
<span id="cb14-16"><a></a>  <span class="st">"xml2"</span>,       <span class="co"># XML解析</span></span>
<span id="cb14-17"><a></a>  <span class="st">"maps"</span>,       <span class="co"># アメリカの地図情報（地理データ）</span></span>
<span id="cb14-18"><a></a>  <span class="st">"socviz"</span>,     <span class="co"># 政治・社会・教育に関連するデータセットが中心（初学者の演習や可視化の教材として便利）</span></span>
<span id="cb14-19"><a></a>  <span class="st">"paletteer"</span>,  <span class="co"># カラーパレット</span></span>
<span id="cb14-20"><a></a>  <span class="st">"ngramr"</span>,     <span class="co"># Google Ngram Trends</span></span>
<span id="cb14-21"><a></a>  <span class="st">"sjPlot"</span>      <span class="co"># 社会科学系の分析総合パッケージ</span></span>
<span id="cb14-22"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本パッケージのインストール-1" class="slide level2">
<h2>基本：パッケージのインストール</h2>
<h3 id="パッケージの一括インストール-1">パッケージの一括インストール</h3>
<ul>
<li>以下のコードをコンソールに入力して実行
<ul>
<li>先に入力したパッケージ群（「packages」と名付けました）を一括でインストールできます</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co"># 一括インストール</span></span>
<span id="cb15-2"><a></a><span class="fu">install.packages</span>(packages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本パッケージのインストール-2" class="slide level2">
<h2>基本：パッケージのインストール</h2>
<h3 id="パッケージの一括インストール読み込み">パッケージの一括インストール（読み込み）</h3>
<ul>
<li>パッケージはQuartoファイルごとに読み込みが必要です</li>
<li>以下のコードをSetup Chunk（library(tidyverse)）の下に入力して実行（Run）</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="co"># パッケージの読み込み</span></span>
<span id="cb16-2"><a></a><span class="fu">library</span>(readxl)    <span class="co"># Excelファイルの読み込み</span></span>
<span id="cb16-3"><a></a><span class="fu">library</span>(conflicted)<span class="co"># 名前空間の衝突を防ぐ</span></span>
<span id="cb16-4"><a></a><span class="fu">library</span>(rubridate) <span class="co">#日付処理</span></span>
<span id="cb16-5"><a></a><span class="fu">library</span>(stringi)   <span class="co"># 文字列操作</span></span>
<span id="cb16-6"><a></a><span class="fu">library</span>(glue)      <span class="co"># 文字列の埋め込み</span></span>
<span id="cb16-7"><a></a><span class="fu">library</span>(gt)        <span class="co"># 表作成</span></span>
<span id="cb16-8"><a></a><span class="fu">library</span>(skimr)     <span class="co"># データ要約</span></span>
<span id="cb16-9"><a></a><span class="fu">library</span>(scales)    <span class="co"># 軸やラベルのスケール調整</span></span>
<span id="cb16-10"><a></a><span class="fu">library</span>(patchwork) <span class="co"># 複数のggplotの出力結果を並べる</span></span>
<span id="cb16-11"><a></a><span class="fu">library</span>(crosstable)<span class="co"># クロス表</span></span>
<span id="cb16-12"><a></a><span class="fu">library</span>(zipangu)   <span class="co"># 日本固有の表記（和暦、都道府県名、住所など）を処理</span></span>
<span id="cb16-13"><a></a><span class="fu">library</span>(rvest)     <span class="co"># Webスクレイピング</span></span>
<span id="cb16-14"><a></a><span class="fu">library</span>(httr2)     <span class="co"># HTTPリクエスト</span></span>
<span id="cb16-15"><a></a><span class="fu">library</span>(xml2)      <span class="co"># XML解析</span></span>
<span id="cb16-16"><a></a><span class="fu">library</span>(maps)      <span class="co"># アメリカの地図情報</span></span>
<span id="cb16-17"><a></a><span class="fu">library</span>(socviz)    <span class="co"># 社会・政治・教育関連データセット</span></span>
<span id="cb16-18"><a></a><span class="fu">library</span>(paletteer) <span class="co"># カラーパレット</span></span>
<span id="cb16-19"><a></a><span class="fu">library</span>(ngramr)    <span class="co"># Google Ngram Trends</span></span>
<span id="cb16-20"><a></a><span class="fu">library</span>(sjPlot)    <span class="co"># 社会科学系の分析総合パッケージ</span></span>
<span id="cb16-21"><a></a></span>
<span id="cb16-22"><a></a><span class="co"># 優先する関数を指定 ----</span></span>
<span id="cb16-23"><a></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter) <span class="co"># filter関数はdplyrを優先</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本ショートカット" class="slide level2">
<h2>基本：ショートカット</h2>
<h3 id="ショートカット">ショートカット</h3>
<ul>
<li>R Chunkは頻繁に作成します。ショートカットを覚えましょう</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>R Chunkのショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Win: Ctrl + Alt + I<br>
</li>
<li>Mac: Command + option + I</li>
</ul>
</div>
</div>
</div>
<ul>
<li>インデントを揃える癖をつけましょう</li>
</ul>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>インデントの調整のショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Win: Ctrl + I</li>
<li>Mac: Command + I</li>
</ul>
</div>
</div>
</div>
</section>
<section id="基本データの型-1" class="slide level2">
<h2>基本：データの型</h2>
<h3 id="データ-データフレームの型">データ / データフレームの型</h3>
<ul>
<li>すべてのオブジェクトは型（クラス）をもつ
<ul>
<li>R（tidyverse）がデータを読み､適切と思われる型を割り当てる</li>
</ul></li>
<li>重要な型
<ul>
<li>numeric（数字）</li>
<li>character（文字）</li>
<li><em>factor（ファクター（因子）：レベルを設定できる）</em></li>
<li>logical（true / false）</li>
<li>data.frame（base Rのテーブル形式）</li>
<li>tibble（tidyverseのテーブル形式）</li>
</ul></li>
</ul>
</section>
<section id="基本データの型-2" class="slide level2">
<h2>基本：データの型</h2>
<h3 id="データの型-1">データの型</h3>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>同じ文字でもデータの型が違う可能性がある</strong></p>
</div>
<div class="callout-content">
<ul>
<li>numeric/character/factor</li>
<li>ggplot（作図）で特に問題になります
<ul>
<li>例えば散布図はnumeric（数字）であることが基本なので、数字以外の型の場合、プロットできません</li>
</ul></li>
</ul>
</div>
</div>
</div>
<ul>
<li>型は、str()関数やskim()関数を使って調べると確実です</li>
</ul>
</section>
<section id="基本データの要約" class="slide level2">
<h2>基本：データの要約</h2>
<h3 id="データを要約する">データを要約する</h3>
<ul>
<li>R Chunkを作り、以下のコードを入力しよう</li>
</ul>
<div class="columns">
<div class="column" style="width:80%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> <span class="co"># speciesで分類する </span></span>
<span id="cb17-3"><a></a>  <span class="fu">summarise</span>( <span class="co"># データを要約する（集計の枠組み）</span></span>
<span id="cb17-4"><a></a>    <span class="at">mean =</span> <span class="fu">mean</span>(bill_len, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># 「bill_len」の列の平均を算出（summarise関数のもと具体的に何を計算するかを指定）</span></span>
<span id="cb17-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb17-6"><a></a>  <span class="co"># ここにview関数を入れて、どのようにデータが変わったのか、見てみよう</span></span>
<span id="cb17-7"><a></a>  <span class="fu">gt</span>() <span class="co"># 以上の集計結果を表にする</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:20%;">
<div class="cell">
<div class="cell-output-display">
<div id="kqvcvfgsac" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kqvcvfgsac table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kqvcvfgsac thead, #kqvcvfgsac tbody, #kqvcvfgsac tfoot, #kqvcvfgsac tr, #kqvcvfgsac td, #kqvcvfgsac th {
  border-style: none;
}

#kqvcvfgsac p {
  margin: 0;
  padding: 0;
}

#kqvcvfgsac .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kqvcvfgsac .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kqvcvfgsac .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kqvcvfgsac .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kqvcvfgsac .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kqvcvfgsac .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqvcvfgsac .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kqvcvfgsac .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kqvcvfgsac .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kqvcvfgsac .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kqvcvfgsac .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kqvcvfgsac .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kqvcvfgsac .gt_spanner_row {
  border-bottom-style: hidden;
}

#kqvcvfgsac .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kqvcvfgsac .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kqvcvfgsac .gt_from_md > :first-child {
  margin-top: 0;
}

#kqvcvfgsac .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kqvcvfgsac .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kqvcvfgsac .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kqvcvfgsac .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kqvcvfgsac .gt_row_group_first td {
  border-top-width: 2px;
}

#kqvcvfgsac .gt_row_group_first th {
  border-top-width: 2px;
}

#kqvcvfgsac .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqvcvfgsac .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kqvcvfgsac .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kqvcvfgsac .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqvcvfgsac .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqvcvfgsac .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kqvcvfgsac .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kqvcvfgsac .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kqvcvfgsac .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kqvcvfgsac .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kqvcvfgsac .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqvcvfgsac .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kqvcvfgsac .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kqvcvfgsac .gt_left {
  text-align: left;
}

#kqvcvfgsac .gt_center {
  text-align: center;
}

#kqvcvfgsac .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kqvcvfgsac .gt_font_normal {
  font-weight: normal;
}

#kqvcvfgsac .gt_font_bold {
  font-weight: bold;
}

#kqvcvfgsac .gt_font_italic {
  font-style: italic;
}

#kqvcvfgsac .gt_super {
  font-size: 65%;
}

#kqvcvfgsac .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kqvcvfgsac .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kqvcvfgsac .gt_indent_1 {
  text-indent: 5px;
}

#kqvcvfgsac .gt_indent_2 {
  text-indent: 10px;
}

#kqvcvfgsac .gt_indent_3 {
  text-indent: 15px;
}

#kqvcvfgsac .gt_indent_4 {
  text-indent: 20px;
}

#kqvcvfgsac .gt_indent_5 {
  text-indent: 25px;
}

#kqvcvfgsac .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kqvcvfgsac div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">mean</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="species">Adelie</td>
<td class="gt_row gt_right" headers="mean">38.79139</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="species">Chinstrap</td>
<td class="gt_row gt_right" headers="mean">48.83382</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="species">Gentoo</td>
<td class="gt_row gt_right" headers="mean">47.50488</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div></div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Rは「保守的」に設計されています。na.rm = TRUEは「NAを取り除いて（ <em>r</em>e<em>m</em>ove）して計算する」という意味です。多くの集計関数（mean(), sum(), sd() など）は欠損値があるとエラーを返し、動作を止めます。これは意図しない、欠損を無視した計算を防ぐためです</p>
</div>
</div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>gt()はスライドに表示するために書いています gt()はtidyveseに入っていないパッケージです。tidyverseと同じように、インストールと読み込み（library）が必要です。標準的なパッケージですので、インストールを推奨します</p>
</div>
</div>
</div>
</section>
<section id="基本引数-tidyverse関数の引数の考え方" class="slide level2">
<h2>基本：引数 &gt; tidyverse関数の引数の考え方</h2>
<table class="caption-top">
<colgroup>
<col style="width: 44%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>引数の位置</th>
<th>意味</th>
<th>例</th>
<th>備考</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>第1引数</td>
<td>処理対象のデータ</td>
<td><code>df</code></td>
<td>パイプ（<code>|&gt;</code> や <code>%&gt;%</code>）で前の結果が自動的に渡される</td>
</tr>
<tr class="even">
<td>第2引数以降</td>
<td>データの処理内容・命令</td>
<td><code>x &gt; 10</code>, <code>species == "Adelie"</code>, <code>mean_x = mean(x)</code></td>
<td>「どの行を選ぶか」「どんな列を作るか」「どう集計するか」などを指定</td>
</tr>
<tr class="odd">
<td>命名引数（オプション）</td>
<td>関数の動作を細かく調整</td>
<td><code>na.rm = TRUE</code>, <code>.groups = "drop"</code></td>
<td>処理の詳細設定や出力形式の指定などに使われる</td>
</tr>
</tbody>
</table>
</section>
<section id="基本引数-関数ごとの例" class="slide level2">
<h2>基本：引数 &gt; 関数ごとの例</h2>
<table class="caption-top">
<colgroup>
<col style="width: 12%">
<col style="width: 37%">
<col style="width: 37%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th>関数</th>
<th>第1引数（データ）</th>
<th>第2引数以降の内容</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>select(df, x, y)</code></td>
<td><code>df</code></td>
<td><code>x, y</code></td>
<td>必要な列を選ぶ</td>
</tr>
<tr class="even">
<td><code>filter(df, species == "Adelie")</code></td>
<td><code>df</code></td>
<td><code>species == "Adelie"</code></td>
<td>条件に一致する行（例：「Adelie」種のみ）を選ぶ</td>
</tr>
<tr class="odd">
<td><code>mutate(df, z = x + y)</code></td>
<td><code>df</code></td>
<td><code>z = x + y</code></td>
<td>新しい列を追加または上書き</td>
</tr>
<tr class="even">
<td><code>arrange(df, desc(y))</code></td>
<td><code>df</code></td>
<td><code>desc(y)</code></td>
<td>並べ替えの基準を指定</td>
</tr>
</tbody>
</table>
</section>
<section id="基本生成ai" class="slide level2">
<h2>基本：生成AI</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>生成AI活用の勧め</strong></p>
</div>
<div class="callout-content">
<ul>
<li>以降のコードは初学者にはやや難しく、また時間的に丁寧に解説できません（関数はシンプルな英語なので直感的には理解できるとは思います）</li>
<li>コードをそのまま貼り付け、解説を求めましょう</li>
</ul>
</div>
</div>
</div>
<h4 id="出力例chatgpt">出力例（ChatGPT）</h4>
<pre><code>- ① filter(!if_any(everything(), is.na))
  - 意味：欠損値（NA）が含まれている行をすべて取り除きます。
  - everything() は「すべての列」を意味します。
  - if_any(..., is.na)は「どの列か1つでもNAがあるか？」を判定します。! は「〜でない」という否定なので、「NAがない行だけ残す」ことになります。
  - 👉 欠損のない完全なデータだけを残す処理。</code></pre>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li><a href="https://dplyr.tidyverse.org">dplyr</a>も生成AIを導入しました（右上のAsk AI）。日本語にも対応しています</li>
<li><a href="https://note.com/mitti1210/n/n26b1291596a7">Gemini CLI</a> *R Studio内部でも生成AIを活用できるようです（試していません）</li>
</ul>
</div>
</div>
</div>
</section>
<section id="基本rのヘルプ機能" class="slide level2">
<h2>基本：Rのヘルプ機能</h2>
<ul>
<li>Rはすべての関数にヘルプが付いている
<ul>
<li>コンソールペイン（画面左下）でRのヘルプを呼び出せる</li>
<li>? + 知りたい関数（例：?head）</li>
<li>右下のペインに説明が出る</li>
</ul></li>
<li>head()について調べてみよう（他の関数でもオッケー）</li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">項目</th>
<th style="text-align: left;">内容の例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Title</td>
<td style="text-align: left;">Returns the first or last parts…</td>
</tr>
<tr class="even">
<td style="text-align: left;">Description</td>
<td style="text-align: left;"><code>head()</code> はベクトルやデータフレームの「最初の数行」を返す</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Usage</td>
<td style="text-align: left;"><code>head(x, n = 6)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Arguments（引数）</td>
<td style="text-align: left;"><code>x</code> = 対象オブジェクト、<code>n</code> = 取り出す行数</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Examples</td>
<td style="text-align: left;">実際に使えるコード例が掲載されている（Run examplesは実際に動作する）</td>
</tr>
</tbody>
</table>
</section>
<section id="基本作図" class="slide level2">
<h2>基本：作図</h2>
<h3 id="図を作るggplotに渡す前にデータを整形する">図を作る：ggplotに渡す前にデータを整形する</h3>
<ul>
<li>group_by / summariseで集計した結果を、ggplotで図として出力する</li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>ggplotはレイヤーを重ねて図を作ります。演算子がパイプと違って「<em>+</em>」なのは、要素の追加をイメージしているからです</p>
</div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Code</a></li><li><a href="#tabset-1-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a></a>  <span class="co"># summarise()関数: 元データを要約して新しい表を作る関数</span></span>
<span id="cb19-4"><a></a>  <span class="do">## 第2引数で列を定義</span></span>
<span id="cb19-5"><a></a>  <span class="do">### 計算結果（ここではmean()関数の結果）に列名mean_body_mass（任意）を付けて出力</span></span>
<span id="cb19-6"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span>  </span>
<span id="cb19-7"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> mean_body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span> <span class="co"># fill = speciesは棒や面を塗りつぶす色をspeciesに応じて変える、の意</span></span>
<span id="cb19-8"><a></a>  <span class="fu">geom_col</span>() <span class="sc">+</span>   <span class="co"># geom_colはデータに渡されたyをそのまま棒の高さに使う</span></span>
<span id="cb19-9"><a></a>  <span class="fu">labs</span>(          <span class="co"># 変数名から任意のラベル名に変える</span></span>
<span id="cb19-10"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,</span>
<span id="cb19-11"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span></span>
<span id="cb19-12"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-18-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="基本作図-ggplotの日本語問題" class="slide level2">
<h2>基本：作図 &gt; ggplotの日本語問題</h2>
<h3 id="ggplotの日本語問題">ggplotの日本語問題</h3>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>x軸とy軸のラベルに日本語を用いています</li>
<li>種類や体重が□で表示されたら教えて下さい（すぐには対応できないと思いますが）
<ul>
<li>Cf. 準備：日本語対応（<a href="#/ggplot-japanese-mac">Mac</a> / <a href="#/ggplot-japanese-win">Windows</a>）</li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-19-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="基本作図-1" class="slide level2">
<h2>基本：作図</h2>
<h3 id="図を作るggplotに渡した後にデータを計算する">図を作る：ggplotに渡した後にデータを計算する</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span>  <span class="co"># ggplotでグラフ作成、x軸に種類、y軸に体重、棒の色を種類ごとに分ける</span></span>
<span id="cb20-3"><a></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"bar"</span>) <span class="sc">+</span>                  <span class="co"># 各種類の体重の平均を計算して棒グラフにする（ggplot2パッケージ内の関数）</span></span>
<span id="cb20-4"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb20-5"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,                                             <span class="co"># x軸のラベルを「種類」に変更</span></span>
<span id="cb20-6"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span>                                         <span class="co"># y軸のラベルを「体重 (g)」に変更</span></span>
<span id="cb20-7"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-20-1.png" width="960" class="r-stretch"></section>
<section id="基本計算" class="slide level2">
<h2>基本：計算</h2>
<h3 id="相関係数の算出">相関係数の算出</h3>
<ul>
<li>bill_len: くちばしの長さ
<ul>
<li>魚をつかまえたり、巣材をくわえたりすることに関わる</li>
</ul></li>
<li>bill_dep: くちばしの奥行き
<ul>
<li>くちばしの太さや力強さの目安になる</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-5"><a></a>    <span class="at">cor_bill =</span> <span class="fu">round</span>(<span class="fu">cor</span>(bill_len, bill_dep), <span class="dv">3</span>)</span>
<span id="cb21-6"><a></a>  ) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tmrvstbavl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tmrvstbavl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tmrvstbavl thead, #tmrvstbavl tbody, #tmrvstbavl tfoot, #tmrvstbavl tr, #tmrvstbavl td, #tmrvstbavl th {
  border-style: none;
}

#tmrvstbavl p {
  margin: 0;
  padding: 0;
}

#tmrvstbavl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tmrvstbavl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tmrvstbavl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tmrvstbavl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tmrvstbavl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmrvstbavl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmrvstbavl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmrvstbavl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tmrvstbavl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tmrvstbavl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tmrvstbavl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tmrvstbavl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tmrvstbavl .gt_spanner_row {
  border-bottom-style: hidden;
}

#tmrvstbavl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tmrvstbavl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tmrvstbavl .gt_from_md > :first-child {
  margin-top: 0;
}

#tmrvstbavl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tmrvstbavl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tmrvstbavl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tmrvstbavl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tmrvstbavl .gt_row_group_first td {
  border-top-width: 2px;
}

#tmrvstbavl .gt_row_group_first th {
  border-top-width: 2px;
}

#tmrvstbavl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmrvstbavl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tmrvstbavl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tmrvstbavl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmrvstbavl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmrvstbavl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tmrvstbavl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tmrvstbavl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tmrvstbavl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmrvstbavl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmrvstbavl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmrvstbavl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmrvstbavl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmrvstbavl .gt_left {
  text-align: left;
}

#tmrvstbavl .gt_center {
  text-align: center;
}

#tmrvstbavl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tmrvstbavl .gt_font_normal {
  font-weight: normal;
}

#tmrvstbavl .gt_font_bold {
  font-weight: bold;
}

#tmrvstbavl .gt_font_italic {
  font-style: italic;
}

#tmrvstbavl .gt_super {
  font-size: 65%;
}

#tmrvstbavl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tmrvstbavl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tmrvstbavl .gt_indent_1 {
  text-indent: 5px;
}

#tmrvstbavl .gt_indent_2 {
  text-indent: 10px;
}

#tmrvstbavl .gt_indent_3 {
  text-indent: 15px;
}

#tmrvstbavl .gt_indent_4 {
  text-indent: 20px;
}

#tmrvstbavl .gt_indent_5 {
  text-indent: 25px;
}

#tmrvstbavl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tmrvstbavl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="species" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">species</th>
<th id="cor_bill" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">cor_bill</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="species">Adelie</td>
<td class="gt_row gt_right" headers="cor_bill">0.386</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="species">Chinstrap</td>
<td class="gt_row gt_right" headers="cor_bill">0.654</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="species">Gentoo</td>
<td class="gt_row gt_right" headers="cor_bill">0.654</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="基本作図-散布図" class="slide level2">
<h2>基本：作図 &gt; 散布図</h2>
<h3 id="散布図の作成">散布図の作成</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span>  </span>
<span id="cb22-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_len, <span class="at">y =</span> bill_dep, <span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb22-4"><a></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="基本作図-棒グラフファセット" class="slide level2">
<h2>基本：作図 &gt; 棒グラフ（ファセット）</h2>
<h3 id="見比べる">見比べる</h3>
<ul>
<li>species（種）とisland（島）に関係はあるの？</li>
<li>facet()関数：図を変数の値ごとに分割して、複数の小さなグラフにする
<ul>
<li>1つの大きなデータの面を切り分けて、それぞれの側面を並べて見る</li>
</ul></li>
</ul>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Code</a></li><li><a href="#tabset-2-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb23" data-code-line-numbers="2,10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a></a>  <span class="fu">group_by</span>(species, island) <span class="sc">|&gt;</span> <span class="co"># グルーピングにisland（住んでいる島）を追加</span></span>
<span id="cb23-3"><a></a>  <span class="fu">summarise</span>(<span class="at">mean_body_mass =</span> <span class="fu">mean</span>(body_mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> mean_body_mass, <span class="at">fill =</span> species)) <span class="sc">+</span></span>
<span id="cb23-5"><a></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb23-7"><a></a>    <span class="at">x =</span> <span class="st">"種類"</span>,</span>
<span id="cb23-8"><a></a>    <span class="at">y =</span> <span class="st">"体重 (g)"</span></span>
<span id="cb23-9"><a></a>  ) <span class="sc">+</span></span>
<span id="cb23-10"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>island) <span class="co"># 指定の変数(カラム名、ここではisland)によって小さなグラフを作って並べる</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="基本クロス集計-gtsummary" class="slide level2">
<h2>基本：クロス集計 &gt; gtsummary</h2>
<h3 id="クロス集計">クロス集計</h3>
<ul>
<li>gtsummaryパッケージを追加（インストール後、Setup Chunkで読み込み）</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a></a>  <span class="fu">tbl_cross</span>(</span>
<span id="cb24-4"><a></a>    <span class="at">row =</span> species, <span class="co"># rowに行変数</span></span>
<span id="cb24-5"><a></a>    <span class="at">col =</span> island, <span class="co"># colに列変数を指定</span></span>
<span id="cb24-6"><a></a>    <span class="at">percent =</span> <span class="st">"row"</span> <span class="co"># 行ごとの割合を表示</span></span>
<span id="cb24-7"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="rnuufltnxy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rnuufltnxy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rnuufltnxy thead, #rnuufltnxy tbody, #rnuufltnxy tfoot, #rnuufltnxy tr, #rnuufltnxy td, #rnuufltnxy th {
  border-style: none;
}

#rnuufltnxy p {
  margin: 0;
  padding: 0;
}

#rnuufltnxy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rnuufltnxy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rnuufltnxy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rnuufltnxy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rnuufltnxy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnuufltnxy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnuufltnxy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnuufltnxy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rnuufltnxy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rnuufltnxy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rnuufltnxy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rnuufltnxy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rnuufltnxy .gt_spanner_row {
  border-bottom-style: hidden;
}

#rnuufltnxy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rnuufltnxy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rnuufltnxy .gt_from_md > :first-child {
  margin-top: 0;
}

#rnuufltnxy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rnuufltnxy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rnuufltnxy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rnuufltnxy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rnuufltnxy .gt_row_group_first td {
  border-top-width: 2px;
}

#rnuufltnxy .gt_row_group_first th {
  border-top-width: 2px;
}

#rnuufltnxy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnuufltnxy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rnuufltnxy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rnuufltnxy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnuufltnxy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnuufltnxy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rnuufltnxy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rnuufltnxy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rnuufltnxy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnuufltnxy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnuufltnxy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnuufltnxy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnuufltnxy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnuufltnxy .gt_left {
  text-align: left;
}

#rnuufltnxy .gt_center {
  text-align: center;
}

#rnuufltnxy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rnuufltnxy .gt_font_normal {
  font-weight: normal;
}

#rnuufltnxy .gt_font_bold {
  font-weight: bold;
}

#rnuufltnxy .gt_font_italic {
  font-style: italic;
}

#rnuufltnxy .gt_super {
  font-size: 65%;
}

#rnuufltnxy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rnuufltnxy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rnuufltnxy .gt_indent_1 {
  text-indent: 5px;
}

#rnuufltnxy .gt_indent_2 {
  text-indent: 10px;
}

#rnuufltnxy .gt_indent_3 {
  text-indent: 15px;
}

#rnuufltnxy .gt_indent_4 {
  text-indent: 20px;
}

#rnuufltnxy .gt_indent_5 {
  text-indent: 25px;
}

#rnuufltnxy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rnuufltnxy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="<div data-qmd-base64=&quot;aXNsYW5k&quot;><div class='gt_from_md'><p>island</p>
</div></div>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"></span>
<p>island</p>
</th>
<th rowspan="2" id="<div data-qmd-base64=&quot;VG90YWw=&quot;><div class='gt_from_md'><p>Total</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Total</p></th>
</tr>
<tr class="gt_col_headings even">
<th id="<div data-qmd-base64=&quot;QmlzY29l&quot;><div class='gt_from_md'><p>Biscoe</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Biscoe</p></th>
<th id="<div data-qmd-base64=&quot;RHJlYW0=&quot;><div class='gt_from_md'><p>Dream</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Dream</p></th>
<th id="<div data-qmd-base64=&quot;VG9yZ2Vyc2Vu&quot;><div class='gt_from_md'><p>Torgersen</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Torgersen</p></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">species</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Adelie</td>
<td class="gt_row gt_center" headers="stat_1">44 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">56 (37%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (34%)</td>
<td class="gt_row gt_center" headers="stat_0">152 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chinstrap</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">68 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">68 (100%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gentoo</td>
<td class="gt_row gt_center" headers="stat_1">124 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">124 (100%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">168 (49%)</td>
<td class="gt_row gt_center" headers="stat_2">124 (36%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (15%)</td>
<td class="gt_row gt_center" headers="stat_0">344 (100%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li>件数と割合を自動計算して表にしてくれる</li>
<li>見やすく整形され、発表資料にも向く</li>
</ul>
</div></div>
</section>
<section id="基本クロス集計-gtsummary-1" class="slide level2">
<h2>基本：クロス集計 &gt; gtsummary</h2>
<h3 id="クロス集計-1">クロス集計</h3>
<ul>
<li>add_p()を加えるだけでカイ二乗検定（またはFisher検定）を自動で実行してくれる</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Code</a></li><li><a href="#tabset-3-2">Table</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb25" data-code-line-numbers="8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a></a>  <span class="fu">tbl_cross</span>(</span>
<span id="cb25-4"><a></a>    <span class="at">row =</span> species,</span>
<span id="cb25-5"><a></a>    <span class="at">col =</span> island,</span>
<span id="cb25-6"><a></a>    <span class="at">percent =</span> <span class="st">"row"</span></span>
<span id="cb25-7"><a></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb25-8"><a></a>  <span class="fu">add_p</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="cell-output-display">
<div id="rtvtptbqlc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rtvtptbqlc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rtvtptbqlc thead, #rtvtptbqlc tbody, #rtvtptbqlc tfoot, #rtvtptbqlc tr, #rtvtptbqlc td, #rtvtptbqlc th {
  border-style: none;
}

#rtvtptbqlc p {
  margin: 0;
  padding: 0;
}

#rtvtptbqlc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rtvtptbqlc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rtvtptbqlc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rtvtptbqlc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rtvtptbqlc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtvtptbqlc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtvtptbqlc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtvtptbqlc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rtvtptbqlc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rtvtptbqlc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rtvtptbqlc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rtvtptbqlc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rtvtptbqlc .gt_spanner_row {
  border-bottom-style: hidden;
}

#rtvtptbqlc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rtvtptbqlc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rtvtptbqlc .gt_from_md > :first-child {
  margin-top: 0;
}

#rtvtptbqlc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rtvtptbqlc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rtvtptbqlc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rtvtptbqlc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rtvtptbqlc .gt_row_group_first td {
  border-top-width: 2px;
}

#rtvtptbqlc .gt_row_group_first th {
  border-top-width: 2px;
}

#rtvtptbqlc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtvtptbqlc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rtvtptbqlc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rtvtptbqlc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtvtptbqlc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtvtptbqlc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rtvtptbqlc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rtvtptbqlc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rtvtptbqlc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtvtptbqlc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtvtptbqlc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtvtptbqlc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtvtptbqlc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtvtptbqlc .gt_left {
  text-align: left;
}

#rtvtptbqlc .gt_center {
  text-align: center;
}

#rtvtptbqlc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rtvtptbqlc .gt_font_normal {
  font-weight: normal;
}

#rtvtptbqlc .gt_font_bold {
  font-weight: bold;
}

#rtvtptbqlc .gt_font_italic {
  font-style: italic;
}

#rtvtptbqlc .gt_super {
  font-size: 65%;
}

#rtvtptbqlc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rtvtptbqlc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rtvtptbqlc .gt_indent_1 {
  text-indent: 5px;
}

#rtvtptbqlc .gt_indent_2 {
  text-indent: 10px;
}

#rtvtptbqlc .gt_indent_3 {
  text-indent: 15px;
}

#rtvtptbqlc .gt_indent_4 {
  text-indent: 20px;
}

#rtvtptbqlc .gt_indent_5 {
  text-indent: 25px;
}

#rtvtptbqlc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rtvtptbqlc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" style="width:100%;" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th colspan="3" id="<div data-qmd-base64=&quot;aXNsYW5k&quot;><div class='gt_from_md'><p>island</p>
</div></div>" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><span class="gt_column_spanner"></span>
<p>island</p>
</th>
<th rowspan="2" id="<div data-qmd-base64=&quot;VG90YWw=&quot;><div class='gt_from_md'><p>Total</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Total</p></th>
<th rowspan="2" id="<div data-qmd-base64=&quot;cC12YWx1ZQ==&quot;><div class='gt_from_md'><p>p-value</p>
</div></div><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;&quot;><sup>1</sup></span>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>p-value</p>
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span></th>
</tr>
<tr class="gt_col_headings even">
<th id="<div data-qmd-base64=&quot;QmlzY29l&quot;><div class='gt_from_md'><p>Biscoe</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Biscoe</p></th>
<th id="<div data-qmd-base64=&quot;RHJlYW0=&quot;><div class='gt_from_md'><p>Dream</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Dream</p></th>
<th id="<div data-qmd-base64=&quot;VG9yZ2Vyc2Vu&quot;><div class='gt_from_md'><p>Torgersen</p>
</div></div>" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><p>Torgersen</p></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">species</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
<td class="gt_row gt_center" headers="stat_3"><br>
</td>
<td class="gt_row gt_center" headers="stat_0"><br>
</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Adelie</td>
<td class="gt_row gt_center" headers="stat_1">44 (29%)</td>
<td class="gt_row gt_center" headers="stat_2">56 (37%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (34%)</td>
<td class="gt_row gt_center" headers="stat_0">152 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Chinstrap</td>
<td class="gt_row gt_center" headers="stat_1">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_2">68 (100%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">68 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Gentoo</td>
<td class="gt_row gt_center" headers="stat_1">124 (100%)</td>
<td class="gt_row gt_center" headers="stat_2">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_3">0 (0%)</td>
<td class="gt_row gt_center" headers="stat_0">124 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Total</td>
<td class="gt_row gt_center" headers="stat_1">168 (49%)</td>
<td class="gt_row gt_center" headers="stat_2">124 (36%)</td>
<td class="gt_row gt_center" headers="stat_3">52 (15%)</td>
<td class="gt_row gt_center" headers="stat_0">344 (100%)</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="6" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height: 0;"><sup>1</sup></span>
<p>Pearson’s Chi-squared test</p></td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="基本クロス集計-crosstable" class="slide level2">
<h2>基本：クロス集計 &gt; crosstable</h2>
<h3 id="クロス集計-2">クロス集計</h3>
<ul>
<li>crosstableパッケージの場合</li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>多くの人がパッケージを開発しているため、同様の機能をもつ複数のパッケージがあります</p>
</div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Code</a></li><li><a href="#tabset-4-2">Table</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a></a>  <span class="fu">select</span>(species, island) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a></a>  <span class="fu">crosstable</span>(<span class="at">by =</span> species,</span>
<span id="cb26-5"><a></a>             <span class="at">cols =</span> island,</span>
<span id="cb26-6"><a></a>             <span class="at">total =</span> <span class="st">"row"</span>,</span>
<span id="cb26-7"><a></a>             <span class="at">funs =</span> <span class="fu">list</span>(<span class="at">prop =</span> <span class="sc">~</span><span class="fu">prop.table</span>(.))) <span class="sc">|&gt;</span> </span>
<span id="cb26-8"><a></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell">
<div class="cell-output-display">
<div id="rdbkpirjsz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rdbkpirjsz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rdbkpirjsz thead, #rdbkpirjsz tbody, #rdbkpirjsz tfoot, #rdbkpirjsz tr, #rdbkpirjsz td, #rdbkpirjsz th {
  border-style: none;
}

#rdbkpirjsz p {
  margin: 0;
  padding: 0;
}

#rdbkpirjsz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rdbkpirjsz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rdbkpirjsz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rdbkpirjsz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rdbkpirjsz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdbkpirjsz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdbkpirjsz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rdbkpirjsz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rdbkpirjsz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rdbkpirjsz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rdbkpirjsz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rdbkpirjsz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rdbkpirjsz .gt_spanner_row {
  border-bottom-style: hidden;
}

#rdbkpirjsz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rdbkpirjsz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rdbkpirjsz .gt_from_md > :first-child {
  margin-top: 0;
}

#rdbkpirjsz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rdbkpirjsz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rdbkpirjsz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rdbkpirjsz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rdbkpirjsz .gt_row_group_first td {
  border-top-width: 2px;
}

#rdbkpirjsz .gt_row_group_first th {
  border-top-width: 2px;
}

#rdbkpirjsz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdbkpirjsz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rdbkpirjsz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rdbkpirjsz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdbkpirjsz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdbkpirjsz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rdbkpirjsz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rdbkpirjsz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rdbkpirjsz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rdbkpirjsz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdbkpirjsz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdbkpirjsz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rdbkpirjsz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rdbkpirjsz .gt_left {
  text-align: left;
}

#rdbkpirjsz .gt_center {
  text-align: center;
}

#rdbkpirjsz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rdbkpirjsz .gt_font_normal {
  font-weight: normal;
}

#rdbkpirjsz .gt_font_bold {
  font-weight: bold;
}

#rdbkpirjsz .gt_font_italic {
  font-style: italic;
}

#rdbkpirjsz .gt_super {
  font-size: 65%;
}

#rdbkpirjsz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rdbkpirjsz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rdbkpirjsz .gt_indent_1 {
  text-indent: 5px;
}

#rdbkpirjsz .gt_indent_2 {
  text-indent: 10px;
}

#rdbkpirjsz .gt_indent_3 {
  text-indent: 15px;
}

#rdbkpirjsz .gt_indent_4 {
  text-indent: 20px;
}

#rdbkpirjsz .gt_indent_5 {
  text-indent: 25px;
}

#rdbkpirjsz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rdbkpirjsz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id=".id" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">.id</th>
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">label</th>
<th id="variable" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">variable</th>
<th id="Adelie" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Adelie</th>
<th id="Chinstrap" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Chinstrap</th>
<th id="Gentoo" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Gentoo</th>
<th id="Total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Biscoe</td>
<td class="gt_row gt_right" headers="Adelie">44 (26.19%)</td>
<td class="gt_row gt_right" headers="Chinstrap">0 (0%)</td>
<td class="gt_row gt_right" headers="Gentoo">124 (73.81%)</td>
<td class="gt_row gt_right" headers="Total">168 (48.84%)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Dream</td>
<td class="gt_row gt_right" headers="Adelie">56 (45.16%)</td>
<td class="gt_row gt_right" headers="Chinstrap">68 (54.84%)</td>
<td class="gt_row gt_right" headers="Gentoo">0 (0%)</td>
<td class="gt_row gt_right" headers="Total">124 (36.05%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers=".id">island</td>
<td class="gt_row gt_left" headers="label">island</td>
<td class="gt_row gt_left" headers="variable">Torgersen</td>
<td class="gt_row gt_right" headers="Adelie">52 (100.00%)</td>
<td class="gt_row gt_right" headers="Chinstrap">0 (0%)</td>
<td class="gt_row gt_right" headers="Gentoo">0 (0%)</td>
<td class="gt_row gt_right" headers="Total">52 (15.12%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="基本代入" class="slide level2">
<h2>基本：代入</h2>
<h3 id="代入">代入</h3>
<ul>
<li>代入 = 値や計算結果を変数や列に「入れる」こと（正確には、変数名に値や計算結果を結びつける）</li>
<li>Rでは通常 x <em>&lt;-</em> 1 のように左向き矢印を使う
<ul>
<li>1 <em>-&gt;</em> x（コード末尾に代入）と書いても同じ意味、処理だが、一般的ではない</li>
</ul></li>
</ul>
<h3 id="代入の目的とパターン">代入の目的とパターン</h3>
<ul>
<li>目的：計算や変形したオブジェクトを、別の処理や可視化で使う</li>
<li>パターン：
<ol type="1">
<li>新しいオブジェクトにする（オブジェクトを作る）</li>
<li>オブジェクトを上書きする</li>
</ol></li>
</ul>
</section>
<section id="基本代入-新しいオブジェクト" class="slide level2">
<h2>基本：代入 &gt; 新しいオブジェクト</h2>
<h3 id="新しいオブジェクトを作る">新しいオブジェクトを作る</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>penguins_kg <span class="ot">&lt;-</span> <span class="co"># オブジェクト名は任意（以下のtipsを参照）</span></span>
<span id="cb27-2"><a></a>  penguins <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a></a>  <span class="fu">mutate</span>(<span class="at">body_mass_kg =</span> body_mass <span class="sc">/</span> <span class="dv">1000</span>)  <span class="co"># g → kg に変換して新しい列に代入</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<ul>
<li>オブジェクト名は英字で始め、小文字と_（アンダースコア）を使い、（自分なりに）意味のある名前、規則性のある名前を付しましょう
<ul>
<li>私（苅谷）の場合：データフレームはdfとする 例：df_penguins</li>
</ul></li>
<li>数字で始めることはできません（最初の文字以外では使えます）</li>
<li>記号や空白は避けましょう。日本語文字（2バイト文字）も避けましょう（技術的には可能だが推奨されない）</li>
<li>詳しくは<a href="https://style.tidyverse.org/syntax.html#sec-objectnames">Tidyverse style guide</a>を参照</li>
</ul>
</div>
</div>
</div>
</section>
<section id="基本代入-オブジェクトの上書き" class="slide level2">
<h2>基本：代入 &gt; オブジェクトの上書き</h2>
<h3 id="オブジェクトを上書きする">オブジェクトを上書きする</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a>penguins <span class="ot">&lt;-</span></span>
<span id="cb28-2"><a></a>  penguins <span class="sc">|&gt;</span> <span class="co"># 同じオブジェクト名を指定</span></span>
<span id="cb28-3"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass))  <span class="co"># NA を除いたデータに上書き</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>元のpenguinsは NAを含む元のデータではなくなります</p>
</div>
</div>
</div>
</section>
<section id="基本ショートカット-1" class="slide level2">
<h2>基本：ショートカット</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>代入演算子（&lt;-）のショートカット</strong></p>
</div>
<div class="callout-content">
<ul>
<li>チャンク内で
<ul>
<li>Win: Alt + 「-」キー</li>
<li>Mac: Option + 「-」キー</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>特定のチャンクが動かない</strong></p>
</div>
<div class="callout-content">
<ul>
<li>原因がすぐにわからないエラーが出ても安心です（<em>よくあること</em>です）</li>
<li>そのチャンクだけ実行をスキップできるので、レポート全体のレンダーに影響しません（冒頭に「#| eval: false」と書く）</li>
</ul>
</div>
</div>
</div>

<img data-src="img/eval_false.png" class="r-stretch"></section>
<section id="基本画像の書き出し" class="slide level2">
<h2>基本：画像の書き出し</h2>
<ul>
<li>ggsave()関数
<ul>
<li>あらかじめ、qmdファイルと同じ階層に出力先フォルダを作る（例：img）</li>
<li>ggsave()関数はパイプ処理できないため、オブジェクトに代入</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a>p <span class="ot">&lt;-</span> <span class="co"># ggsaveはパイプ処理できません。一旦、pというオブジェクトに代入（pでなくてもいいです）</span></span>
<span id="cb29-2"><a></a>  penguins <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span>  </span>
<span id="cb29-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> bill_len, <span class="at">y =</span> bill_dep, <span class="at">colour =</span> species)) <span class="sc">+</span></span>
<span id="cb29-5"><a></a>  <span class="fu">geom_point</span>()</span>
<span id="cb29-6"><a></a></span>
<span id="cb29-7"><a></a><span class="fu">ggsave</span>(<span class="st">"img/geom_point_penguins.png"</span>, <span class="at">plot =</span> p, <span class="at">width =</span> <span class="dv">8</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb29-8"><a></a><span class="co"># 出力先と出力ファイル名、出力するオブジェクトを指定（plot = p）。サイズは任意</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本データファイルの書き出し" class="slide level2">
<h2>基本：データファイルの書き出し</h2>
<ul>
<li>write_csv()関数
<ul>
<li>あらかじめ、qmdファイルと同じ階層に出力先フォルダを作る（例：data）</li>
<li>write_csv()関数はパイプ処理できないため、オブジェクトに代入</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>t <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">if_any</span>(<span class="fu">everything</span>(), is.na)) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb30-5"><a></a>    <span class="at">cor_bill =</span> <span class="fu">round</span>(<span class="fu">cor</span>(bill_len, bill_dep), <span class="dv">3</span>)</span>
<span id="cb30-6"><a></a>  )</span>
<span id="cb30-7"><a></a></span>
<span id="cb30-8"><a></a><span class="co"># CSVとして書き出す</span></span>
<span id="cb30-9"><a></a><span class="fu">write_csv</span>(t, <span class="st">"data/penguins_summary.csv"</span>) <span class="co"># 出力するオブジェクトと、出力先を指定</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Excelファイルを出力したい場合は、writexlやopenxlsxなどの専用パッケージを使います（tidyverseには含まれていません）</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="co"># xlsxとして書き出す</span></span>
<span id="cb31-2"><a></a><span class="fu">write_xlsx</span>(t, <span class="st">"data/penguins_summary.csv"</span>) <span class="co"># 出力するオブジェクトと、出力先を指定</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="基本練習問題" class="slide level2">
<h2>基本：練習問題</h2>
<p>penguinsのデータセットを用いて、Biscoe（ビスコー）島に住むペンギンの特徴を分析して下さい。</p>
<ol type="1">
<li><p>任意の観測データを用いて、種別ごとの平均値を算出して下さい。算出したデータを新しいオブジェクトに入れて下さい（オブジェクト名は、わかりやすい名前を任意でつけて下さい）</p></li>
<li><p>（時間が余った人だけ）上記で作成したオブジェクトをggplotに渡して、任意の図を作成して下さい</p></li>
</ol>
</section></section>
<section>
<section id="実践編rを動かしてみよう社会科学のデータ" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅴ. 《実践編》Rを動かしてみよう：社会科学のデータ</h1>

</section>
<section id="実践urlからデータ取得oecd景気先行指数" class="slide level2">
<h2>実践：URLからデータ取得（OECD景気先行指数）</h2>
<ul>
<li><a href="https://www.oecd.org/en/data.html">OECDデータセット</a>：Composite Leading Indicators (CLI)</li>
<li>urlを指定して、データを取得（ファイルはダウンロードしない）</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">Code</a></li><li><a href="#tabset-5-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>url <span class="ot">&lt;-</span> <span class="st">"https://sdmx.oecd.org/public/rest/data/OECD.SDD.STES,DSD_STES@DF_CLI/.M.LI...AA...H?startPeriod=2023-02&amp;dimensionAtObservation=AllDimensions&amp;format=csvfilewithlabels"</span></span>
<span id="cb32-2"><a></a></span>
<span id="cb32-3"><a></a>df_oecd_cli <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(url) <span class="co"># 指定したURLからデータを読み込む</span></span>
<span id="cb32-4"><a></a></span>
<span id="cb32-5"><a></a><span class="co"># URLにアクセスできない場合（短時間にアクセスを繰り返すと接続拒否されることがあります。その場合は、エラーが出てデータを取得できません。以下のコメントアウトを外して（ハッシュタグを削除）、csvファイルからデータを読み取って下さい）</span></span>
<span id="cb32-6"><a></a><span class="co"># df_oecd_cli &lt;-</span></span>
<span id="cb32-7"><a></a><span class="co">#  read_csv("data/df_oecd_cli.csv")</span></span>
<span id="cb32-8"><a></a></span>
<span id="cb32-9"><a></a>de_oecd_cli_selected <span class="ot">&lt;-</span> </span>
<span id="cb32-10"><a></a>  df_oecd_cli <span class="sc">|&gt;</span> </span>
<span id="cb32-11"><a></a>  <span class="fu">select</span>(REF_AREA, TIME_PERIOD, OBS_VALUE) <span class="sc">|&gt;</span> <span class="co"># 必要な列を取り出す</span></span>
<span id="cb32-12"><a></a>  <span class="fu">mutate</span>(<span class="at">TIME_PERIOD =</span> <span class="fu">ymd</span>(TIME_PERIOD)) <span class="co"># 日付型に変換</span></span>
<span id="cb32-13"><a></a></span>
<span id="cb32-14"><a></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JPN"</span>, <span class="st">"USA"</span>, <span class="st">"DEU"</span>, <span class="st">"FRA"</span>, <span class="st">"KOR"</span>) <span class="co">#主要国だけ選ぶ（主要国のオブジェクトを作る）</span></span>
<span id="cb32-15"><a></a></span>
<span id="cb32-16"><a></a>de_oecd_cli_selected <span class="sc">|&gt;</span></span>
<span id="cb32-17"><a></a>  <span class="fu">filter</span>(REF_AREA <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> <span class="co"># REF_AREA が countries に含まれる行だけを抽出</span></span>
<span id="cb32-18"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME_PERIOD, <span class="at">y =</span> OBS_VALUE, <span class="at">color =</span> REF_AREA)) <span class="sc">+</span></span>
<span id="cb32-19"><a></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-37-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践urlからデータ取得oecd景気先行指数-1" class="slide level2">
<h2>実践：URLからデータ取得（OECD景気先行指数）</h2>
<h3 id="見た目を整える">見た目を整える</h3>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">Code</a></li><li><a href="#tabset-6-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a></a>de_oecd_cli_selected <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a></a>  <span class="fu">filter</span>(REF_AREA <span class="sc">%in%</span> countries) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TIME_PERIOD, <span class="at">y =</span> OBS_VALUE, <span class="at">color =</span> REF_AREA)) <span class="sc">+</span></span>
<span id="cb33-4"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a></a>  <span class="fu">scale_x_date</span>(</span>
<span id="cb33-6"><a></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_width</span>(<span class="st">"3 months"</span>),  <span class="co"># x軸の間隔調整</span></span>
<span id="cb33-7"><a></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_date_short</span>()         <span class="co"># 年と月を行を変えて表記</span></span>
<span id="cb33-8"><a></a>  ) <span class="sc">+</span></span>
<span id="cb33-9"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb33-10"><a></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="dv">8</span>),        <span class="co"># 目盛りの個数を指定</span></span>
<span id="cb33-11"><a></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">accuracy =</span> <span class="dv">1</span>) <span class="co"># 数値表示（小数なし）</span></span>
<span id="cb33-12"><a></a>  ) <span class="sc">+</span></span>
<span id="cb33-13"><a></a>  <span class="fu">labs</span>(                                         <span class="co"># ラベル名と凡例名の変更</span></span>
<span id="cb33-14"><a></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb33-15"><a></a>    <span class="at">y =</span>  <span class="st">"Composite Leading Indicator (CLI)"</span>,,</span>
<span id="cb33-16"><a></a>    <span class="at">color =</span> <span class="st">"Country"</span></span>
<span id="cb33-17"><a></a>  ) <span class="sc">+</span></span>
<span id="cb33-18"><a></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"awtools::mpalette"</span>) <span class="sc">+</span> <span class="co"># 配色変更</span></span>
<span id="cb33-19"><a></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co"># x軸のラベルの傾き調整（この事例は適切なユースケースではない）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-40-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践ファイルの読み込み訪日外客数の推移" class="slide level2">
<h2>実践：ファイルの読み込み（訪日外客数の推移）</h2>
<ul>
<li>日本の観光統計データ &gt; 「<a href="https://statistics.jnto.go.jp/graph/#graph--inbound--travelers--transition">年別 訪日外客数の推移</a>」から「データをダウンロード」</li>
<li>エディタに貼り付けて保存
<ul>
<li>保存形式はcsvとする</li>
<li>新たにdataというフォルダを作って、そこに保存</li>
<li>ファイル名は任意（英数字がよい）</li>
</ul></li>
</ul>
<h3 id="e-statの難しさ">e-statの難しさ</h3>
<ul>
<li>日本政府統計の総合窓口e-statに格納されている多くのデータは、「表」形式（messyデータ）でまとめられており、R言語を含むプログラム言語では扱いづらい
<ul>
<li>大きな加工が必要で、dplyr/tidyrの熟練した操作を要する</li>
<li>Cf. <a href="#/e-stat">さらに学ぶ：データ &gt; e-statの処理</a></li>
</ul></li>
</ul>
</section>
<section id="実践ファイルの読み込み訪日外客数の推移-1" class="slide level2">
<h2>実践：ファイルの読み込み（訪日外客数の推移）</h2>
<h3 id="フォルダとファイルの構成確認">フォルダとファイルの構成（確認）</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode numberSource plaintext number-lines code-with-copy"><code class="sourceCode"><span id="cb34-1"><a></a>├── firststep.Rproj</span>
<span id="cb34-2"><a></a>├── firststep.qmd</span>
<span id="cb34-3"><a></a>├── img</span>
<span id="cb34-4"><a></a>│   └── geom_point_penguins.png</span>
<span id="cb34-5"><a></a>└─── data</span>
<span id="cb34-6"><a></a>    ├── speech_ishiba.rds</span>
<span id="cb34-7"><a></a>    ├── penguins_summary.csv</span>
<span id="cb34-8"><a></a>    └── inbound_travelers.csv</span>
<span id="cb34-9"><a></a>    └── sample.pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Quartファイルとimg/dataフォルダの相対的な位置関係を確認</li>
</ul>
</section>
<section id="実践ファイルの読み込み訪日外客数の推移-2" class="slide level2">
<h2>実践：ファイルの読み込み（訪日外客数の推移）</h2>
<ul>
<li>データの読み込み：read_csv()関数</li>
</ul>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>read.csv関数が補完入力されるかもしれません。read.csv関数はbase Rの関数で、今日では標準ではありません（<em>.ドットと_アンダースコア</em>の違い）</p>
</div>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-7" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-7-1">Code</a></li><li><a href="#tabset-7-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a></a>df_inbound <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a></a>  <span class="fu">read_csv</span>(<span class="st">"data/inbound_travelers.csv"</span>) <span class="co"># ファイル名は各自がつけたものとする</span></span>
<span id="cb35-3"><a></a></span>
<span id="cb35-4"><a></a>df_inbound <span class="sc">|&gt;</span> </span>
<span id="cb35-5"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> <span class="st">`</span><span class="at">Visitor Arrivals</span><span class="st">`</span>)) <span class="sc">+</span> <span class="co"># カラム名に空白や記号が含まれている場合は、バッククォート（`）で囲む（日本語キーボード：Shift + @ / 英語キーボード：数字の1の左）</span></span>
<span id="cb35-6"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb35-7"><a></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb35-8"><a></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1964</span>, <span class="dv">2025</span>, <span class="at">by =</span> <span class="dv">5</span>)  <span class="co"># 5年刻み</span></span>
<span id="cb35-9"><a></a>  ) <span class="sc">+</span></span>
<span id="cb35-10"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"年"</span>,</span>
<span id="cb35-11"><a></a>       <span class="at">y =</span> <span class="st">"訪日外国人客数"</span>) <span class="sc">+</span></span>
<span id="cb35-12"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb35-13"><a></a>    <span class="at">labels =</span> <span class="fu">label_number</span>(<span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">accuracy =</span> <span class="dv">1</span>)</span>
<span id="cb35-14"><a></a>  ) <span class="co"># 指数表記を通常表記に（指数表記をあらためるためには、scalesパッケージを追加する必要があります）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-42-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践データの読み込み" class="slide level2">
<h2>実践：データの読み込み</h2>
<h3 id="データの読み込み">データの読み込み</h3>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>文字コード</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Windows標準やExcel標準（日本）のCP932形式（Shift_JIS）で作成されたファイルを読み込むには、文字コードを指定する必要あります
<ul>
<li>文字化けの原因のほとんどは文字コードに起因する</li>
</ul></li>
<li>現在の世界標準の文字コードはユニコード(UTF-8)
<ul>
<li>特別の指定なく読み込める</li>
</ul></li>
<li>エディタで文字コードを変更するのではなく、読み込みの段階で文字コードを変更する（<em>locale = locale(encoding = “cp932”</em>）癖をつけましょう
<ul>
<li>元ファイルは触らないのが原則</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="fu">read_csv</span>(<span class="st">"filename.csv"</span></span>
<span id="cb36-2"><a></a>         , <span class="at">locale =</span> <span class="fu">locale</span>(<span class="at">encoding =</span> <span class="st">"cp932"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="実践データの読み込み-1" class="slide level2">
<h2>実践：データの読み込み</h2>
<h3 id="エクセルファイルを読み込む">エクセルファイルを読み込む</h3>
<ul>
<li>readxl()関数を使用
<ul>
<li>tidyverseパッケージに入っていないので、追加インストールが必要</li>
</ul></li>
</ul>
<h3 id="基本形">基本形</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb37-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="シートを指定して読み込む">シートを指定して読み込む</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb38-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"2024年データ"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<h3 id="列名を含めない1行目をデータとして扱う">列名を含めない（1行目をデータとして扱う）</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a>df <span class="ot">&lt;-</span></span>
<span id="cb39-2"><a></a>  <span class="fu">read_excel</span>(<span class="st">"filename.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="実践データの読み込み-2" class="slide level2">
<h2>実践：データの読み込み</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>CSVエディタの勧め</strong></p>
</div>
<div class="callout-content">
<ul>
<li>CSVファイルは、単純なテキスト形式のデータです</li>
<li>Microsoft Excel で開くと、CP932形式（Shift_JIS）となります。日付や数値の形式が自動で変わってしまうことがあります</li>
<li>データを正確に扱いたい場合は、専用のCSVエディタやテキストエディタの使用をお勧めします</li>
</ul>
</div>
</div>
</div>
<ul>
<li><a href="https://www.moderncsv.com/download/">Modern CSV</a>
<ul>
<li>Windows / macOS / Windows Portable / Linux</li>
<li>基本的な操作は無償版でも十分可能</li>
</ul></li>
</ul>
</section>
<section id="実践データの結合oecd加盟国の人口100万人あたりの議員数" class="slide level2">
<h2>実践：データの結合（OECD加盟国の人口100万人あたりの議員数）</h2>
<h3 id="データの結合">データの結合</h3>
<ul>
<li>別種のデータを結合したい場合
<ul>
<li>列方向の結合：<em>left_join()</em> * 今回はleft_joinを試します</li>
<li>行方向の結合：bind_rows()</li>
</ul></li>
</ul>
<ol type="1">
<li><a href="https://drive.google.com/drive/folders/1wnDIsrXeNYKyuCATx71JyVPR9ujmip3G?usp=sharing">Google Drive</a>からファイルをダウンロード（出所<sup>1</sup><sup>2</sup>）</li>
<li>dataフォルダに保存</li>
<li>次のページのコードを写して、実行</li>
</ol>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>left_join() は、<em>共通のカラム名（キー）をもとに2つのデータを結合する関数</em>です。それぞれのファイルでカラム名が異なる場合は、renameする必要があります。次のコードでは、select()関数やrename()関数で、カラム名をrenameしています）</p>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn4"><p>United Nations, <a href="https://population.un.org/wpp/downloads?folder=Standard%20Projections&amp;group=Population">World Population Prospects 2024</a></p></li><li id="fn5"><p>Parline, <a href="https://data.ipu.org/data-explorer/?fields=country_name,chamber_name,not_directly_elected,compulsory_voting,number_of_members.total,number_of_members.gender&amp;current_page=2&amp;per_page=500&amp;date=2025-10-01&amp;sort=country_name">Data explorer</a></p></li></ol></aside></section>
<section id="実践データの結合oecd加盟国の人口100万人あたりの議員数-1" class="slide level2">
<h2>実践：データの結合（OECD加盟国の人口100万人あたりの議員数）</h2>
<div class="panel-tabset">
<ul id="tabset-8" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-8-1">Code</a></li><li><a href="#tabset-8-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a><span class="do">## 前処理（Setup Chunk）に書くべき</span></span>
<span id="cb40-2"><a></a></span>
<span id="cb40-3"><a></a>df_parline <span class="ot">&lt;-</span> </span>
<span id="cb40-4"><a></a>  <span class="fu">read_csv</span>(<span class="st">"data/parliaments.csv"</span>, <span class="at">skip =</span> <span class="dv">15</span>) <span class="co"># 冒頭から15行目まではメタデータ（ヘッダーコメント ）なので読み込まない</span></span>
<span id="cb40-5"><a></a></span>
<span id="cb40-6"><a></a>df_population <span class="ot">&lt;-</span> <span class="co"># ファイルが大きい（220.3MB）ため、重い処理かもしれない</span></span>
<span id="cb40-7"><a></a>  <span class="fu">read_excel</span>(<span class="st">"data/population.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">skip =</span> <span class="dv">16</span>) <span class="sc">|&gt;</span> <span class="co"># excelファイルはシートを指定できる</span></span>
<span id="cb40-8"><a></a>  <span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Country/Area"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-9"><a></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb40-10"><a></a>  <span class="fu">rename</span>(<span class="at">country =</span> <span class="st">`</span><span class="at">Region, subregion, country or area *</span><span class="st">`</span>) <span class="co"># rename()でカラム名を変更</span></span>
<span id="cb40-11"><a></a></span>
<span id="cb40-12"><a></a>oecd_ISOcode <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb40-13"><a></a>  <span class="st">"AU"</span>, <span class="st">"AT"</span>, <span class="st">"BE"</span>, <span class="st">"CA"</span>, <span class="st">"CL"</span>, <span class="st">"CO"</span>, <span class="st">"CR"</span>, <span class="st">"CZ"</span>, <span class="st">"DK"</span>, <span class="st">"EE"</span>, <span class="st">"FI"</span>, <span class="st">"FR"</span>,</span>
<span id="cb40-14"><a></a>  <span class="st">"DE"</span>, <span class="st">"GR"</span>, <span class="st">"HU"</span>, <span class="st">"IS"</span>, <span class="st">"IE"</span>, <span class="st">"IL"</span>, <span class="st">"IT"</span>, <span class="st">"JP"</span>, <span class="st">"KR"</span>, <span class="st">"LV"</span>, <span class="st">"LT"</span>, <span class="st">"LU"</span>,</span>
<span id="cb40-15"><a></a>  <span class="st">"MX"</span>, <span class="st">"NL"</span>, <span class="st">"NZ"</span>, <span class="st">"NO"</span>, <span class="st">"PL"</span>, <span class="st">"PT"</span>, <span class="st">"SK"</span>, <span class="st">"SI"</span>, <span class="st">"ES"</span>, <span class="st">"SE"</span>, <span class="st">"CH"</span>, <span class="st">"TR"</span>,</span>
<span id="cb40-16"><a></a>  <span class="st">"GB"</span>, <span class="st">"US"</span></span>
<span id="cb40-17"><a></a>)</span>
<span id="cb40-18"><a></a></span>
<span id="cb40-19"><a></a>oecd_countries <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb40-20"><a></a>  <span class="st">"Australia"</span>, <span class="st">"Austria"</span>, <span class="st">"Belgium"</span>, <span class="st">"Canada"</span>, <span class="st">"Chile"</span>, <span class="st">"Colombia"</span>,</span>
<span id="cb40-21"><a></a>  <span class="st">"Czech Republic"</span>, <span class="st">"Denmark"</span>, <span class="st">"Estonia"</span>, <span class="st">"Finland"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>,</span>
<span id="cb40-22"><a></a>  <span class="st">"Greece"</span>, <span class="st">"Hungary"</span>, <span class="st">"Iceland"</span>, <span class="st">"Ireland"</span>, <span class="st">"Israel"</span>, <span class="st">"Italy"</span>, <span class="st">"Japan"</span>,</span>
<span id="cb40-23"><a></a>  <span class="st">"Korea"</span>, <span class="st">"Latvia"</span>, <span class="st">"Lithuania"</span>, <span class="st">"Luxembourg"</span>, <span class="st">"Mexico"</span>, <span class="st">"Netherlands"</span>,</span>
<span id="cb40-24"><a></a>  <span class="st">"New Zealand"</span>, <span class="st">"Norway"</span>, <span class="st">"Poland"</span>, <span class="st">"Portugal"</span>, <span class="st">"Slovak Republic"</span>, <span class="st">"Slovenia"</span>,</span>
<span id="cb40-25"><a></a>  <span class="st">"Spain"</span>, <span class="st">"Sweden"</span>, <span class="st">"Switzerland"</span>, <span class="st">"Turkey"</span>, <span class="st">"United Kingdom"</span>, <span class="st">"United States of America"</span>, <span class="st">"Republic of Korea"</span></span>
<span id="cb40-26"><a></a>)</span>
<span id="cb40-27"><a></a></span>
<span id="cb40-28"><a></a>df_parline_oecd <span class="ot">&lt;-</span> </span>
<span id="cb40-29"><a></a>df_parline <span class="sc">|&gt;</span> </span>
<span id="cb40-30"><a></a>    <span class="fu">filter</span>(<span class="st">`</span><span class="at">ISO Code</span><span class="st">`</span> <span class="sc">%in%</span> oecd_ISOcode) <span class="co"># %in% は複数の値をフィルタリングする際に使用〔特定の値の場合は==〕</span></span>
<span id="cb40-31"><a></a></span>
<span id="cb40-32"><a></a>df_parline_oecd <span class="ot">&lt;-</span> </span>
<span id="cb40-33"><a></a>  df_parline_oecd <span class="sc">|&gt;</span> </span>
<span id="cb40-34"><a></a>  <span class="co"># selectは文字通り列を選択する関数だが、選択する列名の前に「任意の名前 = カラム名」と書くことで、選択と列名の変更を同時に行うことができて便利</span></span>
<span id="cb40-35"><a></a>  <span class="fu">select</span>(<span class="at">country =</span> Country, <span class="at">statutory_number =</span> <span class="st">`</span><span class="at">Statutory number of members</span><span class="st">`</span>)</span>
<span id="cb40-36"><a></a></span>
<span id="cb40-37"><a></a>df_population_oecd <span class="ot">&lt;-</span> </span>
<span id="cb40-38"><a></a>  df_population <span class="sc">|&gt;</span> </span>
<span id="cb40-39"><a></a>      <span class="fu">filter</span>(country <span class="sc">%in%</span> oecd_countries)</span>
<span id="cb40-40"><a></a></span>
<span id="cb40-41"><a></a>df_population_oecd <span class="ot">&lt;-</span> </span>
<span id="cb40-42"><a></a>  df_population_oecd <span class="sc">|&gt;</span> </span>
<span id="cb40-43"><a></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">100+</span><span class="st">`</span>, as.numeric)) <span class="sc">|&gt;</span> <span class="co"># 年齢に関する列がすべて文字列として認識されているため、across()で指定した列（0〜100+）をまとめて as.numeric() に変換する</span></span>
<span id="cb40-44"><a></a>  <span class="fu">mutate</span>(<span class="at">TotalPopulation =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">100+</span><span class="st">`</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> <span class="co"># 年齢ごとの列（0歳〜100歳以上）の値をすべて足し合わせ、その合計を新しい列「TotalPopulation」に追加（欠損地は除外）</span></span>
<span id="cb40-45"><a></a>  <span class="fu">select</span>(country, TotalPopulation) <span class="sc">|&gt;</span> </span>
<span id="cb40-46"><a></a>  <span class="fu">mutate</span>(<span class="at">TotalPopulation =</span> <span class="fu">round</span>(TotalPopulation)) <span class="co"># TotalPopulation列の値を四捨五入して、整数に。結果は同じ列名TotalPopulation に上書き</span></span>
<span id="cb40-47"><a></a></span>
<span id="cb40-48"><a></a>df_pop_par <span class="ot">&lt;-</span></span>
<span id="cb40-49"><a></a>  df_population_oecd <span class="sc">|&gt;</span> <span class="co"># df_population_oecdをベースに、df_parline_oecdを結合</span></span>
<span id="cb40-50"><a></a>  <span class="fu">left_join</span>(df_parline_oecd, <span class="at">by =</span> <span class="st">"country"</span>) <span class="co"># countryをキーに</span></span>
<span id="cb40-51"><a></a></span>
<span id="cb40-52"><a></a><span class="do">## 個別チャンク</span></span>
<span id="cb40-53"><a></a></span>
<span id="cb40-54"><a></a>df_pop_par <span class="sc">|&gt;</span> </span>
<span id="cb40-55"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-56"><a></a>    <span class="at">statutory_number =</span> <span class="fu">as.numeric</span>(statutory_number),</span>
<span id="cb40-57"><a></a>    <span class="at">member_per_million =</span> statutory_number <span class="sc">/</span> (TotalPopulation <span class="sc">/</span> <span class="dv">1000</span>),</span>
<span id="cb40-58"><a></a>    <span class="at">member_per_million =</span> <span class="fu">round</span>(member_per_million, <span class="dv">2</span>)</span>
<span id="cb40-59"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb40-60"><a></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(member_per_million)) <span class="sc">|&gt;</span> </span>
<span id="cb40-61"><a></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">factor</span>(country, <span class="at">levels =</span> country)) <span class="sc">|&gt;</span> <span class="co"># 上記の順序で並べる（未指定だとアルファベット順に）</span></span>
<span id="cb40-62"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(country, member_per_million), </span>
<span id="cb40-63"><a></a>             <span class="at">y =</span> member_per_million)) <span class="sc">+</span> <span class="co"># fct_reorder() で棒グラフの順序をデータに合わせて並べ替え（未指定だと、逆順になる。ggplotの仕様）</span></span>
<span id="cb40-64"><a></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"#a0564d"</span>) <span class="sc">+</span> </span>
<span id="cb40-65"><a></a>  <span class="fu">geom_text</span>(                                     <span class="co"># 値を図に加える</span></span>
<span id="cb40-66"><a></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">glue</span>(<span class="st">"{member_per_million}人"</span>)), <span class="co"># 値に「人」を足す</span></span>
<span id="cb40-67"><a></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb40-68"><a></a>    <span class="at">size =</span> <span class="fl">3.0</span></span>
<span id="cb40-69"><a></a>  ) <span class="sc">+</span></span>
<span id="cb40-70"><a></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">180</span>) <span class="sc">+</span> <span class="co"># Icelandの値がはみ出るため、x軸を180に</span></span>
<span id="cb40-71"><a></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb40-72"><a></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="dv">30</span>),</span>
<span id="cb40-73"><a></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb40-74"><a></a>  ) <span class="sc">+</span></span>
<span id="cb40-75"><a></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="co"># x軸とy軸を入れ替える</span></span>
<span id="cb40-76"><a></a>  <span class="fu">labs</span>(</span>
<span id="cb40-77"><a></a>    <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb40-78"><a></a>    <span class="at">y =</span> <span class="st">"人口100万人あたりの下院議員定数"</span>,</span>
<span id="cb40-79"><a></a>  ) <span class="sc">+</span></span>
<span id="cb40-80"><a></a>  <span class="fu">theme</span>(</span>
<span id="cb40-81"><a></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>) <span class="co"># y軸のラベル名を左揃え（デフォルトは中央揃え）</span></span>
<span id="cb40-82"><a></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-48-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践縦持ち横持ち金沢広域急病センター利用者数" class="slide level2">
<h2>実践：縦持ち・横持ち（金沢広域急病センター利用者数）</h2>
<h3 id="データを読み込む">データを読み込む</h3>
<ol type="1">
<li><a href="https://drive.google.com/drive/folders/1wnDIsrXeNYKyuCATx71JyVPR9ujmip3G?usp=sharing">Google Drive</a>からファイルをダウンロード（出所<sup>1</sup>）</li>
<li>dataフォルダに保存</li>
</ol>
<ul>
<li>以下のコードは、全てのR Chunkで使うことを想定するものなので、本来はSetup Chunkに書くことが望ましい</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a></a>df_hospital <span class="ot">&lt;-</span> </span>
<span id="cb41-2"><a></a>  <span class="fu">read_csv</span>(<span class="st">"data/kanazawaemergencycenter_users.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-4"><a></a>    曜日 <span class="ot">=</span> <span class="fu">factor</span>(曜日, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"月"</span>, <span class="st">"火"</span>, <span class="st">"水"</span>, <span class="st">"木"</span>, <span class="st">"金"</span>, <span class="st">"土"</span>, <span class="st">"日"</span>)) <span class="co"># 曜日順に並べるための処理</span></span>
<span id="cb41-5"><a></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside><ol class="aside-footnotes"><li id="fn6"><p><a href="https://catalog-data.city.kanazawa.ishikawa.jp/dataset/172014-kouikikyubyocenter_riyousyasuu/resource/246ad33b-8141-4672-b5ec-f6e52ae4263b">ckan: 金沢市 &gt; 金沢広域急病センター利用者数</a></p></li></ol></aside></section>
<section id="実践縦持ち横持ち金沢広域急病センター利用者数-1" class="slide level2">
<h2>実践：縦持ち・横持ち（金沢広域急病センター利用者数）</h2>
<h3 id="データの確認横持ちデータ">データの確認：横持ちデータ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a>df_hospital <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  日付      曜日  土日祝 小児科  内科    計
  &lt;chr&gt;     &lt;fct&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 2018/4/9  月         0      8     6    14
2 2018/4/10 火         0     13     6    19
3 2018/4/11 水         0     17     4    21</code></pre>
</div>
</div>
<ul>
<li>小児科/内科が<em>別の列になっている</em>ことを確認</li>
<li>「専門」というカラムがあり、そこに「小児科/内科」という値が入っていると便利なのにな・・・
<ul>
<li>pivot_longer()関数で、「専門」というカラムを作る</li>
</ul></li>
</ul>
</section>
<section id="実践縦持ち横持ち金沢広域急病センター利用者数-2" class="slide level2">
<h2>実践：縦持ち・横持ち（金沢広域急病センター利用者数）</h2>
<h3 id="データの変換横持ちデータから縦持ちデータへ">データの変換：横持ちデータから縦持ちデータへ</h3>
<ul>
<li>pivot_longer()関数</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44" data-code-line-numbers="3-7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a></a>df_hospital_long <span class="ot">&lt;-</span> </span>
<span id="cb44-2"><a></a>  df_hospital <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb44-4"><a></a>    <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">"小児科"</span>, <span class="st">"内科"</span>), <span class="co"># もとのカラム名（新たに縦にまとめたい列）</span></span>
<span id="cb44-5"><a></a>    <span class="at">names_to =</span> <span class="st">"専門"</span>, <span class="co"># 新しく作りたいカラム名1：もとのカラム名（小児科・内科）が入る列</span></span>
<span id="cb44-6"><a></a>    <span class="at">values_to =</span> <span class="st">"利用者数"</span> <span class="co"># 新しく作りたいカラム名2：もとの値（人数）が入る列</span></span>
<span id="cb44-7"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-9"><a></a>    専門 <span class="ot">=</span> <span class="fu">factor</span>(専門, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"内科"</span>, <span class="st">"小児科"</span>)) <span class="co"># 水準（順序付き）にする</span></span>
<span id="cb44-10"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb44-11"><a></a>  <span class="fu">select</span>(日付, 曜日, 土日祝, 専門, 利用者数) <span class="sc">|&gt;</span> </span>
<span id="cb44-12"><a></a>  <span class="fu">mutate</span>(日付 <span class="ot">=</span> <span class="fu">as.POSIXct</span>(日付), <span class="co"># 日付をデータの型が「date」になるように変形</span></span>
<span id="cb44-13"><a></a>         日付 <span class="ot">=</span> <span class="fu">as.Date</span>(日付))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="実践縦持ち横持ち金沢広域急病センター利用者数-3" class="slide level2">
<h2>実践：縦持ち・横持ち（金沢広域急病センター利用者数）</h2>
<h3 id="縦持ちデータカラム専門の活用">縦持ちデータ（カラム「専門」）の活用</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a>df_hospital_long <span class="sc">|&gt;</span>  </span>
<span id="cb45-2"><a></a>    <span class="fu">group_by</span>(曜日, 専門) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a></a>    <span class="fu">summarise</span>(</span>
<span id="cb45-4"><a></a>      利用者数_曜日 <span class="ot">=</span> <span class="fu">sum</span>(利用者数)</span>
<span id="cb45-5"><a></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> 曜日, <span class="at">y =</span> 利用者数_曜日, <span class="at">fill =</span> 専門)) <span class="sc">+</span></span>
<span id="cb45-7"><a></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-52-1.png" width="960" class="r-stretch"></section>
<section id="実践比べられる図比例代表得票数" class="slide level2">
<h2>実践：比べられる図（比例代表得票数）</h2>
<ol type="1">
<li><a href="https://drive.google.com/drive/folders/1wnDIsrXeNYKyuCATx71JyVPR9ujmip3G?usp=sharing">Google Drive</a>からファイルをダウンロード（出所<sup>1</sup>）</li>
<li>dataフォルダに保存</li>
</ol>
<ul>
<li>以下のコードは、全てのR Chunkで使うことを想定するものなので、本来はSetup Chunkに書くことが望ましい</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a></a>df_pr_parties_2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hr2021_pr_parties.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a></a>  <span class="fu">mutate</span>(, <span class="at">.before =</span> block,</span>
<span id="cb46-3"><a></a>         <span class="at">year =</span> <span class="dv">2021</span></span>
<span id="cb46-4"><a></a>  ) </span>
<span id="cb46-5"><a></a></span>
<span id="cb46-6"><a></a>df_pr_parties_2024 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/hr2024_pr_parties.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-7"><a></a>  <span class="fu">mutate</span>(, <span class="at">.before =</span> block,</span>
<span id="cb46-8"><a></a>         <span class="at">year =</span> <span class="dv">2024</span></span>
<span id="cb46-9"><a></a>  )</span>
<span id="cb46-10"><a></a>  </span>
<span id="cb46-11"><a></a>df_pr_parties <span class="ot">&lt;-</span> </span>
<span id="cb46-12"><a></a>  <span class="fu">bind_rows</span>(df_pr_parties_2021, df_pr_parties_2024) <span class="sc">|&gt;</span> <span class="co"># 上記の二つのオブジェクトを結合します</span></span>
<span id="cb46-13"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-14"><a></a>    <span class="at">block =</span> <span class="fu">factor</span>(block, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"北海道"</span>, <span class="st">"東北"</span>, <span class="st">"北関東"</span>, <span class="st">"南関東"</span>, <span class="st">"東京"</span>, <span class="st">"北陸信越"</span>, <span class="st">"東海"</span>, <span class="st">"近畿"</span>, <span class="st">"中国"</span>, <span class="st">"四国"</span>, <span class="st">"九州"</span>)) <span class="co"># factorにして、レベル（順序）を指定します</span></span>
<span id="cb46-15"><a></a>  )</span>
<span id="cb46-16"><a></a></span>
<span id="cb46-17"><a></a>主要政党 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"自由民主党"</span>, <span class="st">"立憲民主党"</span>, <span class="st">"公明党"</span>, <span class="st">"国民民主党"</span>, <span class="st">"日本維新の会"</span>, <span class="st">"日本共産党"</span>, <span class="st">"社会民主党"</span>, <span class="st">"れいわ新選組"</span>, <span class="st">"参政党"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<aside><ol class="aside-footnotes"><li id="fn7"><p><a href="https://yukiyanai.github.io/jp/resources/data/hr2021_pr_parties.csv">Yuki Yanai</a>）</p></li></ol></aside></section>
<section id="実践比べられる図比例代表得票数-1" class="slide level2">
<h2>実践：比べられる図（比例代表得票数）</h2>
<h3 id="衆議院議員選挙-比例代表得票数2021-vs.-2024">衆議院議員選挙 比例代表得票数：2021 vs.&nbsp;2024</h3>
<div class="panel-tabset">
<ul id="tabset-9" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-9-1">Code</a></li><li><a href="#tabset-9-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a>df_pr_parties <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a></a>  <span class="fu">group_by</span>(year, party) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a></a>  <span class="fu">summarise</span>(</span>
<span id="cb47-4"><a></a>    <span class="at">votes =</span> <span class="fu">sum</span>(votes)</span>
<span id="cb47-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb47-7"><a></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> 主要政党) <span class="sc">|&gt;</span></span>
<span id="cb47-8"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-9"><a></a>    <span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"自由民主党"</span>, <span class="st">"立憲民主党"</span>, <span class="st">"公明党"</span>, <span class="st">"国民民主党"</span>, <span class="st">"日本維新の会"</span>, <span class="st">"日本共産党"</span>, <span class="st">"社会民主党"</span>, <span class="st">"れいわ新選組"</span>, <span class="st">"参政党"</span>))</span>
<span id="cb47-10"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb47-11"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> party, <span class="at">y =</span> votes, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span> <span class="co"># yearをfactorにします（標準では数字です）</span></span>
<span id="cb47-12"><a></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="co"># 棒グラフを横並びにする</span></span>
<span id="cb47-13"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> zipangu<span class="sc">::</span><span class="fu">label_kansuji</span>()) <span class="sc">+</span> <span class="co"># y軸のラベルをわかりやすくします（zipanguパッケージ要）</span></span>
<span id="cb47-14"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"得票数"</span>, <span class="at">fill =</span> <span class="st">"年"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-55-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践比べられる図比例代表得票数-2" class="slide level2">
<h2>実践：比べられる図（比例代表得票数）</h2>
<h3 id="衆議院議員選挙-比例代表得票率2021-vs.-2024">衆議院議員選挙 比例代表得票率：2021 vs.&nbsp;2024</h3>
<div class="panel-tabset">
<ul id="tabset-10" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-10-1">Code</a></li><li><a href="#tabset-10-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a></a>df_pr_parties <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a></a>  <span class="fu">group_by</span>(year, party) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a></a>  <span class="fu">summarise</span>(<span class="at">votes =</span> <span class="fu">sum</span>(votes), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> 主要政党) <span class="sc">|&gt;</span> </span>
<span id="cb48-5"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-6"><a></a>    <span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb48-7"><a></a>      <span class="st">"自由民主党"</span>, <span class="st">"立憲民主党"</span>, <span class="st">"公明党"</span>, <span class="st">"国民民主党"</span>, </span>
<span id="cb48-8"><a></a>      <span class="st">"日本維新の会"</span>, <span class="st">"日本共産党"</span>, <span class="st">"社会民主党"</span>, <span class="st">"れいわ新選組"</span>, <span class="st">"参政党"</span></span>
<span id="cb48-9"><a></a>    )),</span>
<span id="cb48-10"><a></a>    <span class="at">prop =</span> votes <span class="sc">/</span> <span class="fu">sum</span>(votes)  <span class="co"># 各年で割合を計算</span></span>
<span id="cb48-11"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb48-12"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(year), <span class="at">y =</span> votes, <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb48-13"><a></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb48-14"><a></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(prop, <span class="at">accuracy =</span> <span class="dv">1</span>)),</span>
<span id="cb48-15"><a></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="co"># 割合を中央に表示</span></span>
<span id="cb48-16"><a></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb48-17"><a></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))) <span class="sc">+</span> <span class="co"># 左右のマージンを詰める</span></span>
<span id="cb48-18"><a></a>  <span class="fu">scale_fill_paletteer_d</span>(<span class="st">"miscpalettes::brightPastel"</span>) <span class="sc">+</span> <span class="co"># 配色を変える</span></span>
<span id="cb48-19"><a></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"年"</span>, <span class="at">y =</span> <span class="st">"得票の割合"</span>, <span class="at">fill =</span> <span class="st">"政党"</span>) <span class="sc">+</span></span>
<span id="cb48-20"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span> <span class="co"># 凡例を下に移動</span></span>
<span id="cb48-21"><a></a>  <span class="fu">coord_flip</span>() <span class="co"># 横向きに変える</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-57-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="実践練習問題" class="slide level2">
<h2>実践：練習問題</h2>
<ul>
<li>OECD加盟国の人口100万人あたりの議員数で用いた二つのデータを使って（population.xlsx; parliaments.csv）、以下の指示に従った図を作図して下さい。作図にあたっては、（ワンコードで書ける分量ですが）、一旦、オブジェクトを作成して、それをggplotに渡して下さい</li>
</ul>
<ol type="1">
<li>G7各国のみにデータを絞る</li>
<li>65歳以上のデータを抽出する</li>
<li>棒グラフを作図する</li>
<li>全人口の図と比較する</li>
<li>（時間が余った人のみ）18歳未満のデータで同じことをしてみましょう</li>
</ol>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>既存のコードを有効に活用しよう / （処理が複雑になっています）変数名、オブジェクト名をわかりやすく付けよう</p>
</div>
</div>
</div>
<!-- ## 実践：練習問題 -->
<!-- - ここでは出力結果を見比べるために、ggplotの出力結果をオブジェクトに格納して、patchworkパッケージを使って並べています -->
</section></section>
<section>
<section id="発展編rを使いこなそうスクレーピングmap関数ほか" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅵ. 《発展編》Rを使いこなそう：スクレーピング・map()関数ほか</h1>

</section>
<section id="発展pdfからテキストを抽出する" class="slide level2">
<h2>発展：PDFからテキストを抽出する</h2>
<ul>
<li>別途、pdftoolsをインストールして下さい</li>
<li>以下のコードでは、pdftools パッケージで PDF からテキストを読み取り、stringr パッケージの関数を使って特定の文字（例：改行コード）を置換しています。stringr は tidyverse に含まれるパッケージです</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-11" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-11-1">Code</a></li><li><a href="#tabset-11-2">Print</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a></a><span class="fu">library</span>(pdftools)</span>
<span id="cb49-2"><a></a></span>
<span id="cb49-3"><a></a><span class="co"># PDFファイルを読み込む</span></span>
<span id="cb49-4"><a></a>text <span class="ot">&lt;-</span> <span class="fu">pdf_text</span>(<span class="st">"data/sample.pdf"</span>)</span>
<span id="cb49-5"><a></a></span>
<span id="cb49-6"><a></a><span class="co"># \n を空文字に置換</span></span>
<span id="cb49-7"><a></a>text_clean <span class="ot">&lt;-</span> text <span class="sc">|&gt;</span></span>
<span id="cb49-8"><a></a>  <span class="fu">str_replace_all</span>(<span class="st">"[</span><span class="sc">\n</span><span class="st">]+"</span>, <span class="st">" "</span>) <span class="sc">|&gt;</span>    <span class="co"># 改行を空白に</span></span>
<span id="cb49-9"><a></a>  <span class="fu">str_replace_all</span>(<span class="st">"[ ]{2,}"</span>, <span class="st">" "</span>)     <span class="co"># 連続空白を1つに</span></span>
<span id="cb49-10"><a></a></span>
<span id="cb49-11"><a></a>text_clean <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-11-2">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>1 # Lorem 2 3 &gt; Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui oﬃcia deserunt mollit anim id est laborum. </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="発展スクレーピング総理の演説記者会見など" class="slide level2">
<h2>発展：スクレーピング（「総理の演説・記者会見など」）</h2>
<ul>
<li>首相官邸に掲載されている<a href="https://www.kantei.go.jp/jp/103/statement/index.html">石破首相の「総理の演説・記者会見など」</a>を一括取得し、speech_ishiba.<em>rds</em>として書き出す</li>
</ul>
<h3 id="拡張子rds">拡張子rds</h3>
<ul>
<li>Rで作ったデータ（データフレームなど）をそのままの形で保存できる専用のファイル形式</li>
<li><strong>利点</strong>：高速に読み書きできる / すべて正確に保持される（列の型（文字・数値・日付など）や因子レベルなどをそのまま保持する）</li>
</ul>
<h3 id="スクレーピングパッケージ">スクレーピングパッケージ</h3>
<ul>
<li>httr2（ページを取得する）; xml2（ページの中身を読む）；rvest（必要なデータを取り出す）</li>
</ul>
</section>
<section id="発展スクレーピング総理の演説記者会見など-1" class="slide level2">
<h2>発展：スクレーピング（「総理の演説・記者会見など」）</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a></a><span class="co"># 「関数定義」「URL収集」「本文抽出」「整形・保存」ごとにchunkを分ける方がいいが、ここでは一つのチャンクで書く</span></span>
<span id="cb51-2"><a></a></span>
<span id="cb51-3"><a></a><span class="co"># --- indexページから記事URLを抽出 ---</span></span>
<span id="cb51-4"><a></a>get_article_urls <span class="ot">&lt;-</span> <span class="cf">function</span>(page_url) {</span>
<span id="cb51-5"><a></a>  req <span class="ot">&lt;-</span> <span class="fu">request</span>(page_url) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb51-6"><a></a>  html <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(req)</span>
<span id="cb51-7"><a></a>  </span>
<span id="cb51-8"><a></a>  hrefs <span class="ot">&lt;-</span> html <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"a"</span>) <span class="sc">|&gt;</span> <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb51-9"><a></a>  relative_urls <span class="ot">&lt;-</span> hrefs[<span class="fu">str_detect</span>(hrefs, <span class="st">"^/jp/(102_ishiba|103)/statement/</span><span class="sc">\\</span><span class="st">d{4}/</span><span class="sc">\\</span><span class="st">d{4}.*</span><span class="sc">\\</span><span class="st">.html$"</span>)]</span>
<span id="cb51-10"><a></a>  </span>
<span id="cb51-11"><a></a>  <span class="fu">paste0</span>(<span class="st">"https://www.kantei.go.jp"</span>, <span class="fu">unique</span>(<span class="fu">na.omit</span>(relative_urls)))</span>
<span id="cb51-12"><a></a>}</span>
<span id="cb51-13"><a></a></span>
<span id="cb51-14"><a></a><span class="co"># ベースURLから全indexページを収集</span></span>
<span id="cb51-15"><a></a>collect_all_article_urls <span class="ot">&lt;-</span> <span class="cf">function</span>(base_urls) {</span>
<span id="cb51-16"><a></a>  all_index_pages <span class="ot">&lt;-</span> <span class="fu">map</span>(base_urls, <span class="cf">function</span>(base) {</span>
<span id="cb51-17"><a></a>    resp <span class="ot">&lt;-</span> <span class="fu">request</span>(base) <span class="sc">|&gt;</span> <span class="fu">req_perform</span>()</span>
<span id="cb51-18"><a></a>    html <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(resp)</span>
<span id="cb51-19"><a></a>    archive_links <span class="ot">&lt;-</span> html <span class="sc">|&gt;</span> <span class="fu">html_elements</span>(<span class="st">"a"</span>) <span class="sc">|&gt;</span> <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb51-20"><a></a>    archive_links <span class="ot">&lt;-</span> archive_links[<span class="fu">str_detect</span>(archive_links, <span class="st">"statement/index_</span><span class="sc">\\</span><span class="st">d{4}</span><span class="sc">\\</span><span class="st">.html$"</span>)]</span>
<span id="cb51-21"><a></a>    archive_links <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"https://www.kantei.go.jp"</span>, archive_links)</span>
<span id="cb51-22"><a></a>    <span class="fu">c</span>(base, archive_links)</span>
<span id="cb51-23"><a></a>  }) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb51-24"><a></a>  </span>
<span id="cb51-25"><a></a>  <span class="co"># 各indexページから記事URLとデータを取得</span></span>
<span id="cb51-26"><a></a>  article_urls <span class="ot">&lt;-</span> <span class="fu">map</span>(all_index_pages, get_article_urls) <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb51-27"><a></a>  <span class="fu">message</span>(<span class="st">"取得した記事数: "</span>, <span class="fu">length</span>(article_urls))</span>
<span id="cb51-28"><a></a>  article_urls</span>
<span id="cb51-29"><a></a>}</span>
<span id="cb51-30"><a></a></span>
<span id="cb51-31"><a></a>base_urls <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb51-32"><a></a>  <span class="st">"https://www.kantei.go.jp/jp/102_ishiba/statement/index.html"</span>,</span>
<span id="cb51-33"><a></a>  <span class="st">"https://www.kantei.go.jp/jp/103/statement/index.html"</span></span>
<span id="cb51-34"><a></a>)</span>
<span id="cb51-35"><a></a></span>
<span id="cb51-36"><a></a>article_urls <span class="ot">&lt;-</span> <span class="fu">collect_all_article_urls</span>(base_urls)</span>
<span id="cb51-37"><a></a></span>
<span id="cb51-38"><a></a>articles_info <span class="ot">&lt;-</span> <span class="fu">map</span>(article_urls, extract_article_info) <span class="sc">|&gt;</span> <span class="co"># extract_article_info()関数が個々の article_url にアクセスして 記事の本文や日付などを取得</span></span>
<span id="cb51-39"><a></a>  <span class="fu">compact</span>() <span class="co"># リストからNULLの要素を取り除く</span></span>
<span id="cb51-40"><a></a></span>
<span id="cb51-41"><a></a><span class="co"># 整形</span></span>
<span id="cb51-42"><a></a>df_articles <span class="ot">&lt;-</span> </span>
<span id="cb51-43"><a></a>  <span class="fu">bind_rows</span>(articles_info) <span class="sc">|&gt;</span></span>
<span id="cb51-44"><a></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">convert_jdate</span>(date)) <span class="sc">|&gt;</span> <span class="co"># zipangu パッケージの関数。和暦の日付（例：令和○年○月○日）をDate型に変換</span></span>
<span id="cb51-45"><a></a>  <span class="fu">arrange</span>(date) <span class="co"># date列で並び替え</span></span>
<span id="cb51-46"><a></a></span>
<span id="cb51-47"><a></a><span class="co"># 保存</span></span>
<span id="cb51-48"><a></a><span class="fu">saveRDS</span>(df_articles, <span class="st">"speech_ishiba.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="発展スクレーピング総理の演説記者会見など-2" class="slide level2">
<h2>発展：スクレーピング（「総理の演説・記者会見など」）</h2>
<ul>
<li>head()でデータを確認</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a></a>df_ishiba <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/speech_ishiba.rds"</span>)</span>
<span id="cb52-2"><a></a></span>
<span id="cb52-3"><a></a>df_ishiba<span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  title                              date       paragraph                  url  
  &lt;chr&gt;                              &lt;date&gt;     &lt;chr&gt;                      &lt;chr&gt;
1 石破内閣総理大臣記者会見           2024-10-01 【石破総理冒頭発言】 第１０２代内閣総理大臣に指名… http…
2 Ｇ７首脳電話会議出席についての会見 2024-10-02 先ほど緊迫する中東情勢を受けまして、私にとりまして… http…</code></pre>
</div>
</div>
<ul>
<li>gt()で本文を確認（スペースの都合）</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a></a>df_ishiba<span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a></a>  <span class="fu">filter</span>(</span>
<span id="cb54-3"><a></a>    title <span class="sc">==</span> <span class="st">"石破内閣総理大臣記者会見"</span>,</span>
<span id="cb54-4"><a></a>    date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2024-10-09"</span>)</span>
<span id="cb54-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a></a>  <span class="fu">mutate</span>(<span class="at">paragraph =</span> <span class="fu">substr</span>(paragraph, <span class="dv">1</span>, <span class="dv">50</span>)) <span class="sc">|&gt;</span></span>
<span id="cb54-7"><a></a>  <span class="fu">select</span>(paragraph) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="wsnelvjzsc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wsnelvjzsc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wsnelvjzsc thead, #wsnelvjzsc tbody, #wsnelvjzsc tfoot, #wsnelvjzsc tr, #wsnelvjzsc td, #wsnelvjzsc th {
  border-style: none;
}

#wsnelvjzsc p {
  margin: 0;
  padding: 0;
}

#wsnelvjzsc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wsnelvjzsc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wsnelvjzsc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wsnelvjzsc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wsnelvjzsc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wsnelvjzsc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wsnelvjzsc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wsnelvjzsc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wsnelvjzsc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wsnelvjzsc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wsnelvjzsc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wsnelvjzsc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wsnelvjzsc .gt_spanner_row {
  border-bottom-style: hidden;
}

#wsnelvjzsc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wsnelvjzsc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wsnelvjzsc .gt_from_md > :first-child {
  margin-top: 0;
}

#wsnelvjzsc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wsnelvjzsc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wsnelvjzsc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wsnelvjzsc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wsnelvjzsc .gt_row_group_first td {
  border-top-width: 2px;
}

#wsnelvjzsc .gt_row_group_first th {
  border-top-width: 2px;
}

#wsnelvjzsc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wsnelvjzsc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wsnelvjzsc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wsnelvjzsc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wsnelvjzsc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wsnelvjzsc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wsnelvjzsc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wsnelvjzsc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wsnelvjzsc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wsnelvjzsc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wsnelvjzsc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wsnelvjzsc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wsnelvjzsc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wsnelvjzsc .gt_left {
  text-align: left;
}

#wsnelvjzsc .gt_center {
  text-align: center;
}

#wsnelvjzsc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wsnelvjzsc .gt_font_normal {
  font-weight: normal;
}

#wsnelvjzsc .gt_font_bold {
  font-weight: bold;
}

#wsnelvjzsc .gt_font_italic {
  font-style: italic;
}

#wsnelvjzsc .gt_super {
  font-size: 65%;
}

#wsnelvjzsc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wsnelvjzsc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wsnelvjzsc .gt_indent_1 {
  text-indent: 5px;
}

#wsnelvjzsc .gt_indent_2 {
  text-indent: 10px;
}

#wsnelvjzsc .gt_indent_3 {
  text-indent: 15px;
}

#wsnelvjzsc .gt_indent_4 {
  text-indent: 20px;
}

#wsnelvjzsc .gt_indent_5 {
  text-indent: 25px;
}

#wsnelvjzsc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wsnelvjzsc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="paragraph" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">paragraph</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="paragraph">【石破総理冒頭発言】 お待たせいたしました。 本日、衆議院を解散いたしました。国民の皆様の御納得、そ</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a></a>df_ishiba<span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a></a>  <span class="fu">filter</span>(</span>
<span id="cb55-3"><a></a>    title <span class="sc">==</span> <span class="st">"石破内閣総理大臣記者会見"</span>,</span>
<span id="cb55-4"><a></a>    date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2025-10-10"</span>)</span>
<span id="cb55-5"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb55-6"><a></a>  <span class="fu">mutate</span>(<span class="at">paragraph =</span> <span class="fu">substr</span>(paragraph, <span class="dv">1</span>, <span class="dv">50</span>)) <span class="sc">|&gt;</span></span>
<span id="cb55-7"><a></a>  <span class="fu">select</span>(paragraph) <span class="sc">|&gt;</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="lesjnzmyvb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lesjnzmyvb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lesjnzmyvb thead, #lesjnzmyvb tbody, #lesjnzmyvb tfoot, #lesjnzmyvb tr, #lesjnzmyvb td, #lesjnzmyvb th {
  border-style: none;
}

#lesjnzmyvb p {
  margin: 0;
  padding: 0;
}

#lesjnzmyvb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lesjnzmyvb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lesjnzmyvb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lesjnzmyvb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lesjnzmyvb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lesjnzmyvb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lesjnzmyvb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lesjnzmyvb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lesjnzmyvb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lesjnzmyvb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lesjnzmyvb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lesjnzmyvb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lesjnzmyvb .gt_spanner_row {
  border-bottom-style: hidden;
}

#lesjnzmyvb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lesjnzmyvb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lesjnzmyvb .gt_from_md > :first-child {
  margin-top: 0;
}

#lesjnzmyvb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lesjnzmyvb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lesjnzmyvb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lesjnzmyvb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lesjnzmyvb .gt_row_group_first td {
  border-top-width: 2px;
}

#lesjnzmyvb .gt_row_group_first th {
  border-top-width: 2px;
}

#lesjnzmyvb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lesjnzmyvb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lesjnzmyvb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lesjnzmyvb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lesjnzmyvb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lesjnzmyvb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lesjnzmyvb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lesjnzmyvb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lesjnzmyvb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lesjnzmyvb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lesjnzmyvb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lesjnzmyvb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lesjnzmyvb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lesjnzmyvb .gt_left {
  text-align: left;
}

#lesjnzmyvb .gt_center {
  text-align: center;
}

#lesjnzmyvb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lesjnzmyvb .gt_font_normal {
  font-weight: normal;
}

#lesjnzmyvb .gt_font_bold {
  font-weight: bold;
}

#lesjnzmyvb .gt_font_italic {
  font-style: italic;
}

#lesjnzmyvb .gt_super {
  font-size: 65%;
}

#lesjnzmyvb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lesjnzmyvb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lesjnzmyvb .gt_indent_1 {
  text-indent: 5px;
}

#lesjnzmyvb .gt_indent_2 {
  text-indent: 10px;
}

#lesjnzmyvb .gt_indent_3 {
  text-indent: 15px;
}

#lesjnzmyvb .gt_indent_4 {
  text-indent: 20px;
}

#lesjnzmyvb .gt_indent_5 {
  text-indent: 25px;
}

#lesjnzmyvb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lesjnzmyvb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="paragraph" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">paragraph</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="paragraph">（内閣総理大臣所感） 戦後８０年に寄せて（941KB）【石破総理冒頭発言】 本日、「戦後８０年に寄せ</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="発展map関数penguin" class="slide level2">
<h2>発展：map()関数（penguin）</h2>
<h3 id="map関数の利点">map()関数の利点</h3>
<ul>
<li>グループごとに自動で処理できる
<ul>
<li>手作業でspeciesごとに分けてコードを書く必要がない</li>
<li>例：ペンギンの種類ごとに、くちばしの長さ(bill_len)と深さ(bill_dep)の関係を回帰分析で調べる</li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a></a>penguins <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a></a>  <span class="fu">nest</span>() <span class="sc">|&gt;</span>                  <span class="co"># グループごとにデータフレームをリスト化して1列にまとめる</span></span>
<span id="cb56-4"><a></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-5"><a></a>    <span class="at">bill_lm_result =</span> <span class="fu">map</span>(    <span class="co"># map() でリストの各要素（データフレーム）に同じ処理を適用</span></span>
<span id="cb56-6"><a></a>      data,                  <span class="co"># 対象は nest() で作った 'data' 列</span></span>
<span id="cb56-7"><a></a>      <span class="cf">function</span>(df) {</span>
<span id="cb56-8"><a></a>        lm_result <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_len <span class="sc">~</span> bill_dep, <span class="at">data =</span> df)  <span class="co"># bill_len を目的変数、bill_dep を説明変数に回帰</span></span>
<span id="cb56-9"><a></a>        <span class="fu">return</span>(lm_result)                              <span class="co"># lm の結果を返す</span></span>
<span id="cb56-10"><a></a>      }</span>
<span id="cb56-11"><a></a>    ),</span>
<span id="cb56-12"><a></a>    <span class="at">coefficients =</span> <span class="fu">map</span>(      <span class="co"># map() で各回帰結果から係数を取り出す</span></span>
<span id="cb56-13"><a></a>      bill_lm_result, </span>
<span id="cb56-14"><a></a>      pluck, </span>
<span id="cb56-15"><a></a>      <span class="st">"coefficients"</span></span>
<span id="cb56-16"><a></a>    )</span>
<span id="cb56-17"><a></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb56-18"><a></a>  <span class="fu">unnest_wider</span>(coefficients, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">|&gt;</span>   <span class="co"># coefficients 列を列ごとに展開（intercept や傾きが列になる）</span></span>
<span id="cb56-19"><a></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
# Groups:   species [3]
  species   data     bill_lm_result coefficients_(Interc…¹ coefficients_bill_dep
  &lt;fct&gt;     &lt;list&gt;   &lt;list&gt;                          &lt;dbl&gt;                 &lt;dbl&gt;
1 Adelie    &lt;tibble&gt; &lt;lm&gt;                             23.1                 0.857
2 Gentoo    &lt;tibble&gt; &lt;lm&gt;                             17.2                 2.02 
3 Chinstrap &lt;tibble&gt; &lt;lm&gt;                             13.4                 1.92 
# ℹ abbreviated name: ¹​`coefficients_(Intercept)`</code></pre>
</div>
</div>
</section>
<section id="発展map関数penguin-1" class="slide level2">
<h2>発展：map()関数（penguin）</h2>
<h3 id="mapを使わない場合">map()を使わない場合</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a></a><span class="co"># データを種別ごとに分ける</span></span>
<span id="cb58-2"><a></a>adelie <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Adelie"</span>)</span>
<span id="cb58-3"><a></a><span class="co"># chinstrap &lt;- penguins |&gt; filter(species == "Chinstrap")</span></span>
<span id="cb58-4"><a></a><span class="co"># gentoo &lt;- penguins |&gt; filter(species == "Gentoo")</span></span>
<span id="cb58-5"><a></a></span>
<span id="cb58-6"><a></a><span class="co"># 種別ごとに回帰分析を個別に書く</span></span>
<span id="cb58-7"><a></a>adelie_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_len <span class="sc">~</span> bill_dep, <span class="at">data =</span> adelie)</span>
<span id="cb58-8"><a></a><span class="co"># chinstrap_lm &lt;- lm(bill_len ~ bill_dep, data = chinstrap)</span></span>
<span id="cb58-9"><a></a><span class="co"># gentoo_lm &lt;- lm(bill_len ~ bill_dep, data = gentoo)</span></span>
<span id="cb58-10"><a></a></span>
<span id="cb58-11"><a></a><span class="co"># 結果を確認</span></span>
<span id="cb58-12"><a></a><span class="fu">print</span>(adelie_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bill_len ~ bill_dep, data = adelie)

Coefficients:
(Intercept)     bill_dep  
     23.068        0.857  </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a></a><span class="co"># print(chinstrap_lm)</span></span>
<span id="cb60-2"><a></a><span class="co"># print(gentoo_lm)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-tip callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>回帰分析をtidyverseスタイルで行うなら、parsnipパッケージが便利です。tidymodelsパッケージに含まれています。モデル結果を表形式に整理するにはbroomパッケージも使います</p>
</div>
</div>
</div>
</section>
<section id="発展map関数選挙" class="slide level2">
<h2>発展：map()関数（選挙）</h2>
<ul>
<li>map() ：同じ処理を、たくさんのデータに順番に適用する」関数
<ul>
<li>「たくさんのファイル」や「いくつかのグループ（島・年・地域など）」に対して、同じ処理（たとえば平均を出す・グラフを描く）を自動で繰り返す</li>
</ul></li>
<li>比例区の得票数を地域ブロックごとに集計、描画したい</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a></a><span class="co"># 1. データを整形して新しいオブジェクトに保存</span></span>
<span id="cb61-2"><a></a>df_plot <span class="ot">&lt;-</span> df_pr_parties <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a></a>  <span class="fu">group_by</span>(year, party, block) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a></a>  <span class="fu">summarise</span>(<span class="at">votes =</span> <span class="fu">sum</span>(votes), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-5"><a></a>  <span class="fu">filter</span>(party <span class="sc">%in%</span> 主要政党) <span class="sc">|&gt;</span></span>
<span id="cb61-6"><a></a>  <span class="fu">mutate</span>(<span class="at">party =</span> <span class="fu">factor</span>(party, <span class="at">levels =</span> 主要政党))</span>
<span id="cb61-7"><a></a></span>
<span id="cb61-8"><a></a><span class="co"># 2. block ごとに分割（factor → character に変換）</span></span>
<span id="cb61-9"><a></a>df_list <span class="ot">&lt;-</span> <span class="fu">split</span>(df_plot, <span class="fu">as.character</span>(df_plot<span class="sc">$</span>block))</span>
<span id="cb61-10"><a></a></span>
<span id="cb61-11"><a></a><span class="co"># 3. ggplot を作成</span></span>
<span id="cb61-12"><a></a>plots <span class="ot">&lt;-</span> <span class="fu">map</span>(df_list, <span class="sc">~</span> <span class="fu">ggplot</span>(.x, <span class="fu">aes</span>(<span class="at">x =</span> party, <span class="at">y =</span> votes, <span class="at">fill =</span> <span class="fu">as.factor</span>(year))) <span class="sc">+</span></span>
<span id="cb61-13"><a></a>                       <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb61-14"><a></a>                       <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">unique</span>(.x<span class="sc">$</span>block), <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"得票数"</span>) <span class="sc">+</span></span>
<span id="cb61-15"><a></a>                       <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)))</span>
<span id="cb61-16"><a></a></span>
<span id="cb61-17"><a></a><span class="co"># 4. プロットを表示</span></span>
<span id="cb61-18"><a></a><span class="fu">walk</span>(plots, print)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="発展地図情報アメリカの選挙結果" class="slide level2">
<h2>発展：地図情報（アメリカの選挙結果）</h2>
<h3 id="前処理">前処理</h3>
<ul>
<li>Setup Chunkに書く</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a></a>us_states <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"state"</span>)</span>
<span id="cb62-2"><a></a></span>
<span id="cb62-3"><a></a><span class="co"># アメリカ主要政党のカラーコード</span></span>
<span id="cb62-4"><a></a>party_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#2E74C0"</span>, <span class="st">"#CB454A"</span>)</span>
<span id="cb62-5"><a></a></span>
<span id="cb62-6"><a></a>us_state_elec <span class="ot">&lt;-</span> </span>
<span id="cb62-7"><a></a>  election <span class="sc">|&gt;</span> <span class="co"># データセットsocvizに含まれています</span></span>
<span id="cb62-8"><a></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">tolower</span>(state)) <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a></a>  <span class="fu">left_join</span>(us_states, <span class="at">by =</span> <span class="st">"region"</span>) <span class="co"># データの結合</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="発展地図情報アメリカの選挙結果-1" class="slide level2">
<h2>発展：地図情報（アメリカの選挙結果）</h2>
<h3 id="年アメリカ大統領選挙結果1">2016年アメリカ大統領選挙結果<sup>1</sup></h3>
<ul>
<li>ggthemesパッケージを使用</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-12" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-12-1">Code</a></li><li><a href="#tabset-12-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb63-2"><a></a></span>
<span id="cb63-3"><a></a>us_state_elec <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">group =</span> group, <span class="at">fill =</span> party)) <span class="sc">+</span></span>
<span id="cb63-5"><a></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> <span class="co"># ggplot2内の関数</span></span>
<span id="cb63-6"><a></a>  <span class="fu">coord_map</span>(<span class="at">projection =</span> <span class="st">"albers"</span>, <span class="at">lat0 =</span> <span class="dv">39</span>, <span class="at">lat1 =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors) <span class="sc">+</span></span>
<span id="cb63-8"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"アメリカ大統領選挙結果 2016"</span>, <span class="at">fill =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb63-9"><a></a>  <span class="fu">theme_map</span>(<span class="at">base_family =</span> <span class="st">"HiraKakuProN-W3"</span>) <span class="co"># 地図を描くときに余分な軸・枠・背景などを消して、地図表示に適したシンプルなテーマを適用する関数（注記・Windwowsユーザーはフォント変えて下さい）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-72-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn8"><p>コードの出典：<span class="citation" data-cites="HealyK:2021book1_translJA">ヒーリー，キーラン (<a href="#/参考文献-1" role="doc-biblioref" onclick="">2021</a>)</span></p></li></ol></aside></section>
<section id="発展地図情報アメリカの人口密度" class="slide level2">
<h2>発展：地図情報（アメリカの人口密度）</h2>
<h3 id="アメリカの人口密度2">アメリカの人口密度<sup>1</sup></h3>
<div class="panel-tabset">
<ul id="tabset-13" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-13-1">Code</a></li><li><a href="#tabset-13-2">Plot</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a></a>county_full <span class="ot">&lt;-</span></span>
<span id="cb64-2"><a></a>  county_map <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a></a>  <span class="fu">left_join</span>(county_data, <span class="at">by =</span> <span class="st">"id"</span>)</span>
<span id="cb64-4"><a></a></span>
<span id="cb64-5"><a></a>county_full <span class="sc">|&gt;</span>  </span>
<span id="cb64-6"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat,</span>
<span id="cb64-7"><a></a>         <span class="at">fill =</span> pop_dens,</span>
<span id="cb64-8"><a></a>         <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb64-9"><a></a>  <span class="fu">geom_polygon</span>(<span class="at">color =</span> <span class="st">"gray90"</span>, <span class="at">size =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb64-11"><a></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>,</span>
<span id="cb64-12"><a></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0-10"</span>, <span class="st">"10-50"</span>, <span class="st">"50-100"</span>, <span class="st">"100-500"</span>, <span class="st">"500-1,000"</span>, <span class="st">"1,000-5,000"</span>, <span class="st">"&gt;5,000"</span>)) <span class="sc">+</span></span>
<span id="cb64-13"><a></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Population per</span><span class="sc">\n</span><span class="st">square mile"</span>) <span class="sc">+</span></span>
<span id="cb64-14"><a></a>  <span class="fu">theme_map</span>() <span class="sc">+</span></span>
<span id="cb64-15"><a></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb64-16"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-13-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-74-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn9"><p>コードの出典：<span class="citation" data-cites="HealyK:2021book1_translJA">ヒーリー，キーラン (<a href="#/参考文献-1" role="doc-biblioref" onclick="">2021</a>)</span></p></li></ol></aside></section>
<section id="発展重回帰分析penguins" class="slide level2">
<h2>発展：重回帰分析（penguins）</h2>
<ul>
<li>sjPlotパッケージを使用</li>
</ul>
<div class="panel-tabset">
<ul id="tabset-14" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-14-1">Code</a></li><li><a href="#tabset-14-2">Table</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb65-2"><a></a></span>
<span id="cb65-3"><a></a><span class="co"># データ例</span></span>
<span id="cb65-4"><a></a>penguins_clean <span class="ot">&lt;-</span> </span>
<span id="cb65-5"><a></a>  penguins <span class="sc">|&gt;</span> </span>
<span id="cb65-6"><a></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(bill_len), <span class="sc">!</span><span class="fu">is.na</span>(bill_dep), <span class="sc">!</span><span class="fu">is.na</span>(flipper_len))</span>
<span id="cb65-7"><a></a></span>
<span id="cb65-8"><a></a><span class="co"># 重回帰</span></span>
<span id="cb65-9"><a></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(bill_len <span class="sc">~</span> bill_dep <span class="sc">+</span> flipper_len, <span class="at">data =</span> penguins_clean)</span>
<span id="cb65-10"><a></a></span>
<span id="cb65-11"><a></a><span class="co"># 表示</span></span>
<span id="cb65-12"><a></a><span class="fu">tab_model</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-14-2">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" data-quarto-postprocess="true" style="border-collapse:collapse; border:none;">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">bill len</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-28.15</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-38.99&nbsp;–&nbsp;-17.30</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">bill dep</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.62</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.35&nbsp;–&nbsp;0.89</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">flipper len</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.31</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.27&nbsp;–&nbsp;0.34</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">342</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.464 / 0.461</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="Google-Ngram-Trends" class="slide level2">
<h2>発展：Google Ngram Trends</h2>
<ul>
<li>ngramrパッケージを使用</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a></a><span class="fu">library</span>(ngramr)</span>
<span id="cb66-2"><a></a></span>
<span id="cb66-3"><a></a>words <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Cicero"</span>, <span class="st">"Tacitus"</span>, <span class="st">"Sallust"</span>,<span class="st">"Plutarch"</span>, <span class="st">"Aristotle"</span>, <span class="st">"Shakespeare"</span>, <span class="st">"Milton"</span>)</span>
<span id="cb66-4"><a></a></span>
<span id="cb66-5"><a></a>df <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(words, <span class="sc">~</span><span class="fu">ngram</span>(.x, <span class="at">corpus =</span> <span class="st">"eng_gb_2019"</span>, <span class="at">year_start =</span> <span class="dv">1500</span>, <span class="at">year_end =</span> <span class="dv">2020</span>)) <span class="co"># 複数のオブジェクトに対して同じ処理を行い、その結果を 縦方向に結合（row-bind）してデータフレームにする</span></span>
<span id="cb66-6"><a></a></span>
<span id="cb66-7"><a></a>df <span class="sc">|&gt;</span> </span>
<span id="cb66-8"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Frequency, <span class="at">color =</span> Phrase)) <span class="sc">+</span></span>
<span id="cb66-9"><a></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb66-10"><a></a>  <span class="fu">scale_color_paletteer_d</span>(<span class="st">"ggthemr::solarized"</span>) <span class="sc">+</span></span>
<span id="cb66-11"><a></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-12"><a></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb66-13"><a></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Google Ngram Trends"</span>, <span class="at">y =</span> <span class="st">"Frequency (%)"</span>, <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="RforDataScience_files/figure-revealjs/unnamed-chunk-77-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="さらに学ぶために" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>Ⅶ. さらに学ぶために</h1>

</section>
<section id="さらに学ぶ基本書" class="slide level2">
<h2>さらに学ぶ：基本書</h2>
<ul>
<li>Wickham, Hadley and Çetinkaya-Rundel, Mine and Grolemund, Garrett. ‘R for Data Science (2e)’（<a href="https://r4ds.hadley.nz">LINK</a>）</li>
<li>キーラン・ヒーリー（2021）『データ分析のためのデータ可視化入門』（瓜生真也・ 江口哲史・三村喬生 訳）、講談社（<a href="https://www.kspub.co.jp/book/detail/5164044.html">LINK</a>）</li>
<li>松村優哉・湯谷啓明・紀ノ定保礼・前田和寛（2021）『改訂2版 RユーザのためのRStudio「実践」入門：tidyverseによるモダンな分析フローの世界』、技術評論社（<a href="https://gihyo.jp/book/2021/978-4-297-12170-9">LINK</a>）</li>
<li>松村優哉・瓜生真也・吉村広志（2023）『Rユーザのためのtidymodels「実践」入門：モダンな統計・機械学習モデリングの世界』、技術評論社（<a href="https://gihyo.jp/book/2018/978-4-7741-9853-8">LINK</a>）</li>
<li>Kosuke Imai and Nora Webb Williams, “Quantitative Social Science: An Introduction in tidyverse”（<a href="https://press.princeton.edu/books/hardcover/9780691222271/quantitative-social-science">LINK</a>、旧版（非tidyverse）は翻訳あり（<a href="https://www.iwanami.co.jp/book/b352348.html">LINK</a>））</li>
</ul>
</section>
<section id="さらに学ぶ基本書-1" class="slide level2">
<h2>さらに学ぶ：基本書</h2>
<ul>
<li>轟亮・杉野勇・平沢和司編『入門・社会調査法〔第4版〕：2ステップで基礎から学ぶ』（<a href="https://www.hou-bun.com/cgi-bin/search/detail.cgi?c=ISBN978-4-589-04141-8">LINK</a>）</li>
</ul>
</section>
<section id="さらに学ぶ専門的なパッケージ" class="slide level2">
<h2>さらに学ぶ：専門的なパッケージ</h2>
<ul>
<li>社会科学全般：<a href="http://www.strengejacke.de/sjPlot/index.html">sjPlot</a>
<ul>
<li>回帰分析結果の可視化、アンケートデータの表作成</li>
</ul></li>
<li>政治学（世界各国の議員に関する標準化データベース）：<a href="https://github.com/saschagobel/legislatoR">legislatoR</a><br>
</li>
<li>政治学（議会の構成）：<a href="https://zmeers.github.io/ggparliament/">ggparliament</a>
<ul>
<li>議席構成や投票結果の可視化</li>
</ul></li>
<li>経済学：<a href="https://business-science.github.io/tidyquant/">tidyquant</a>
<ul>
<li>株価データや金融指標の分析、時系列処理</li>
</ul></li>
<li>心理学：<a href="https://cran.r-project.org/web/packages/psych/index.html">psych</a>
<ul>
<li>心理尺度の分析、因子分析、信頼性分析</li>
<li>psychの補助ツール：<a href="https://personality-project.org/r/psych-manual.pdf">psychTools</a></li>
</ul></li>
</ul>
</section>
<section id="さらに学ぶ専門的なパッケージ-1" class="slide level2">
<h2>さらに学ぶ：専門的なパッケージ</h2>
<ul>
<li>分子生物学・ゲノム科学 <a href="https://cran.r-project.org/web/packages/gggenes/vignettes/introduction-to-gggenes.html">gggenes</a>
<ul>
<li>遺伝子・オペロン構造の可視化</li>
</ul></li>
<li>医学・疫学：<a href="https://github.com/therneau/survival">survival</a>
<ul>
<li>生存解析、カプラン・マイヤー曲線の描画</li>
</ul></li>
<li>ネットワーク分析：<a href="https://igraph.org">igraph</a>
<ul>
<li>ネットワーク・関係データの解析・可視化</li>
</ul></li>
<li>時系列分析：<a href="https://github.com/robjhyndman/forecast">forecast</a>
<ul>
<li>経済・環境データの予測・解析</li>
</ul></li>
</ul>
</section>
<section id="さらに学ぶデータ-e-stat" class="slide level2">
<h2>さらに学ぶ：データ &gt; e-stat</h2>
<h3 id="e-stat">e-statの処理</h3>
<ul>
<li><a href="https://uchidamizuki.quarto.pub/blog/posts/2022/12/call-e-stat-api-in-r.html">Rで日本の統計データを効率的に取得しよう</a></li>
<li><a href="https://icu-hsuzuki.github.io/ds4aj/estat.html">みんなのデータサイエンス：e-Stat</a></li>
<li><a href="https://id.fnshr.info/2018/04/23/r-data-cleaning-school/">Rによるデータクリーニング実践：府統計からのグラフ作成を例として</a></li>
<li><a href="https://indenkun.hatenablog.com/entry/2023/02/14/144118">Rでe-statからxls（xlsx）ファイルをダウンロードするときにうまくいかなかったときに対処したメモ</a></li>
<li><a href="https://yo5uke.com/pages/tips/240622_census_cleansing/index.html">国勢調査データのクレンジング</a></li>
<li><a href="https://ymgc19.github.io/memo_simplecensus">simplecensus</a></li>
</ul>
</section>
<section id="さらに学ぶデータ-政治" class="slide level2">
<h2>さらに学ぶ：データ &gt; 政治</h2>
<h3 id="政治に関わる諸データ">政治に関わる諸データ</h3>
<ul>
<li><a href="https://data.ipu.org">IPU Parline: Global data on national parliaments</a>（列国議会同盟）</li>
<li><a href="https://www.soumu.go.jp/senkyo/senkyo_s/data/index.html">総務省トップ &gt; 政策 &gt; 選挙・政治資金制度 &gt; 選挙 &gt; 選挙関連資料</a></li>
<li><a href="https://gentokatozemi.github.io/projects/usefreedata/">加藤言人ゼミナール &gt; Rによる無料データの入手と利用</a></li>
</ul>
</section>
<section id="さらに学ぶ教材チュートリアル" class="slide level2">
<h2>さらに学ぶ：教材（チュートリアル）</h2>
<h3 id="学部生向け授業教材">学部生向け授業教材</h3>
<ul>
<li><a href="https://kariyach.github.io/teaching/RandQuarto_2025/">RとQuartoではじめるデータサイエンス：データを可視化する《2025》</a>
<ul>
<li>私（苅谷）が授業のために作成した教材です。今回の講習会で紹介したものが多いですが、可視化の体裁変更などは参考になると思います</li>
</ul></li>
</ul>
<h3 id="初学者向け教材">初学者向け教材</h3>
<ul>
<li>宋財泫・矢内勇生 <a href="https://www.jaysong.net/RBook/">私たちのR：ベストプラクティスの探求</a>
<ul>
<li>内容が充実しているだけでなく、情報がアップデートされており、お勧め</li>
</ul></li>
<li>RLadiesSydney, <a href="https://rladiessydney.org/courses/">The RYouWithMe</a>
<ul>
<li>世界的にも評価の高いR初学者向け教材です。動画が多く、わかりやすい</li>
</ul></li>
<li><a href="https://qiita.com/nekobo/items/cbf32a13637273f229da">R初学者のためのtidyverse100本ノック</a>
<ul>
<li>問題と解答がコードで提供されており、実践的です</li>
</ul></li>
</ul>
</section>
<section id="さらに学ぶ問い合わせ" class="slide level2">
<h2>さらに学ぶ：問い合わせ</h2>
<h3 id="メールアドレス">メールアドレス</h3>
<ul>
<li>1度の講習会で理解できることには限界があります
<ul>
<li>特にサンプルコードでは動いても、自分が参照したいデータではうまくいかないことはよくあります</li>
</ul></li>
<li>わからないことがあればお気軽にお問い合わせ下さい（歓迎いたします）
<ul>
<li><a href="mailto:kariyach@staff.kanazawa-u.ac.jp">kariyach@staff.kanazawa-u.ac.jp</a></li>
</ul></li>
</ul>
<h3 id="実演したコード">実演したコード</h3>
<ul>
<li>本日、実演したコードは<a href="https://drive.google.com/drive/folders/1wnDIsrXeNYKyuCATx71JyVPR9ujmip3G?usp=sharing">Google Drive</a>からダウンロードできるようにしておきます</li>
</ul>
</section>
<section id="さらに学ぶスライド資料" class="slide level2">
<h2>さらに学ぶ：スライド資料</h2>
<h3 id="スライド資料">スライド資料</h3>
<ul>
<li>キーボードの「E」でpdf出力できます
<ul>
<li>Goggle Chrome推奨</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="参考文献" class="title-slide slide level1 center" data-background="linear-gradient(135deg, #113758 40%, #4B3F8A 100%)" data-background-transition="slide" data-background-color="#113758">
<h1>参考文献</h1>

</section>
<section id="参考文献-1" class="slide level2 smaller scrollable">
<h2>参考文献</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-WickhamH_etal:2023book" class="csl-entry" role="listitem">
Wickham, H., Çetinkaya-Rundel, M., Grolemund, G., 2023. <a href="https://r4ds.hadley.nz">R for data science</a>. O’Reilly Media.
</div>
<div id="ref-HealyK:2021book1_translJA" class="csl-entry" role="listitem">
ヒーリー，キーラン, 2021. データ分析のためのデータ可視化入門, 瓜生真也・江口哲史・三村喬生 訳. 講談社.
</div>
</div>
</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-confetti/confetti.js"></script>
  <script src="../../site_libs/revealjs/plugin/multimodal/multimodal.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'scrollProgress': "true",
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"wide","numbers":true},
'chalkboard': {"buttons":false},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'confetti': {"particleCount":50,"angle":90,"spread":45,"startVelocity":45,"decay":0.9,"gravity":1,"drift":0,"ticks":200,"colors":null,"shapes":null,"scalar":1,"zIndex":100,"disableForReducedMotion":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, RevealConfetti, Multimodal, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/kariyach\.github\.io\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
                // target, if specified
                link.setAttribute("target", "_blank");
                if (link.getAttribute("rel") === null) {
                  link.setAttribute("rel", "noopener");
                }
                // default icon
                link.classList.add("external");
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>